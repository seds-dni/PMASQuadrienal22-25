INSERT INTO DBSEDS.DBO.TB_APLICATIVO (ID,NOME,REMOVIDO) VALUES(8,'PMAS 2015',0)
GO

INSERT INTO DBSEDS.DBO.TB_PERFIL(ID,NOME,ID_APLICATIVO, REMOVIDO)
VALUES (26, 'Orgão Gestor', 8, 0)
GO

INSERT INTO DBSEDS.DBO.TB_PERFIL(ID,NOME,ID_APLICATIVO, REMOVIDO)
VALUES (27, 'DRADS Administrador', 8, 0)
GO

INSERT INTO DBSEDS.DBO.TB_PERFIL(ID,NOME,ID_APLICATIVO, REMOVIDO)
VALUES (28, 'SEDS', 8, 0)
GO

INSERT INTO DBSEDS.DBO.TB_PERFIL(ID,NOME,ID_APLICATIVO, REMOVIDO)
VALUES (29, 'CAS', 8, 0)
GO

INSERT INTO DBSEDS.DBO.TB_PERFIL(ID,NOME,ID_APLICATIVO, REMOVIDO)
VALUES (30, 'CAS Administrador', 8, 0)
GO

INSERT INTO DBSEDS.DBO.TB_PERFIL(ID,NOME,ID_APLICATIVO, REMOVIDO)
VALUES (31, 'Convidados', 8, 0)
GO

INSERT INTO DBSEDS.DBO.TB_PERFIL(ID,NOME,ID_APLICATIVO, REMOVIDO)
VALUES (32, 'DRADS', 8, 0)
GO

INSERT INTO DBSEDS.DBO.TB_PERFIL(ID,NOME,ID_APLICATIVO, REMOVIDO)
VALUES (33, 'CMAS', 8, 0)
GO

SELECT [ID_USUARIO],[ID_PERFIL],[ATIVO] into #temp
FROM [DBSEDS].[dbo].[TB_USUARIOxPERFIL]
where id_perfil in (17,18,19,20,21,22,23,25)

update #temp set id_perfil = 26 where id_perfil = 17
update #temp set id_perfil = 27 where id_perfil = 18
update #temp set id_perfil = 28 where id_perfil = 19
update #temp set id_perfil = 29 where id_perfil = 20
update #temp set id_perfil = 30 where id_perfil = 21
update #temp set id_perfil = 31 where id_perfil = 22
update #temp set id_perfil = 32 where id_perfil = 23
update #temp set id_perfil = 33 where id_perfil = 25

insert [DBSEDS].[dbo].[TB_USUARIOxPERFIL]
select id_usuario, id_perfil, ativo from #temp

drop table #temp
GO

update [DBPMAS2015].[dbo].[TB_RECURSOxPERFIL] set id_perfil = 26 where id_perfil = 17
update [DBPMAS2015].[dbo].[TB_RECURSOxPERFIL] set id_perfil = 27 where id_perfil = 18
update [DBPMAS2015].[dbo].[TB_RECURSOxPERFIL] set id_perfil = 28 where id_perfil = 19
update [DBPMAS2015].[dbo].[TB_RECURSOxPERFIL] set id_perfil = 29 where id_perfil = 20
update [DBPMAS2015].[dbo].[TB_RECURSOxPERFIL] set id_perfil = 30 where id_perfil = 21
update [DBPMAS2015].[dbo].[TB_RECURSOxPERFIL] set id_perfil = 31 where id_perfil = 22
update [DBPMAS2015].[dbo].[TB_RECURSOxPERFIL] set id_perfil = 32 where id_perfil = 23
update [DBPMAS2015].[dbo].[TB_RECURSOxPERFIL] set id_perfil = 33 where id_perfil = 25
GO

USE [DBPMAS2015]
GO

/****** Object:  View [dbo].[VW_USUARIOS]    Script Date: 14/05/2014 14:38:10 ******/
SET ANSI_NULLS ON
GO

SET QUOTED_IDENTIFIER ON
GO


ALTER VIEW [dbo].[VW_USUARIOS]
AS
SELECT  A.ID_USUARIO
		,E.ID_PERFIL AS ID_PERFIL
		,E.PERFIL
		,B.USU_NOME AS NOME
		,B.USU_LOGIN AS [LOGIN]
		,B.USU_RG AS RG
		,ISNULL(G.NOME,'') AS MUNICIPIO
		,ISNULL(H.NOME,ISNULL(I.NOME,'')) AS DRADS
		,G.ID AS ID_MUNICIPIO
		,COALESCE(H.ID,I.ID) AS ID_DRADS
		,(CASE WHEN ATIVO = 0 THEN 'Ativo' ELSE 'Inativo' END) AS SITUACAO
		,A.INSTITUICAO
		,A.CARGO
  FROM TB_USUARIO AS A
  JOIN DBUSUARIOS.DBO.TB_USUARIOS AS B ON A.ID_USUARIO = B.USU_ID  
  JOIN (SELECT C.ID_USUARIO, C.ID_PERFIL, D.NOME AS PERFIL 
		FROM DBSEDS.DBO.TB_USUARIOxPERFIL AS C
		INNER JOIN DBSEDS.DBO.TB_PERFIL AS D ON C.ID_PERFIL = D.ID
		) AS E ON E.ID_USUARIO = A.ID_USUARIO AND E.ID_PERFIL IN(26,27,28,29,30,31,32,33)
  LEFT JOIN TB_PREFEITURA AS F ON A.ID_PREFEITURA = F.ID
  LEFT JOIN DBSEDS.DBO.TB_MUNICIPIOS AS G ON F.ID_MUNICIPIO = G.ID
  LEFT JOIN DBSEDS.DBO.TB_DRADS AS H ON G.ID_DRADS = H.ID
  LEFT JOIN DBSEDS.DBO.TB_DRADS AS I ON A.ID_DRADS = I.ID

GO

ALTER TABLE dbo.TB_ORGAO_GESTOR ADD
	POSSUI_EQUIPE_GESTAO_BENEFICIOS_SOCIOASSISTENCIAIS bit NULL,
	EQUIPE_GESTAO_BENEFICIOS_SOCIOASSISTENCIAIS int NULL
GO

ALTER TABLE dbo.TB_GESTOR_MUNICIPAL ADD
	DATA_TERMINO_GESTAO datetime NULL
GO


USE [DBPMAS2015]
GO

/****** Object:  Table [dbo].[TB_CONSELHO_MUNICIPAL_PRESIDENTE_ANTERIOR]    Script Date: 13/05/2014 10:11:16 ******/
SET ANSI_NULLS ON
GO

SET QUOTED_IDENTIFIER ON
GO

CREATE TABLE [dbo].[TB_CONSELHO_MUNICIPAL_PRESIDENTE_ANTERIOR](
	[ID] [int] IDENTITY(1,1) NOT NULL,
	[ID_CONSELHO_MUNICIPAL] [int] NOT NULL,
	[ID_USUARIO_PRESIDENTE] [int] NOT NULL,
	[DATA_INICIO_MANDATO] [datetime] NOT NULL,
	[DATA_TERMINO_MANDATO] [datetime] NOT NULL,
 CONSTRAINT [PK_TB_CONSELHO_MUNICIPAL_PRESIDENTE_ANTERIOR] PRIMARY KEY CLUSTERED 
(
	[ID] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY]

GO

ALTER TABLE [dbo].[TB_CONSELHO_MUNICIPAL_PRESIDENTE_ANTERIOR]  WITH CHECK ADD  CONSTRAINT [FK_TB_CONSELHO_MUNICIPAL_PRESIDENTE_ANTERIOR_TB_CONSELHO_MUNICIPAL] FOREIGN KEY([ID_CONSELHO_MUNICIPAL])
REFERENCES [dbo].[TB_CONSELHO_MUNICIPAL] ([ID])
GO

ALTER TABLE [dbo].[TB_CONSELHO_MUNICIPAL_PRESIDENTE_ANTERIOR] CHECK CONSTRAINT [FK_TB_CONSELHO_MUNICIPAL_PRESIDENTE_ANTERIOR_TB_CONSELHO_MUNICIPAL]
GO

alter table [DBPMAS2015].[dbo].[TB_CONSELHO_MUNICIPAL] alter column DATA_DECRETO DATETIME NULL
GO

alter table [DBPMAS2015].[dbo].[TB_CONSELHO_MUNICIPAL] alter column DATA_MANDATO_INICIO DATETIME NULL
GO

alter table [DBPMAS2015].[dbo].[TB_CONSELHO_MUNICIPAL] alter column DATA_MANDATO_TERMINO DATETIME NULL
GO


USE [DBPMAS2015]
GO
/****** Object:  StoredProcedure [dbo].[PR_COFINANCIAMENTO_ESTADUAL]    Script Date: 14/05/2014 09:49:24 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO

ALTER PROCEDURE [dbo].[PR_COFINANCIAMENTO_ESTADUAL]
	@ID_TIPO_PROTECAO  INT, @ID_PREFEITURA INT
AS  
  SELECT * FROM (
  SELECT S.ID		
		,L.ID AS ID_UNIDADE
		,5 AS ID_TIPO_UNIDADE
		,'Centro Pop' AS TIPO_UNIDADE
		,L.NOME AS UNIDADE
		,S.ID_USUARIO_TIPO_SERVICO
		,U.NOME AS USUARIO
		,U.ID_TIPO_SERVICO
		,(T.NOME + (CASE WHEN DESCRICAO_NAO_TIPIFICADO IS NULL THEN '' ELSE (' - ' + DESCRICAO_NAO_TIPIFICADO)END))  AS TIPO_SERVICO
		,T.ID_TIPO_PROTECAO
		,P.NOME AS PROTECAO_SOCIAL
		,S.NUMERO_ATENDIDOS_MENSAL AS NUMERO_ATENDIDOS
		,A.ABREVIACAO AS ABRANGENCIA
		,S.SERVICO_ESTADUALIZADO
		,COALESCE((S.VALOR_ESTADUAL_ASSISTENCIA),0) AS PREVISAO_ORCAMENTARIA
		,5 AS ORDEM
	 
  FROM TB_SERVICOS_RECURSOS_FINANCEIROS_CENTRO_POP S
  INNER JOIN TB_UNIDADE_PUBLICA UP (NOLOCK) ON (UP.ID_PREFEITURA = @ID_PREFEITURA) --brunov
  INNER JOIN TB_CENTRO_POP L ON(L.ID = S.ID_CENTRO_POP AND L.ID_UNIDADE_PUBLICA = UP.ID) --brunov
  --INNER JOIN TB_CENTRO_POP L ON(L.ID = S.ID_CENTRO_POP AND L.ID_PREFEITURA = @ID_PREFEITURA) --original
  INNER JOIN TB_USUARIO_TIPO_SERVICO U ON (U.ID = S.ID_USUARIO_TIPO_SERVICO)
  INNER JOIN TB_TIPO_SERVICO T ON(T.ID = U.ID_TIPO_SERVICO AND T.ID_TIPO_PROTECAO = @ID_TIPO_PROTECAO )
  INNER JOIN TB_TIPO_PROTECAO P ON(P.ID = T.ID_TIPO_PROTECAO)
  INNER JOIN TB_ABRANGENCIA_SERVICO A ON(A.ID = S.ID_ABRANGENCIA_SERVICO)
  WHERE S.VALOR_ESTADUAL_ASSISTENCIA > 0

  UNION ALL

  SELECT S.ID		
		,L.ID AS ID_UNIDADE
		,4 AS ID_TIPO_UNIDADE
		,'CREAS' AS TIPO_UNIDADE
		,L.NOME AS UNIDADE
		,S.ID_USUARIO_TIPO_SERVICO
		,U.NOME AS USUARIO
		,U.ID_TIPO_SERVICO
		,(T.NOME + (CASE WHEN DESCRICAO_NAO_TIPIFICADO IS NULL THEN '' ELSE (' - ' + DESCRICAO_NAO_TIPIFICADO)END))  AS TIPO_SERVICO
		,T.ID_TIPO_PROTECAO
		,P.NOME AS PROTECAO_SOCIAL
		,S.NUMERO_ATENDIDOS_MENSAL AS NUMERO_ATENDIDOS
		,A.ABREVIACAO AS ABRANGENCIA
		,S.SERVICO_ESTADUALIZADO
		,COALESCE((S.VALOR_ESTADUAL_ASSISTENCIA),0) AS PREVISAO_ORCAMENTARIA
		,5 AS ORDEM
	 
  FROM TB_SERVICOS_RECURSOS_FINANCEIROS_CREAS S
  INNER JOIN TB_UNIDADE_PUBLICA UP (NOLOCK) ON (UP.ID_PREFEITURA = @ID_PREFEITURA) --brunov
  INNER JOIN TB_CREAS L ON(L.ID = S.ID_CREAS AND L.ID_UNIDADE_PUBLICA = UP.ID) --brunov
  --INNER JOIN TB_CREAS L ON(L.ID = S.ID_CREAS AND L.ID_PREFEITURA = @ID_PREFEITURA) --original
  INNER JOIN TB_USUARIO_TIPO_SERVICO U ON (U.ID = S.ID_USUARIO_TIPO_SERVICO)
  INNER JOIN TB_TIPO_SERVICO T ON(T.ID = U.ID_TIPO_SERVICO AND T.ID_TIPO_PROTECAO = @ID_TIPO_PROTECAO )
  INNER JOIN TB_TIPO_PROTECAO P ON(P.ID = T.ID_TIPO_PROTECAO)
  INNER JOIN TB_ABRANGENCIA_SERVICO A ON(A.ID = S.ID_ABRANGENCIA_SERVICO)
  WHERE S.VALOR_ESTADUAL_ASSISTENCIA > 0

  UNION ALL

  SELECT S.ID		
		,L.ID AS ID_UNIDADE
		,3 AS ID_TIPO_UNIDADE
		,'CRAS' AS TIPO_UNIDADE
		,L.NOME AS UNIDADE
		,S.ID_USUARIO_TIPO_SERVICO
		,U.NOME AS USUARIO
		,U.ID_TIPO_SERVICO
		,(T.NOME + (CASE WHEN DESCRICAO_NAO_TIPIFICADO IS NULL THEN '' ELSE (' - ' + DESCRICAO_NAO_TIPIFICADO)END))  AS TIPO_SERVICO
		,T.ID_TIPO_PROTECAO
		,P.NOME AS PROTECAO_SOCIAL
		,S.NUMERO_ATENDIDOS_MENSAL AS NUMERO_ATENDIDOS
		,A.ABREVIACAO AS ABRANGENCIA
		,S.SERVICO_ESTADUALIZADO
		,COALESCE((S.VALOR_ESTADUAL_ASSISTENCIA),0) AS PREVISAO_ORCAMENTARIA
		,5 AS ORDEM
	 
  FROM TB_SERVICOS_RECURSOS_FINANCEIROS_CRAS S
  INNER JOIN TB_UNIDADE_PUBLICA UP (NOLOCK) ON (UP.ID_PREFEITURA = @ID_PREFEITURA) --brunov
  INNER JOIN TB_CRAS L ON(L.ID = S.ID_CRAS AND L.ID_UNIDADE_PUBLICA = UP.ID) --brunov
  --INNER JOIN TB_CRAS L ON(L.ID = S.ID_CRAS AND L.ID_PREFEITURA = @ID_PREFEITURA) --original
  INNER JOIN TB_USUARIO_TIPO_SERVICO U ON (U.ID = S.ID_USUARIO_TIPO_SERVICO)
  INNER JOIN TB_TIPO_SERVICO T ON(T.ID = U.ID_TIPO_SERVICO AND T.ID_TIPO_PROTECAO = @ID_TIPO_PROTECAO )
  INNER JOIN TB_TIPO_PROTECAO P ON(P.ID = T.ID_TIPO_PROTECAO)
  INNER JOIN TB_ABRANGENCIA_SERVICO A ON(A.ID = S.ID_ABRANGENCIA_SERVICO)
  WHERE S.VALOR_ESTADUAL_ASSISTENCIA > 0

  UNION ALL

  SELECT S.ID		
		,L.ID AS ID_UNIDADE
		,1 AS ID_TIPO_UNIDADE
		,'Unidade Pública' AS TIPO_UNIDADE
		,(L.RAZAO_SOCIAL + (CASE WHEN L.RAZAO_SOCIAL <> E.NOME THEN ' - ' + E.NOME ELSE '' END)) AS UNIDADE
		,S.ID_USUARIO_TIPO_SERVICO
		,U.NOME AS USUARIO
		,U.ID_TIPO_SERVICO
		,(T.NOME + (CASE WHEN DESCRICAO_NAO_TIPIFICADO IS NULL THEN '' ELSE (' - ' + DESCRICAO_NAO_TIPIFICADO)END))  AS TIPO_SERVICO
		,T.ID_TIPO_PROTECAO
		,P.NOME AS PROTECAO_SOCIAL
		,S.NUMERO_ATENDIDOS_MENSAL AS NUMERO_ATENDIDOS
		,A.ABREVIACAO AS ABRANGENCIA
		,S.SERVICO_ESTADUALIZADO
		,COALESCE((S.VALOR_ESTADUAL_ASSISTENCIA),0) AS PREVISAO_ORCAMENTARIA
		,5 AS ORDEM
	 
  FROM TB_SERVICOS_RECURSOS_FINANCEIROS_PUBLICO S
  INNER JOIN TB_LOCAL_EXECUCAO_PUBLICO E ON(E.ID = S.ID_LOCAL_EXECUCAO_PUBLICO)
  INNER JOIN TB_UNIDADE_PUBLICA L ON(L.ID = E.ID_UNIDADE_PUBLICA AND L.ID_PREFEITURA = @ID_PREFEITURA)
  INNER JOIN TB_USUARIO_TIPO_SERVICO U ON (U.ID = S.ID_USUARIO_TIPO_SERVICO)
  INNER JOIN TB_TIPO_SERVICO T ON(T.ID = U.ID_TIPO_SERVICO AND T.ID_TIPO_PROTECAO = @ID_TIPO_PROTECAO )
  INNER JOIN TB_TIPO_PROTECAO P ON(P.ID = T.ID_TIPO_PROTECAO)
  INNER JOIN TB_ABRANGENCIA_SERVICO A ON(A.ID = S.ID_ABRANGENCIA_SERVICO)
  WHERE S.VALOR_ESTADUAL_ASSISTENCIA > 0

  UNION ALL

  SELECT S.ID		
		,L.ID AS ID_UNIDADE
		,2 AS ID_TIPO_UNIDADE
		,'Unidade Privada' AS TIPO_UNIDADE
		,(L.RAZAO_SOCIAL + (CASE WHEN L.RAZAO_SOCIAL <> E.NOME THEN ' - ' + E.NOME ELSE '' END)) AS UNIDADE
		,S.ID_USUARIO_TIPO_SERVICO
		,U.NOME AS USUARIO
		,U.ID_TIPO_SERVICO
		,(T.NOME + (CASE WHEN DESCRICAO_NAO_TIPIFICADO IS NULL THEN '' ELSE (' - ' + DESCRICAO_NAO_TIPIFICADO)END))  AS TIPO_SERVICO
		,T.ID_TIPO_PROTECAO
		,P.NOME AS PROTECAO_SOCIAL
		,S.NUMERO_ATENDIDOS_MENSAL AS NUMERO_ATENDIDOS
		,A.ABREVIACAO AS ABRANGENCIA
		,S.SERVICO_ESTADUALIZADO
		,COALESCE((S.VALOR_ESTADUAL_ASSISTENCIA),0) AS PREVISAO_ORCAMENTARIA
		,5 AS ORDEM
	 
  FROM TB_SERVICOS_RECURSOS_FINANCEIROS_PRIVADO S
  INNER JOIN TB_LOCAL_EXECUCAO_PRIVADO E ON(E.ID = S.ID_LOCAL_EXECUCAO_PRIVADO)
  INNER JOIN TB_UNIDADE_PRIVADA L ON(L.ID = E.ID_UNIDADE_PRIVADA AND L.ID_PREFEITURA = @ID_PREFEITURA)
  INNER JOIN TB_USUARIO_TIPO_SERVICO U ON (U.ID = S.ID_USUARIO_TIPO_SERVICO)
  INNER JOIN TB_TIPO_SERVICO T ON(T.ID = U.ID_TIPO_SERVICO AND T.ID_TIPO_PROTECAO = @ID_TIPO_PROTECAO )
  INNER JOIN TB_TIPO_PROTECAO P ON(P.ID = T.ID_TIPO_PROTECAO)
  INNER JOIN TB_ABRANGENCIA_SERVICO A ON(A.ID = S.ID_ABRANGENCIA_SERVICO)
  WHERE S.VALOR_ESTADUAL_ASSISTENCIA > 0

  UNION ALL

  SELECT 0 AS ID		
		,0 AS ID_UNIDADE
		,1 AS ID_TIPO_UNIDADE
		,'Programa São Paulo Solidário - Etapa de Busca Ativa' AS TIPO_UNIDADE
		,'Programa São Paulo Solidário - Etapa de Busca Ativa' AS UNIDADE
		,0 AS ID_USUARIO_TIPO_SERVICO
		,'' AS USUARIO
		,0 AS ID_TIPO_SERVICO
		,''  AS TIPO_SERVICO
		,CAST(1 AS SMALLINT) AS ID_TIPO_PROTECAO
		,'' AS PROTECAO_SOCIAL
		,0 AS NUMERO_ATENDIDOS
		,'' AS ABRANGENCIA
		,CAST(0 as BIT) AS SERVICO_ESTADUALIZADO
		,COALESCE((T.SP_SOLIDARIO_BUSCA_ATIVA_VALOR_FEAS),0) AS PREVISAO_ORCAMENTARIA
		,1 AS ORDEM
	 
  FROM TB_PROGRAMA_PROJETO T
  WHERE @ID_TIPO_PROTECAO = 1 AND T.ID_PREFEITURA = @ID_PREFEITURA AND T.PROGRAMA_ESTADUAL = 1 AND T.NOME like '%São Paulo Solidário%' AND T.ID_FASE_PROGRAMA_TRANSFERENCIA_RENDA_SP_SOLIDARIO >= 1
  AND T.SP_SOLIDARIO_BUSCA_ATIVA_ANO_TERMINO = 2014 AND (T.SP_SOLIDARIO_ANO_REPASSE_FEAS_BUSCA_ATIVA = 2014 OR (T.SP_SOLIDARIO_ANO_REPASSE_FEAS_BUSCA_ATIVA = 2013 AND T.SP_SOLIDARIO_VALOR_FEAS_RETIDO_FMAS_2014 = 1))
  AND T.SP_SOLIDARIO_BUSCA_ATIVA_VALOR_FEAS IS NOT NULL AND T.SP_SOLIDARIO_BUSCA_ATIVA_VALOR_FEAS > 0

  UNION ALL  

  SELECT 0 AS ID		
		,0 AS ID_UNIDADE
		,1 AS ID_TIPO_UNIDADE
		,'Programa São Paulo Solidário - Etapa de Além da Renda' AS TIPO_UNIDADE
		,'Programa São Paulo Solidário - Etapa de Além da Renda' AS UNIDADE
		,0 AS ID_USUARIO_TIPO_SERVICO
		,'' AS USUARIO
		,0 AS ID_TIPO_SERVICO
		,''  AS TIPO_SERVICO
		,CAST(1 AS SMALLINT) AS ID_TIPO_PROTECAO
		,'' AS PROTECAO_SOCIAL
		,0 AS NUMERO_ATENDIDOS
		,'' AS ABRANGENCIA
		,CAST(0 as BIT) AS SERVICO_ESTADUALIZADO
		,COALESCE((T.SP_SOLIDARIO_AGENDA_FAMILIA_VALOR_FEAS),0) AS PREVISAO_ORCAMENTARIA
		,2 AS ORDEM
	 
  FROM TB_PROGRAMA_PROJETO T
  WHERE @ID_TIPO_PROTECAO = 1 AND T.ID_PREFEITURA = @ID_PREFEITURA AND T.PROGRAMA_ESTADUAL = 1 AND T.NOME like '%São Paulo Solidário%' AND T.ID_FASE_PROGRAMA_TRANSFERENCIA_RENDA_SP_SOLIDARIO = 3
  AND (T.SP_SOLIDARIO_ANO_REPASSE_FEAS_AGENDA_FAMILIA = 2014 OR (T.SP_SOLIDARIO_ANO_REPASSE_FEAS_AGENDA_FAMILIA = 2013 AND T.SP_SOLIDARIO_VALOR_FEAS_RETIDO_FMAS_2014_AGENDA_FAMILIA = 1))
  AND T.SP_SOLIDARIO_AGENDA_FAMILIA_VALOR_FEAS IS NOT NULL AND T.SP_SOLIDARIO_AGENDA_FAMILIA_VALOR_FEAS > 0

  UNION ALL  

  SELECT 0 AS ID		
		,0 AS ID_UNIDADE
		,1 AS ID_TIPO_UNIDADE
		,'Implantação de CRAS conforme Resolução SEDS-004, de 25/03/2014' AS TIPO_UNIDADE
		,'Implantação de CRAS conforme Resolução SEDS-004, de 25/03/2014' AS UNIDADE
		,0 AS ID_USUARIO_TIPO_SERVICO
		,'' AS USUARIO
		,0 AS ID_TIPO_SERVICO
		,''  AS TIPO_SERVICO
		,CAST(1 AS SMALLINT) AS ID_TIPO_PROTECAO
		,'' AS PROTECAO_SOCIAL
		,0 AS NUMERO_ATENDIDOS
		,'' AS ABRANGENCIA
		,CAST(0 as BIT) AS SERVICO_ESTADUALIZADO
		,ISNULL(AP.VALOR_FEAS, 0.0) AS PREVISAO_ORCAMENTARIA
		,3 AS ORDEM
	 
  FROM TB_PREFEITURA_ACAO_PLANEJAMENTO AP
  WHERE AP.ID_PREFEITURA = @ID_PREFEITURA AND AP.ID_ACAO_PLANEJAMENTO = 26

  UNION ALL  

  SELECT 0 AS ID		
		,0 AS ID_UNIDADE
		,1 AS ID_TIPO_UNIDADE
		,'Benefício Eventual - Vulnerabilidade Temporária' AS TIPO_UNIDADE
		,'Benefício Eventual - Vulnerabilidade Temporária' AS UNIDADE
		,0 AS ID_USUARIO_TIPO_SERVICO
		,'' AS USUARIO
		,0 AS ID_TIPO_SERVICO
		,''  AS TIPO_SERVICO
		,CAST(1 AS SMALLINT) AS ID_TIPO_PROTECAO
		,'' AS PROTECAO_SOCIAL
		,0 AS NUMERO_ATENDIDOS
		,'' AS ABRANGENCIA
		,CAST(0 as BIT) AS SERVICO_ESTADUALIZADO
		,COALESCE((T.VALOR_FEAS),0) AS PREVISAO_ORCAMENTARIA
		,4 AS ORDEM
	 
  FROM TB_PREFEITURA_BENEFICIO_EVENTUAL T
  WHERE T.ID_PREFEITURA = @ID_PREFEITURA AND T.ID_TIPO_BENEFICIO_EVENTUAL = 4

  ) T
  ORDER BY T.ORDEM, T.TIPO_UNIDADE,T.UNIDADE,T.TIPO_SERVICO, T.USUARIO


update [DBPMAS2015].[dbo].[TB_RECURSO] set NOME = 'Execução financeira de 2014' where ID = 143
GO

update [DBPMAS2015].[dbo].[TB_RECURSO] set NOME = 'Relatório de Gestão 2014' where ID = 159
GO

update [DBPMAS2015].[dbo].[TB_RECURSO] set NOME = 'Acesso ao PMAS2014', PAGINA = 'http://pmas2014.homologacao.seds/Default.aspx' where ID = 161
GO

update [DBPMAS2015].[dbo].[TB_RECURSO] set NOME = 'Previsão orçamentária para 2015' where ID = 144
GO


USE [DBPMAS2015]
GO

SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE PROCEDURE [dbo].[PR_PROGRAMAS_DESENV_ANO_ANTERIOR]
@ID_PREFEITURA  INT 
AS
SELECT SUM(T.VALOR_FEDERAL_ACESSUAS) AS VALOR_FEDERAL_ACESSUAS,
	SUM(T.VALOR_MUNICIPAL_SPSOLIDARIO) AS VALOR_MUNICIPAL_SPSOLIDARIO,
	SUM(T.VALOR_ESTADUAL_SPSOLIDARIO) AS VALOR_ESTADUAL_SPSOLIDARIO,
	SUM(T.VALOR_FEDERAL_SPSOLIDARIO) AS VALOR_FEDERAL_SPSOLIDARIO,
	SUM(T.VALOR_ESTADUAL_AMIGO_IDOSO) AS VALOR_ESTADUAL_AMIGO_IDOSO,
	SUM(T.VALOR_MUNICIPAL_PROGRAMAS) AS VALOR_MUNICIPAL_PROGRAMAS,
	SUM(T.VALOR_ESTADUAL_PROGRAMAS) AS VALOR_ESTADUAL_PROGRAMAS,
	SUM(T.VALOR_FEDERAL_PROGRAMAS) AS VALOR_FEDERAL_PROGRAMAS,
	SUM(T.VALOR_ESTADUAL_RENDA_CIDADA_BENEFICIO_IDOSO) AS VALOR_ESTADUAL_RENDA_CIDADA_BENEFICIO_IDOSO
FROM
(
	SELECT cast(isnull(VALOR_PREVISAO_ANUAL_ACESSUAS, 0.0) as money) AS VALOR_FEDERAL_ACESSUAS,
	0.0 AS VALOR_MUNICIPAL_SPSOLIDARIO,
	0.0 AS VALOR_ESTADUAL_SPSOLIDARIO,
	0.0 AS VALOR_FEDERAL_SPSOLIDARIO,
	0.0 AS VALOR_ESTADUAL_AMIGO_IDOSO,
	0.0 AS VALOR_MUNICIPAL_PROGRAMAS,
	0.0 AS VALOR_ESTADUAL_PROGRAMAS,
	0.0 AS VALOR_FEDERAL_PROGRAMAS,
	0.0 AS VALOR_ESTADUAL_RENDA_CIDADA_BENEFICIO_IDOSO
	FROM [DBPMAS2014].[dbo].[TB_PROGRAMA_PROJETO]
	WHERE PROGRAMA_FEDERAL = 1 AND NOME like '%acessuas%' AND ID_PREFEITURA = @ID_PREFEITURA

	UNION ALL

	SELECT 0.0 AS VALOR_FEDERAL_ACESSUAS,
	(
		(case when ID_FASE_PROGRAMA_TRANSFERENCIA_RENDA_SP_SOLIDARIO >= 1 AND SP_SOLIDARIO_BUSCA_ATIVA_ANO_TERMINO = 2014 AND ID_FASE_PROGRAMA_TRANSFERENCIA_RENDA_SP_SOLIDARIO >= 1
			AND (SP_SOLIDARIO_ANO_REPASSE_FEAS_BUSCA_ATIVA = 2014 OR (SP_SOLIDARIO_ANO_REPASSE_FEAS_BUSCA_ATIVA = 2013 AND SP_SOLIDARIO_VALOR_FEAS_RETIDO_FMAS_2014 = 1))
		then (isnull(SP_SOLIDARIO_BUSCA_ATIVA_VALOR_FMAS, 0.0) + isnull(SP_SOLIDARIO_BUSCA_ATIVA_VALOR_ORCAMENTO_MUNICIPAL, 0.0) + isnull(SP_SOLIDARIO_BUSCA_ATIVA_VALOR_FUNDO_MUNICIPAL, 0.0))
		else 0.0
		END)
		+
		(case when ID_FASE_PROGRAMA_TRANSFERENCIA_RENDA_SP_SOLIDARIO >= 1 AND ID_FASE_PROGRAMA_TRANSFERENCIA_RENDA_SP_SOLIDARIO = 3
			AND (SP_SOLIDARIO_ANO_REPASSE_FEAS_AGENDA_FAMILIA = 2014 OR (SP_SOLIDARIO_ANO_REPASSE_FEAS_AGENDA_FAMILIA = 2013 AND SP_SOLIDARIO_VALOR_FEAS_RETIDO_FMAS_2014_AGENDA_FAMILIA = 1))
		then (isnull(SP_SOLIDARIO_AGENDA_FAMILIA_VALOR_FMAS, 0.0) + isnull(SP_SOLIDARIO_AGENDA_FAMILIA_VALOR_ORCAMENTO_MUNICIPAL, 0.0) + isnull(SP_SOLIDARIO_AGENDA_FAMILIA_VALOR_FUNDO_MUNICIPAL, 0.0))
		else 0.0
		END)
	) AS VALOR_MUNICIPAL_SPSOLIDARIO,
	(
		(case when ID_FASE_PROGRAMA_TRANSFERENCIA_RENDA_SP_SOLIDARIO >= 1 AND SP_SOLIDARIO_BUSCA_ATIVA_ANO_TERMINO = 2014 AND ID_FASE_PROGRAMA_TRANSFERENCIA_RENDA_SP_SOLIDARIO >= 1
			AND (SP_SOLIDARIO_ANO_REPASSE_FEAS_BUSCA_ATIVA = 2014 OR (SP_SOLIDARIO_ANO_REPASSE_FEAS_BUSCA_ATIVA = 2013 AND SP_SOLIDARIO_VALOR_FEAS_RETIDO_FMAS_2014 = 1))
		then isnull(SP_SOLIDARIO_BUSCA_ATIVA_VALOR_FEAS, 0.0)
		else 0.0
		END)
		+
		(case when ID_FASE_PROGRAMA_TRANSFERENCIA_RENDA_SP_SOLIDARIO >= 1 AND ID_FASE_PROGRAMA_TRANSFERENCIA_RENDA_SP_SOLIDARIO = 3
			AND (SP_SOLIDARIO_ANO_REPASSE_FEAS_AGENDA_FAMILIA = 2014 OR (SP_SOLIDARIO_ANO_REPASSE_FEAS_AGENDA_FAMILIA = 2013 AND SP_SOLIDARIO_VALOR_FEAS_RETIDO_FMAS_2014_AGENDA_FAMILIA = 1))
		then isnull(SP_SOLIDARIO_AGENDA_FAMILIA_VALOR_FEAS, 0.0)
		else 0.0
		END)
	) AS VALOR_ESTADUAL_SPSOLIDARIO,
	(
		(case when ID_FASE_PROGRAMA_TRANSFERENCIA_RENDA_SP_SOLIDARIO >= 1 AND SP_SOLIDARIO_BUSCA_ATIVA_ANO_TERMINO = 2014 AND ID_FASE_PROGRAMA_TRANSFERENCIA_RENDA_SP_SOLIDARIO >= 1
			AND (SP_SOLIDARIO_ANO_REPASSE_FEAS_BUSCA_ATIVA = 2014 OR (SP_SOLIDARIO_ANO_REPASSE_FEAS_BUSCA_ATIVA = 2013 AND SP_SOLIDARIO_VALOR_FEAS_RETIDO_FMAS_2014 = 1))
		then (isnull(SP_SOLIDARIO_BUSCA_ATIVA_VALOR_FNAS, 0.0) + isnull(SP_SOLIDARIO_BUSCA_ATIVA_VALOR_ORCAMENTO_FEDERAL, 0.0) + isnull(SP_SOLIDARIO_BUSCA_ATIVA_VALOR_FUNDO_FEDERAL, 0.0) + isnull(SP_SOLIDARIO_BUSCA_ATIVA_VALOR_IGD_PBF, 0.0) + isnull(SP_SOLIDARIO_BUSCA_ATIVA_VALOR_IGD_SUAS, 0.0))
		else 0.0
		END)
		+
		(case when ID_FASE_PROGRAMA_TRANSFERENCIA_RENDA_SP_SOLIDARIO >= 1 AND ID_FASE_PROGRAMA_TRANSFERENCIA_RENDA_SP_SOLIDARIO = 3
			AND (SP_SOLIDARIO_ANO_REPASSE_FEAS_AGENDA_FAMILIA = 2014 OR (SP_SOLIDARIO_ANO_REPASSE_FEAS_AGENDA_FAMILIA = 2013 AND SP_SOLIDARIO_VALOR_FEAS_RETIDO_FMAS_2014_AGENDA_FAMILIA = 1))
		then (isnull(SP_SOLIDARIO_AGENDA_FAMILIA_VALOR_FNAS, 0.0) + isnull(SP_SOLIDARIO_AGENDA_FAMILIA_VALOR_ORCAMENTO_FEDERAL, 0.0) + isnull(SP_SOLIDARIO_AGENDA_FAMILIA_VALOR_FUNDO_FEDERAL, 0.0) + isnull(SP_SOLIDARIO_AGENDA_FAMILIA_VALOR_IGD_PBF, 0.0) + isnull(SP_SOLIDARIO_AGENDA_FAMILIA_VALOR_IGD_SUAS, 0.0))
		else 0.0
		END)
	) AS VALOR_FEDERAL_SPSOLIDARIO,
	0.0 AS VALOR_ESTADUAL_AMIGO_IDOSO,
	0.0 AS VALOR_MUNICIPAL_PROGRAMAS,
	0.0 AS VALOR_ESTADUAL_PROGRAMAS,
	0.0 AS VALOR_FEDERAL_PROGRAMAS,
	0.0 AS VALOR_ESTADUAL_RENDA_CIDADA_BENEFICIO_IDOSO
	FROM [DBPMAS2014].[dbo].[TB_PROGRAMA_PROJETO]
	WHERE PROGRAMA_ESTADUAL = 1 AND NOME like '%são paulo solidário%' AND ID_PREFEITURA = @ID_PREFEITURA

	UNION ALL

	SELECT 0.0 AS VALOR_FEDERAL_ACESSUAS,
	0.0 AS VALOR_MUNICIPAL_SPSOLIDARIO,
	0.0 AS VALOR_ESTADUAL_SPSOLIDARIO,
	0.0 AS VALOR_FEDERAL_SPSOLIDARIO,
	(isnull(VALOR_DIA_IDOSO, 0.0) + isnull(VALOR_CONVIVENCIA_IDOSO, 0.0)) AS VALOR_ESTADUAL_AMIGO_IDOSO,
	0.0 AS VALOR_MUNICIPAL_PROGRAMAS,
	0.0 AS VALOR_ESTADUAL_PROGRAMAS,
	0.0 AS VALOR_FEDERAL_PROGRAMAS,
	(isnull(META_PACTUADA, 0.0) * 100 * 12) AS VALOR_ESTADUAL_RENDA_CIDADA_BENEFICIO_IDOSO
	FROM [DBPMAS2014].[dbo].[TB_PROGRAMA_PROJETO]
	WHERE PROGRAMA_ESTADUAL = 1 AND NOME like '%amigo do idoso%' AND ID_PREFEITURA = @ID_PREFEITURA

	UNION ALL

	SELECT 0.0 AS VALOR_FEDERAL_ACESSUAS,
	0.0 AS VALOR_MUNICIPAL_SPSOLIDARIO,
	0.0 AS VALOR_ESTADUAL_SPSOLIDARIO,
	0.0 AS VALOR_FEDERAL_SPSOLIDARIO,
	0.0 AS VALOR_ESTADUAL_AMIGO_IDOSO,
	(isnull(VALOR_FMAS, 0.0) + isnull(VALOR_ORCAMENTO_MUNICIPAL, 0.0) + isnull(VALOR_FUNDO_MUNICIPAL, 0.0)) AS VALOR_MUNICIPAL_PROGRAMAS,
	(isnull(VALOR_FEAS, 0.0) + isnull(VALOR_ORCAMENTO_ESTADUAL, 0.0) + isnull(VALOR_FUNDO_ESTADUAL, 0.0)) AS VALOR_ESTADUAL_PROGRAMAS,
	(isnull(VALOR_FNAS, 0.0) + isnull(VALOR_ORCAMENTO_FEDERAL, 0.0) + isnull(VALOR_FUNDO_FEDERAL, 0.0)) AS VALOR_FEDERAL_PROGRAMAS,
	0.0 AS VALOR_ESTADUAL_RENDA_CIDADA_BENEFICIO_IDOSO
	FROM [DBPMAS2014].[dbo].[TB_PROGRAMA_PROJETO]
	WHERE PROGRAMA_MUNICIPAL = 1 AND ID_PREFEITURA = @ID_PREFEITURA
) T


USE [DBPMAS2015]
GO
/****** Object:  StoredProcedure [dbo].[PR_BENEFICIO_EVENTUAL_2013]    Script Date: 16/05/2014 10:38:15 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO

ALTER PROCEDURE [dbo].[PR_BENEFICIO_EVENTUAL_2013]
	@ID_PREFEITURA  INT 
AS
	EXEC DBPMAS2014.DBO.PR_BENEFICIO_EVENTUAL_ANUAL @ID_PREFEITURA


USE [DBPMAS2015]
GO
/****** Object:  StoredProcedure [dbo].[PR_INDICE_GESTAO_DESCENTRALIZADA_2013]    Script Date: 16/05/2014 10:40:23 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
ALTER PROCEDURE [dbo].[PR_INDICE_GESTAO_DESCENTRALIZADA_2013]
@ID_PREFEITURA INT
AS
	SELECT ID,ID_PREFEITURA,IGD_PBF, IGD_PBF_VALOR_MENSAL, IGD_SUAS, IGD_SUAS_VALOR_MENSAL FROM DBPMAS2014.DBO.TB_INDICE_GESTAO_DESCENTRALIZADA WHERE ID_PREFEITURA = @ID_PREFEITURA


USE [DBPMAS2015]
GO
/****** Object:  StoredProcedure [dbo].[PR_PREVISAO_ORCAMENTARIA_2013]    Script Date: 16/05/2014 10:42:38 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
ALTER PROCEDURE [dbo].[PR_PREVISAO_ORCAMENTARIA_2013]
@ID_PREFEITURA  INT 
AS
  EXEC DBPMAS2014.DBO.PR_PREVISAO_ORCAMENTARIA @ID_PREFEITURA


USE [DBPMAS2015]
GO
/****** Object:  StoredProcedure [dbo].[PR_TRANSFERENCIA_RENDA_ANUAL_2013]    Script Date: 16/05/2014 10:51:47 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
ALTER PROCEDURE [dbo].[PR_TRANSFERENCIA_RENDA_ANUAL_2013]
	@ID_PREFEITURA INT, @ID_TIPO_TRANSFERENCIA_RENDA INT =	NULL
AS	
	EXEC DBPMAS2014.DBO.PR_TRANSFERENCIA_RENDA_ANUAL @ID_PREFEITURA, @ID_TIPO_TRANSFERENCIA_RENDA


delete [DBPMAS2015].[dbo].[TB_USUARIO_TIPO_SERVICOxSITUACAO_ESPECIFICA]
where id_situacao_especifica = 10 and id_usuario_tipo_servico in (5,6,12,13,14,19,22,23,27,31,32,33,37,41,50,51,52,55,56,57)


ALTER TABLE [DBPMAS2015].[dbo].[TB_CRAS] ADD
	DATA_IMPLANTACAO datetime NULL
GO

ALTER TABLE [DBPMAS2015].[dbo].[TB_CREAS] ADD
	DATA_IMPLANTACAO datetime NULL
GO

ALTER TABLE [DBPMAS2015].[dbo].[TB_CENTRO_POP] ADD
	DATA_IMPLANTACAO datetime NULL
GO


ALTER TABLE [DBPMAS2015].[dbo].[TB_SERVICOS_RECURSOS_FINANCEIROS_CRAS] ADD
	POSSUI_TECNICO_RESPONSAVEL bit NULL,
	NOME_TECNICO_RESPONSAVEL nvarchar(max)
GO

ALTER TABLE [DBPMAS2015].[dbo].[TB_SERVICOS_RECURSOS_FINANCEIROS_CREAS] ADD
	POSSUI_TECNICO_RESPONSAVEL bit NULL,
	NOME_TECNICO_RESPONSAVEL nvarchar(max)
GO

ALTER TABLE [DBPMAS2015].[dbo].[TB_SERVICOS_RECURSOS_FINANCEIROS_CENTRO_POP] ADD
	POSSUI_TECNICO_RESPONSAVEL bit NULL,
	NOME_TECNICO_RESPONSAVEL nvarchar(max)
GO

ALTER TABLE [DBPMAS2015].[dbo].[TB_SERVICOS_RECURSOS_FINANCEIROS_PUBLICO] ADD
	POSSUI_TECNICO_RESPONSAVEL bit NULL,
	NOME_TECNICO_RESPONSAVEL nvarchar(max)
GO

ALTER TABLE [DBPMAS2015].[dbo].[TB_SERVICOS_RECURSOS_FINANCEIROS_PRIVADO] ADD
	POSSUI_TECNICO_RESPONSAVEL bit NULL,
	NOME_TECNICO_RESPONSAVEL nvarchar(max)
GO


USE [DBPMAS2015]
GO

/****** Object:  Table [dbo].[TB_MOTIVO_ESTADUALIZADO]    Script Date: 22/05/2014 10:07:42 ******/
SET ANSI_NULLS ON
GO

SET QUOTED_IDENTIFIER ON
GO

CREATE TABLE [dbo].[TB_MOTIVO_ESTADUALIZADO](
	[ID] [int] IDENTITY(1,1) NOT NULL,
	[NOME] [nvarchar](max) NOT NULL,
 CONSTRAINT [PK_TB_MOTIVO_ESTADUALIZADO] PRIMARY KEY CLUSTERED 
(
	[ID] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY] TEXTIMAGE_ON [PRIMARY]

GO


ALTER TABLE dbo.TB_SERVICOS_RECURSOS_FINANCEIROS_PRIVADO ADD
	ID_MOTIVO_ESTADUALIZADO int NULL
GO
ALTER TABLE dbo.TB_SERVICOS_RECURSOS_FINANCEIROS_PRIVADO ADD CONSTRAINT
	FK_TB_SERVICOS_RECURSOS_FINANCEIROS_PRIVADO_TB_MOTIVO_ESTADUALIZADO FOREIGN KEY
	(
	ID_MOTIVO_ESTADUALIZADO
	) REFERENCES dbo.TB_MOTIVO_ESTADUALIZADO
	(
	ID
	) ON UPDATE  NO ACTION 
	 ON DELETE  NO ACTION 
	
GO

insert [DBPMAS2015].[dbo].[TB_MOTIVO_ESTADUALIZADO] (NOME) values ('Convênio mantido pelo Estado para atendimento de demanda regional')
insert [DBPMAS2015].[dbo].[TB_MOTIVO_ESTADUALIZADO] (NOME) values ('Por impedimento do município de receber repasse estadual')



USE [DBPMAS2015]
GO

SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO

CREATE VIEW [dbo].[VW_MANTENEDORA_PRO_SOCIAL]
AS
select 
m.MANT_CNPJ,
s.SIT_DESC,
mi.MOT_INAT_DESC,
m.MANT_RAZAO_SOCIAL,
m.MANT_NOME_FANTASIA,
m.MANT_ENDERECO,
mun.MUN_DC_MUNICIPIO,
m.MANT_CEP,
m.MANT_END_NUMERO,
m.MANT_END_COMPL,
m.MANT_END_BAIRRO,
m.MANT_FONE,
m.MANT_FAX,
m.MANT_EMAIL,
m.MANT_HOME_PAGE,
m.MANT_NOME_RESPONSAVEL,
c.CAR_DC,
convert(varchar, m.MANT_RESP_MANDATO_INIC, 103) as MANT_RESP_MANDATO_INIC,
convert(varchar, m.MANT_RESP_MANDATO_FIM, 103) as MANT_RESP_MANDATO_FIM,
a.AATU_ID,
m.FATU_ID,
r.RINST_NUMERO,
r.RINST_DT_PUBLICACAO,
r.RINST_VALIDADE

from [DBINSTITUICAO].[dbo].[TB_MANTENEDORA] m
left join [DBINSTITUICAO].[dbo].[TB_SITUACAO] s on m.SIT_ID = s.SIT_ID
left join [DBINSTITUICAO].[dbo].[TB_MOTIVO_INATIVACAO] mi on m.MOT_INAT_ID = mi.MOT_INAT_ID
left join [DBINSTITUICAO].[dbo].[TB_CARGOS] c on m.CAR_ID = c.CAR_ID
left join [DBINSTITUICAO].[dbo].[TB_AREA_ATUACAO_MANTENEDORA] a on m.MANT_ID = a.MANT_ID
left join [DBINSTITUICAO].[dbo].[TB_MUNICIPIOS] mun on m.MUN_ID_MUNICIPIO = mun.MUN_ID_MUNICIPIO
left join [DBINSTITUICAO].[dbo].[TB_REGISTROS_INSTITUICOES] r on m.MANT_ID = r.MANT_ID

GO


USE [DBPMAS2015]
GO

SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO

CREATE VIEW [dbo].[VW_AREA_ATUACAO_PRO_SOCIAL]
AS
SELECT [AATU_ID]
      ,[AATU_DC]
      ,[AATU_INFORMACOES_ADICIONAIS]
      ,[AATU_EXIBE]
FROM [DBINSTITUICAO].[dbo].[TB_AREA_ATUACAO]
GO


USE [DBPMAS2015]
GO

SET ANSI_NULLS ON
GO

SET QUOTED_IDENTIFIER ON
GO

CREATE TABLE [dbo].[TB_FORMA_ATUACAO](
	[ID] [int] IDENTITY(1,1) NOT NULL,
	[NOME] [nvarchar](max) NOT NULL,
 CONSTRAINT [PK_TB_FORMA_ATUACAO] PRIMARY KEY CLUSTERED 
(
	[ID] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY] TEXTIMAGE_ON [PRIMARY]

GO


insert [DBPMAS2015].[dbo].[TB_FORMA_ATUACAO] (NOME) values ('De Atendimento')
insert [DBPMAS2015].[dbo].[TB_FORMA_ATUACAO] (NOME) values ('De Assessoramento')
insert [DBPMAS2015].[dbo].[TB_FORMA_ATUACAO] (NOME) values ('De Defesa e Garantia de Direitos')
insert [DBPMAS2015].[dbo].[TB_FORMA_ATUACAO] (NOME) values ('Somente sede Administrativa')


USE [DBPMAS2015]
GO

SET ANSI_NULLS ON
GO

SET QUOTED_IDENTIFIER ON
GO

CREATE TABLE [dbo].[TB_CARACTERIZACAO_ATIVIDADES](
	[ID] [int] IDENTITY(1,1) NOT NULL,
	[NOME] [nvarchar](max) NOT NULL,
 CONSTRAINT [PK_TB_CARACTERIZACAO_ATIVIDADES] PRIMARY KEY CLUSTERED 
(
	[ID] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY] TEXTIMAGE_ON [PRIMARY]

GO


insert [DBPMAS2015].[dbo].[TB_CARACTERIZACAO_ATIVIDADES] (NOME)
values ('Assessoramento político, técnico, admnistrativo e financeiro')

insert [DBPMAS2015].[dbo].[TB_CARACTERIZACAO_ATIVIDADES] (NOME)
values ('Sistematização e disseminação de projetos para enfrentamento da pobreza')

insert [DBPMAS2015].[dbo].[TB_CARACTERIZACAO_ATIVIDADES] (NOME)
values ('Estímulo ao desenvolvimento sustentável e à geração de renda')

insert [DBPMAS2015].[dbo].[TB_CARACTERIZACAO_ATIVIDADES] (NOME)
values ('Promoção e socialização de estudos e pesquisas')

insert [DBPMAS2015].[dbo].[TB_CARACTERIZACAO_ATIVIDADES] (NOME)
values ('Promoção da defesa de direitos')

insert [DBPMAS2015].[dbo].[TB_CARACTERIZACAO_ATIVIDADES] (NOME)
values ('Reivindicação da construção de novos direitos')

insert [DBPMAS2015].[dbo].[TB_CARACTERIZACAO_ATIVIDADES] (NOME)
values ('Formação político cidadã de grupos populares')

insert [DBPMAS2015].[dbo].[TB_CARACTERIZACAO_ATIVIDADES] (NOME)
values ('Ações de monitoramento e controle popular')


ALTER TABLE dbo.TB_UNIDADE_PRIVADA ADD
	ID_CARACTERIZACAO_ATIVIDADE int NULL,
	ID_AREA_ATUACAO int NULL,
	ID_FORMA_ATUACAO int NULL,
	PUBLICO_ALVO nvarchar(MAX) NULL,
	INSCRICAO_CMAS nvarchar(MAX) NULL,
	DATA_PUBLICACAO datetime NULL,
	DATA_VALIDADE datetime NULL
GO
ALTER TABLE dbo.TB_UNIDADE_PRIVADA ADD CONSTRAINT
	FK_TB_UNIDADE_PRIVADA_TB_CARACTERIZACAO_ATIVIDADES FOREIGN KEY
	(
	ID_CARACTERIZACAO_ATIVIDADE
	) REFERENCES dbo.TB_CARACTERIZACAO_ATIVIDADES
	(
	ID
	) ON UPDATE  NO ACTION 
	 ON DELETE  NO ACTION 
	
GO



USE [DBPMAS2015]
GO

SET ANSI_NULLS ON
GO

SET QUOTED_IDENTIFIER ON
GO

ALTER VIEW [dbo].[VW_UNIDADE_PRIVADA]
AS    
SELECT   T.ID
		 ,RAZAO_SOCIAL
		 ,CNPJ
		 ,ID_PREFEITURA
		 ,COUNT(L.ID) AS TOTAL_LOCAIS
		,CASE (SELECT  COUNT(A.ID)  
			 FROM TB_LOCAL_EXECUCAO_PRIVADO A
			 INNER JOIN TB_SERVICOS_RECURSOS_FINANCEIROS_PRIVADO B ON(A.ID = B.ID_LOCAL_EXECUCAO_PRIVADO)			             
			WHERE (B.VALOR_ESTADUAL_ASSISTENCIA > 0)
              AND A.ID_UNIDADE_PRIVADA = T.ID)   
   WHEN 0   
   THEN 'Não'   
   ELSE 'Sim'   
   END 'COFINANCIAMENTO'		
		,CASE (SELECT COUNT(B.SERVICO_ESTADUALIZADO)
				 FROM TB_LOCAL_EXECUCAO_PRIVADO A
			    INNER JOIN TB_SERVICOS_RECURSOS_FINANCEIROS_PRIVADO B
				   ON A.ID = B.ID_LOCAL_EXECUCAO_PRIVADO
				WHERE A.ID_UNIDADE_PRIVADA = T.ID
				  and B.SERVICO_ESTADUALIZADO = 1)
		WHEN 0
		  THEN 'Não'
		  ELSE 'Sim'   
    END 'ESTADUALIZADO'  
	,(SELECT COALESCE(SUM(COALESCE(S.VALOR_ESTADUAL_ASSISTENCIA ,0) ),0) FROM TB_SERVICOS_RECURSOS_FINANCEIROS_PRIVADO S
		INNER JOIN TB_LOCAL_EXECUCAO_PRIVADO L ON(L.ID = S.ID_LOCAL_EXECUCAO_PRIVADO AND L.ID_UNIDADE_PRIVADA = T.ID)) AS VALOR_COFINANCIAMENTO_ESTADUAL		
	,(SELECT COALESCE(SUM(S.NUMERO_ATENDIDOS),0) FROM TB_SERVICOS_RECURSOS_FINANCEIROS_PRIVADO S
	INNER JOIN TB_LOCAL_EXECUCAO_PRIVADO L ON(L.ID = S.ID_LOCAL_EXECUCAO_PRIVADO AND L.ID_UNIDADE_PRIVADA = T.ID)) AS NUMERO_ATENDIDOS		
	,(SELECT COALESCE(SUM(R.VALOR_MUNICIPAL_ASSISTENCIA + R.VALOR_MUNICIPAL_FMDCA + R.VALOR_ESTADUAL_ASSISTENCIA + R.VALOR_ESTADUAL_FEDCA + R.VALOR_FEDERAL_ASSISTENCIA + R.VALOR_FEDERAL_FNDCA + ISNULL(R.VALOR_MUNICIPAL_FMI, 0.0) + ISNULL(R.VALOR_ESTADUAL_FEI, 0.0) + ISNULL(R.VALOR_FEDERAL_FNI, 0.0) + COALESCE(R.VALOR_ESTADUALIZADO,0) + R.VALOR_PRIVADO_EMPRESAS + R.VALOR_PRIVADO_PESSOAS_FISICAS + R.VALOR_PRIVADO_ORGANIZACOES + R.VALOR_PRIVADO_PROPRIOS),0) 
	FROM TB_SERVICOS_RECURSOS_FINANCEIROS_PRIVADO R
	INNER JOIN TB_LOCAL_EXECUCAO_PRIVADO L ON(L.ID = R.ID_LOCAL_EXECUCAO_PRIVADO AND L.ID_UNIDADE_PRIVADA = T.ID)) AS PREVISAO_ORCAMENTARIA
	,case (select isnull(A.ID_FORMA_ATUACAO, 0) FROM TB_UNIDADE_PRIVADA A where A.ID = T.ID)
	 when 0 then '' else (select FA.FATU_DC from [DBINSTITUICAO].[dbo].[TB_FORMA_ATUACAO] FA where FA.FATU_ID = T.ID_FORMA_ATUACAO)
	 end 'FORMA_ATUACAO'

 FROM TB_UNIDADE_PRIVADA AS T
 LEFT JOIN TB_LOCAL_EXECUCAO_PRIVADO L ON(L.ID_UNIDADE_PRIVADA = T.ID)
 GROUP BY T.ID,T.RAZAO_SOCIAL,T.CNPJ,T.ID_PREFEITURA, T.ID_FORMA_ATUACAO

GO


USE [DBPMAS2015]
GO

SET ANSI_NULLS ON
GO

SET QUOTED_IDENTIFIER ON
GO

ALTER VIEW [dbo].[VW_PROGRAMA_PROJETO]
AS
SELECT	P.ID,
		P.ID_PREFEITURA,
		P.NOME,
		CASE ((SELECT  COUNT(A.ID)  
				FROM TB_SERVICOS_RECURSOS_FINANCEIROS_PUBLICO A 
				INNER JOIN TB_PROGRAMA_PROJETO_COFINANCIAMENTO C ON(C.ID_SERVICOS_RECURSOS_FINANCEIROS_PUBLICO = A.ID)			             
				WHERE C.ID_PROGRAMA_PROJETO = P.ID AND A.VALOR_ESTADUAL_ASSISTENCIA > 0)
				+
				(SELECT  COUNT(A.ID)  
				FROM TB_SERVICOS_RECURSOS_FINANCEIROS_PRIVADO A 
				INNER JOIN TB_PROGRAMA_PROJETO_COFINANCIAMENTO C ON(C.ID_SERVICOS_RECURSOS_FINANCEIROS_PRIVADO = A.ID)			             
				WHERE C.ID_PROGRAMA_PROJETO = P.ID AND A.VALOR_ESTADUAL_ASSISTENCIA > 0)
				+
				(SELECT  COUNT(A.ID)  
				FROM TB_SERVICOS_RECURSOS_FINANCEIROS_CRAS A 
				INNER JOIN TB_PROGRAMA_PROJETO_COFINANCIAMENTO C ON(C.ID_SERVICOS_RECURSOS_FINANCEIROS_CRAS = A.ID)			             
				WHERE C.ID_PROGRAMA_PROJETO = P.ID AND A.VALOR_ESTADUAL_ASSISTENCIA > 0)
				+
				(SELECT  COUNT(A.ID)  
				FROM TB_SERVICOS_RECURSOS_FINANCEIROS_CREAS A 
				INNER JOIN TB_PROGRAMA_PROJETO_COFINANCIAMENTO C ON(C.ID_SERVICOS_RECURSOS_FINANCEIROS_CREAS = A.ID)			             
				WHERE C.ID_PROGRAMA_PROJETO = P.ID AND A.VALOR_ESTADUAL_ASSISTENCIA > 0)
				+
				(SELECT  COUNT(A.ID)  
				FROM TB_SERVICOS_RECURSOS_FINANCEIROS_CENTRO_POP A 
				INNER JOIN TB_PROGRAMA_PROJETO_COFINANCIAMENTO C ON(C.ID_SERVICOS_RECURSOS_FINANCEIROS_CENTRO_POP = A.ID)			             
				WHERE C.ID_PROGRAMA_PROJETO = P.ID AND A.VALOR_ESTADUAL_ASSISTENCIA > 0)
			)   
	WHEN 0   
	THEN 'Não'   
	ELSE 'Sim'   
	END 'COFINANCIAMENTO'		
	,CASE ((SELECT COUNT(A.ID)  
				FROM TB_SERVICOS_RECURSOS_FINANCEIROS_PUBLICO A 
				INNER JOIN TB_PROGRAMA_PROJETO_COFINANCIAMENTO C ON(C.ID_SERVICOS_RECURSOS_FINANCEIROS_PUBLICO = A.ID)			             
				WHERE C.ID_PROGRAMA_PROJETO = P.ID AND A.SERVICO_ESTADUALIZADO = 1)
				+
				(SELECT COUNT(A.ID)  
				FROM TB_SERVICOS_RECURSOS_FINANCEIROS_PRIVADO A 
				INNER JOIN TB_PROGRAMA_PROJETO_COFINANCIAMENTO C ON(C.ID_SERVICOS_RECURSOS_FINANCEIROS_PRIVADO = A.ID)			             
				WHERE C.ID_PROGRAMA_PROJETO = P.ID AND A.SERVICO_ESTADUALIZADO = 1)
				+
				(SELECT COUNT(A.ID)  
				FROM TB_SERVICOS_RECURSOS_FINANCEIROS_CRAS A 
				INNER JOIN TB_PROGRAMA_PROJETO_COFINANCIAMENTO C ON(C.ID_SERVICOS_RECURSOS_FINANCEIROS_CRAS = A.ID)			             
				WHERE C.ID_PROGRAMA_PROJETO = P.ID AND A.SERVICO_ESTADUALIZADO = 1)
				+
				(SELECT COUNT(A.ID)  
				FROM TB_SERVICOS_RECURSOS_FINANCEIROS_CREAS A 
				INNER JOIN TB_PROGRAMA_PROJETO_COFINANCIAMENTO C ON(C.ID_SERVICOS_RECURSOS_FINANCEIROS_CREAS = A.ID)			             
				WHERE C.ID_PROGRAMA_PROJETO = P.ID AND A.SERVICO_ESTADUALIZADO = 1)
				+
				(SELECT COUNT(A.ID)  
				FROM TB_SERVICOS_RECURSOS_FINANCEIROS_CENTRO_POP A 
				INNER JOIN TB_PROGRAMA_PROJETO_COFINANCIAMENTO C ON(C.ID_SERVICOS_RECURSOS_FINANCEIROS_CENTRO_POP = A.ID)			             
				WHERE C.ID_PROGRAMA_PROJETO = P.ID AND A.SERVICO_ESTADUALIZADO = 1)
			)
		WHEN 0
		THEN 'Não'
		ELSE 'Sim'   
		END 'ESTADUALIZADO'  
		,COUNT(C.ID) AS TOTAL_SERVICOS
		,(
		COALESCE((SELECT SUM(A.VALOR_MUNICIPAL_ASSISTENCIA + A.VALOR_MUNICIPAL_FMDCA + A.VALOR_ESTADUAL_ASSISTENCIA + A.VALOR_ESTADUAL_FEDCA + A.VALOR_FEDERAL_ASSISTENCIA + A.VALOR_FEDERAL_FNDCA + COALESCE(A.VALOR_ESTADUALIZADO,0))
				FROM TB_SERVICOS_RECURSOS_FINANCEIROS_PUBLICO A 
				INNER JOIN TB_PROGRAMA_PROJETO_COFINANCIAMENTO C ON(C.ID_SERVICOS_RECURSOS_FINANCEIROS_PUBLICO = A.ID)			             
				WHERE C.ID_PROGRAMA_PROJETO = P.ID
		),0) 
		+
		COALESCE((SELECT SUM(A.VALOR_MUNICIPAL_ASSISTENCIA + A.VALOR_MUNICIPAL_FMDCA + A.VALOR_ESTADUAL_ASSISTENCIA + A.VALOR_ESTADUAL_FEDCA + A.VALOR_FEDERAL_ASSISTENCIA + A.VALOR_FEDERAL_FNDCA + COALESCE(A.VALOR_ESTADUALIZADO,0) + A.VALOR_PRIVADO_EMPRESAS + A.VALOR_PRIVADO_PESSOAS_FISICAS + A.VALOR_PRIVADO_ORGANIZACOES + A.VALOR_PRIVADO_PROPRIOS)
				FROM TB_SERVICOS_RECURSOS_FINANCEIROS_PRIVADO A 
				INNER JOIN TB_PROGRAMA_PROJETO_COFINANCIAMENTO C ON(C.ID_SERVICOS_RECURSOS_FINANCEIROS_PRIVADO = A.ID)			             
				WHERE C.ID_PROGRAMA_PROJETO = P.ID
		),0) 
		+
		COALESCE((SELECT SUM(A.VALOR_MUNICIPAL_ASSISTENCIA + A.VALOR_MUNICIPAL_FMDCA + A.VALOR_ESTADUAL_ASSISTENCIA + A.VALOR_ESTADUAL_FEDCA + A.VALOR_FEDERAL_ASSISTENCIA + A.VALOR_FEDERAL_FNDCA + COALESCE(A.VALOR_ESTADUALIZADO,0))
				FROM TB_SERVICOS_RECURSOS_FINANCEIROS_CREAS A 
				INNER JOIN TB_PROGRAMA_PROJETO_COFINANCIAMENTO C ON(C.ID_SERVICOS_RECURSOS_FINANCEIROS_CREAS = A.ID)			             
				WHERE C.ID_PROGRAMA_PROJETO = P.ID
		),0) 
		+
		COALESCE((SELECT SUM(A.VALOR_MUNICIPAL_ASSISTENCIA + A.VALOR_MUNICIPAL_FMDCA + A.VALOR_ESTADUAL_ASSISTENCIA + A.VALOR_ESTADUAL_FEDCA + A.VALOR_FEDERAL_ASSISTENCIA + A.VALOR_FEDERAL_FNDCA + COALESCE(A.VALOR_ESTADUALIZADO,0))
				FROM TB_SERVICOS_RECURSOS_FINANCEIROS_CRAS A 
				INNER JOIN TB_PROGRAMA_PROJETO_COFINANCIAMENTO C ON(C.ID_SERVICOS_RECURSOS_FINANCEIROS_CRAS = A.ID)			             
				WHERE C.ID_PROGRAMA_PROJETO = P.ID
		),0) 
		+
		COALESCE((SELECT SUM(A.VALOR_MUNICIPAL_ASSISTENCIA + A.VALOR_MUNICIPAL_FMDCA + A.VALOR_ESTADUAL_ASSISTENCIA + A.VALOR_ESTADUAL_FEDCA + A.VALOR_FEDERAL_ASSISTENCIA + A.VALOR_FEDERAL_FNDCA + COALESCE(A.VALOR_ESTADUALIZADO,0))
				FROM TB_SERVICOS_RECURSOS_FINANCEIROS_CENTRO_POP A 
				INNER JOIN TB_PROGRAMA_PROJETO_COFINANCIAMENTO C ON(C.ID_SERVICOS_RECURSOS_FINANCEIROS_CENTRO_POP = A.ID)			             
				WHERE C.ID_PROGRAMA_PROJETO = P.ID
		),0)
		) AS PREVISAO_ORCAMENTARIA,
		isnull(P.PROGRAMA_MUNICIPAL, 0) PROGRAMA_MUNICIPAL,
		isnull(P.PROGRAMA_ESTADUAL, 0) PROGRAMA_ESTADUAL,
		isnull(P.PROGRAMA_FEDERAL, 0) PROGRAMA_FEDERAL,
		isnull(P.BENEFICIARIO_ATENDIDO_REDE_SOCIOASSISTENCIAL, 0) BENEFICIARIO_ATENDIDO_REDE_SOCIOASSISTENCIAL,
		case
		when P.NOME like '%acessuas%' and isnull(P.VALOR_PREVISAO_ANUAL_ACESSUAS, 0.0) > 0.0 then 1
		when P.NOME like '%solidário%' and (isnull(P.SP_SOLIDARIO_BUSCA_ATIVA_MES_INICIO, 0) > 0 or isnull(P.SP_SOLIDARIO_BUSCA_ATIVA_MES_TERMINO, 0) > 0 or isnull(P.SP_SOLIDARIO_BUSCA_ATIVA_ANO_INICIO, 0) > 0 or isnull(P.SP_SOLIDARIO_BUSCA_ATIVA_ANO_TERMINO, 0) > 0) then 1
		when P.NOME like '%amigo do idoso%' and (isnull(P.META_PACTUADA, 0.0) > 0.0 or isnull(P.VALOR_DIA_IDOSO, 0.0) > 0.0 or isnull(P.VALOR_CONVIVENCIA_IDOSO, 0.0) > 0.0) then 1
		else 0
		end ADERIU_BENEFICIO
	FROM TB_PROGRAMA_PROJETO P
	LEFT JOIN TB_PROGRAMA_PROJETO_COFINANCIAMENTO C ON(C.ID_PROGRAMA_PROJETO = P.ID)	
	GROUP BY P.ID, P.NOME,P.ID_PREFEITURA, P.PROGRAMA_MUNICIPAL, P.PROGRAMA_ESTADUAL, P.PROGRAMA_FEDERAL, P.BENEFICIARIO_ATENDIDO_REDE_SOCIOASSISTENCIAL,
	P.VALOR_PREVISAO_ANUAL_ACESSUAS, P.SP_SOLIDARIO_BUSCA_ATIVA_VALOR_FEAS, P.META_PACTUADA, P.VALOR_DIA_IDOSO, P.VALOR_CONVIVENCIA_IDOSO,
	P.SP_SOLIDARIO_BUSCA_ATIVA_MES_INICIO, P.SP_SOLIDARIO_BUSCA_ATIVA_MES_TERMINO, P.SP_SOLIDARIO_BUSCA_ATIVA_ANO_INICIO, P.SP_SOLIDARIO_BUSCA_ATIVA_ANO_TERMINO


UNION ALL

SELECT	P.ID,
		P.ID_PREFEITURA,
		P.NOME,
		CASE ((SELECT  COUNT(A.ID)  
				FROM TB_SERVICOS_RECURSOS_FINANCEIROS_PUBLICO A 
				INNER JOIN TB_TRANSFERENCIA_RENDA_COFINANCIAMENTO C ON(C.ID_SERVICOS_RECURSOS_FINANCEIROS_PUBLICO = A.ID)			             
				WHERE C.ID_TRANSFERENCIA_RENDA = P.ID AND A.VALOR_ESTADUAL_ASSISTENCIA > 0)
				+
				(SELECT  COUNT(A.ID)  
				FROM TB_SERVICOS_RECURSOS_FINANCEIROS_PRIVADO A 
				INNER JOIN TB_TRANSFERENCIA_RENDA_COFINANCIAMENTO C ON(C.ID_SERVICOS_RECURSOS_FINANCEIROS_PRIVADO = A.ID)			             
				WHERE C.ID_TRANSFERENCIA_RENDA = P.ID AND A.VALOR_ESTADUAL_ASSISTENCIA > 0)
				+
				(SELECT  COUNT(A.ID)  
				FROM TB_SERVICOS_RECURSOS_FINANCEIROS_CRAS A 
				INNER JOIN TB_TRANSFERENCIA_RENDA_COFINANCIAMENTO C ON(C.ID_SERVICOS_RECURSOS_FINANCEIROS_CRAS = A.ID)			             
				WHERE C.ID_TRANSFERENCIA_RENDA = P.ID AND A.VALOR_ESTADUAL_ASSISTENCIA > 0)
				+
				(SELECT  COUNT(A.ID)  
				FROM TB_SERVICOS_RECURSOS_FINANCEIROS_CREAS A 
				INNER JOIN TB_TRANSFERENCIA_RENDA_COFINANCIAMENTO C ON(C.ID_SERVICOS_RECURSOS_FINANCEIROS_CREAS = A.ID)			             
				WHERE C.ID_TRANSFERENCIA_RENDA = P.ID AND A.VALOR_ESTADUAL_ASSISTENCIA > 0)
				+
				(SELECT  COUNT(A.ID)  
				FROM TB_SERVICOS_RECURSOS_FINANCEIROS_CENTRO_POP A 
				INNER JOIN TB_TRANSFERENCIA_RENDA_COFINANCIAMENTO C ON(C.ID_SERVICOS_RECURSOS_FINANCEIROS_CENTRO_POP = A.ID)			             
				WHERE C.ID_TRANSFERENCIA_RENDA = P.ID AND A.VALOR_ESTADUAL_ASSISTENCIA > 0)
			)   
	WHEN 0   
	THEN 'Não'   
	ELSE 'Sim'   
	END 'COFINANCIAMENTO'		
	,CASE ((SELECT COUNT(A.ID)  
				FROM TB_SERVICOS_RECURSOS_FINANCEIROS_PUBLICO A 
				INNER JOIN TB_TRANSFERENCIA_RENDA_COFINANCIAMENTO C ON(C.ID_SERVICOS_RECURSOS_FINANCEIROS_PUBLICO = A.ID)			             
				WHERE C.ID_TRANSFERENCIA_RENDA = P.ID AND A.SERVICO_ESTADUALIZADO = 1)
				+
				(SELECT COUNT(A.ID)  
				FROM TB_SERVICOS_RECURSOS_FINANCEIROS_PRIVADO A 
				INNER JOIN TB_TRANSFERENCIA_RENDA_COFINANCIAMENTO C ON(C.ID_SERVICOS_RECURSOS_FINANCEIROS_PRIVADO = A.ID)			             
				WHERE C.ID_TRANSFERENCIA_RENDA = P.ID AND A.SERVICO_ESTADUALIZADO = 1)
				+
				(SELECT COUNT(A.ID)  
				FROM TB_SERVICOS_RECURSOS_FINANCEIROS_CRAS A 
				INNER JOIN TB_TRANSFERENCIA_RENDA_COFINANCIAMENTO C ON(C.ID_SERVICOS_RECURSOS_FINANCEIROS_CRAS = A.ID)			             
				WHERE C.ID_TRANSFERENCIA_RENDA = P.ID AND A.SERVICO_ESTADUALIZADO = 1)
				+
				(SELECT COUNT(A.ID)  
				FROM TB_SERVICOS_RECURSOS_FINANCEIROS_CREAS A 
				INNER JOIN TB_TRANSFERENCIA_RENDA_COFINANCIAMENTO C ON(C.ID_SERVICOS_RECURSOS_FINANCEIROS_CREAS = A.ID)			             
				WHERE C.ID_TRANSFERENCIA_RENDA = P.ID AND A.SERVICO_ESTADUALIZADO = 1)
				+
				(SELECT COUNT(A.ID)  
				FROM TB_SERVICOS_RECURSOS_FINANCEIROS_CENTRO_POP A 
				INNER JOIN TB_TRANSFERENCIA_RENDA_COFINANCIAMENTO C ON(C.ID_SERVICOS_RECURSOS_FINANCEIROS_CENTRO_POP = A.ID)			             
				WHERE C.ID_TRANSFERENCIA_RENDA = P.ID AND A.SERVICO_ESTADUALIZADO = 1)
			)
		WHEN 0
		THEN 'Não'
		ELSE 'Sim'   
		END 'ESTADUALIZADO'  
		,COUNT(C.ID) AS TOTAL_SERVICOS
		,(
		COALESCE((SELECT SUM(A.VALOR_MUNICIPAL_ASSISTENCIA + A.VALOR_MUNICIPAL_FMDCA + A.VALOR_ESTADUAL_ASSISTENCIA + A.VALOR_ESTADUAL_FEDCA + A.VALOR_FEDERAL_ASSISTENCIA + A.VALOR_FEDERAL_FNDCA + COALESCE(A.VALOR_ESTADUALIZADO,0))
				FROM TB_SERVICOS_RECURSOS_FINANCEIROS_PUBLICO A 
				INNER JOIN TB_TRANSFERENCIA_RENDA_COFINANCIAMENTO C ON(C.ID_SERVICOS_RECURSOS_FINANCEIROS_PUBLICO = A.ID)			             
				WHERE C.ID_TRANSFERENCIA_RENDA = P.ID
		),0) 
		+
		COALESCE((SELECT SUM(A.VALOR_MUNICIPAL_ASSISTENCIA + A.VALOR_MUNICIPAL_FMDCA + A.VALOR_ESTADUAL_ASSISTENCIA + A.VALOR_ESTADUAL_FEDCA + A.VALOR_FEDERAL_ASSISTENCIA + A.VALOR_FEDERAL_FNDCA + COALESCE(A.VALOR_ESTADUALIZADO,0) + A.VALOR_PRIVADO_EMPRESAS + A.VALOR_PRIVADO_PESSOAS_FISICAS + A.VALOR_PRIVADO_ORGANIZACOES + A.VALOR_PRIVADO_PROPRIOS)
				FROM TB_SERVICOS_RECURSOS_FINANCEIROS_PRIVADO A 
				INNER JOIN TB_TRANSFERENCIA_RENDA_COFINANCIAMENTO C ON(C.ID_SERVICOS_RECURSOS_FINANCEIROS_PRIVADO = A.ID)			             
				WHERE C.ID_TRANSFERENCIA_RENDA = P.ID
		),0) 
		+
		COALESCE((SELECT SUM(A.VALOR_MUNICIPAL_ASSISTENCIA + A.VALOR_MUNICIPAL_FMDCA + A.VALOR_ESTADUAL_ASSISTENCIA + A.VALOR_ESTADUAL_FEDCA + A.VALOR_FEDERAL_ASSISTENCIA + A.VALOR_FEDERAL_FNDCA + COALESCE(A.VALOR_ESTADUALIZADO,0))
				FROM TB_SERVICOS_RECURSOS_FINANCEIROS_CREAS A 
				INNER JOIN TB_TRANSFERENCIA_RENDA_COFINANCIAMENTO C ON(C.ID_SERVICOS_RECURSOS_FINANCEIROS_CREAS = A.ID)			             
				WHERE C.ID_TRANSFERENCIA_RENDA = P.ID
		),0) 
		+
		COALESCE((SELECT SUM(A.VALOR_MUNICIPAL_ASSISTENCIA + A.VALOR_MUNICIPAL_FMDCA + A.VALOR_ESTADUAL_ASSISTENCIA + A.VALOR_ESTADUAL_FEDCA + A.VALOR_FEDERAL_ASSISTENCIA + A.VALOR_FEDERAL_FNDCA + COALESCE(A.VALOR_ESTADUALIZADO,0))
				FROM TB_SERVICOS_RECURSOS_FINANCEIROS_CRAS A 
				INNER JOIN TB_TRANSFERENCIA_RENDA_COFINANCIAMENTO C ON(C.ID_SERVICOS_RECURSOS_FINANCEIROS_CRAS = A.ID)			             
				WHERE C.ID_TRANSFERENCIA_RENDA = P.ID
		),0) 
		+
		COALESCE((SELECT SUM(A.VALOR_MUNICIPAL_ASSISTENCIA + A.VALOR_MUNICIPAL_FMDCA + A.VALOR_ESTADUAL_ASSISTENCIA + A.VALOR_ESTADUAL_FEDCA + A.VALOR_FEDERAL_ASSISTENCIA + A.VALOR_FEDERAL_FNDCA + COALESCE(A.VALOR_ESTADUALIZADO,0))
				FROM TB_SERVICOS_RECURSOS_FINANCEIROS_CENTRO_POP A 
				INNER JOIN TB_TRANSFERENCIA_RENDA_COFINANCIAMENTO C ON(C.ID_SERVICOS_RECURSOS_FINANCEIROS_CENTRO_POP = A.ID)			             
				WHERE C.ID_TRANSFERENCIA_RENDA = P.ID
		),0)
		) AS PREVISAO_ORCAMENTARIA,
		cast(0 as bit) PROGRAMA_MUNICIPAL,
		cast(0 as bit) PROGRAMA_ESTADUAL,
		cast(1 as bit) PROGRAMA_FEDERAL,
		isnull(P.BENEFICIARIO_ATENDIDO_REDE_SOCIOASSISTENCIAL, 0) BENEFICIARIO_ATENDIDO_REDE_SOCIOASSISTENCIAL,
		CASE WHEN isnull(P.PETI_NUMERO_BENEFICIARIOS, 0) > 0 OR isnull(P.PETI_PREVISAO_MENSAL, 0.0) > 0.0 THEN 1 ELSE 0 END ADERIU_BENEFICIO
	FROM TB_TRANSFERENCIA_RENDA P
	LEFT JOIN TB_TRANSFERENCIA_RENDA_COFINANCIAMENTO C ON(C.ID_TRANSFERENCIA_RENDA = P.ID)
	WHERE P.ID_TIPO_TRANSFERENCIA_RENDA = 4
	GROUP BY P.ID, P.NOME,P.ID_PREFEITURA, P.BENEFICIARIO_ATENDIDO_REDE_SOCIOASSISTENCIAL, P.PETI_PREVISAO_MENSAL,
	P.PETI_NUMERO_BENEFICIARIOS

GO



USE [DBPMAS2015]
GO

SET ANSI_NULLS ON
GO

SET QUOTED_IDENTIFIER ON
GO

CREATE TABLE [dbo].[TB_ORGAO_RESPONSAVEL](
	[ID] [int] IDENTITY(1,1) NOT NULL,
	[NOME] [nvarchar](max) NOT NULL,
 CONSTRAINT [PK_TB_ORGAO_RESPONSAVEL] PRIMARY KEY CLUSTERED 
(
	[ID] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY] TEXTIMAGE_ON [PRIMARY]

GO

insert [DBPMAS2015].[dbo].[TB_ORGAO_RESPONSAVEL] (NOME) values ('Órgão Gestor da Assistência Social')
insert [DBPMAS2015].[dbo].[TB_ORGAO_RESPONSAVEL] (NOME) values ('CRAS')
insert [DBPMAS2015].[dbo].[TB_ORGAO_RESPONSAVEL] (NOME) values ('Unidade Socioassistencial Privada')
insert [DBPMAS2015].[dbo].[TB_ORGAO_RESPONSAVEL] (NOME) values ('CREAS')
insert [DBPMAS2015].[dbo].[TB_ORGAO_RESPONSAVEL] (NOME) values ('Centro POP')
insert [DBPMAS2015].[dbo].[TB_ORGAO_RESPONSAVEL] (NOME) values ('Fundo Social de Solidariedade')



USE [DBPMAS2015]
GO

SET ANSI_NULLS ON
GO

SET QUOTED_IDENTIFIER ON
GO

CREATE TABLE [dbo].[TB_PREFEITURA_BENEFICIO_EVENTUALxORGAO_RESPONSAVEL](
	[ID_PREFEITURA_BENEFICIO_EVENTUAL] [int] NOT NULL,
	[ID_ORGAO_RESPONSAVEL] [int] NOT NULL,
 CONSTRAINT [PK_TB_PREFEITURA_BENEFICIO_EVENTUALxORGAO_RESPONSAVEL] PRIMARY KEY CLUSTERED 
(
	[ID_PREFEITURA_BENEFICIO_EVENTUAL] ASC,
	[ID_ORGAO_RESPONSAVEL] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY]

GO

ALTER TABLE [dbo].[TB_PREFEITURA_BENEFICIO_EVENTUALxORGAO_RESPONSAVEL]  WITH CHECK ADD  CONSTRAINT [FK_TB_PREFEITURA_BENEFICIO_EVENTUALxORGAO_RESPONSAVEL_TB_ORGAO_RESPONSAVEL] FOREIGN KEY([ID_ORGAO_RESPONSAVEL])
REFERENCES [dbo].[TB_ORGAO_RESPONSAVEL] ([ID])
GO

ALTER TABLE [dbo].[TB_PREFEITURA_BENEFICIO_EVENTUALxORGAO_RESPONSAVEL] CHECK CONSTRAINT [FK_TB_PREFEITURA_BENEFICIO_EVENTUALxORGAO_RESPONSAVEL_TB_ORGAO_RESPONSAVEL]
GO

ALTER TABLE [dbo].[TB_PREFEITURA_BENEFICIO_EVENTUALxORGAO_RESPONSAVEL]  WITH CHECK ADD  CONSTRAINT [FK_TB_PREFEITURA_BENEFICIO_EVENTUALxORGAO_RESPONSAVEL_TB_PREFEITURA_BENEFICIO_EVENTUAL] FOREIGN KEY([ID_PREFEITURA_BENEFICIO_EVENTUAL])
REFERENCES [dbo].[TB_PREFEITURA_BENEFICIO_EVENTUAL] ([ID])
ON DELETE CASCADE
GO

ALTER TABLE [dbo].[TB_PREFEITURA_BENEFICIO_EVENTUALxORGAO_RESPONSAVEL] CHECK CONSTRAINT [FK_TB_PREFEITURA_BENEFICIO_EVENTUALxORGAO_RESPONSAVEL_TB_PREFEITURA_BENEFICIO_EVENTUAL]
GO



ALTER TABLE [DBPMAS2015].[dbo].[TB_PREFEITURA_BENEFICIO_EVENTUAL] ADD ID_UNIDADE_EXECUTORA int NULL
GO

insert [DBPMAS2015].[dbo].[TB_USUARIO_TIPO_SERVICO] (NOME, ID_TIPO_SERVICO) values ('jovens de 18 a 29 anos', 136)
insert [DBPMAS2015].[dbo].[TB_USUARIO_TIPO_SERVICO] (NOME, ID_TIPO_SERVICO) values ('adultos de 30 a 59 anos', 136)
GO


USE [DBPMAS2015]
GO

SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO

ALTER PROCEDURE [dbo].[PR_COFINANCIAMENTO_ESTADUAL]
	@ID_TIPO_PROTECAO  INT, @ID_PREFEITURA INT
AS  
  SELECT * FROM (
  SELECT S.ID		
		,L.ID AS ID_UNIDADE
		,5 AS ID_TIPO_UNIDADE
		,'Centro Pop' AS TIPO_UNIDADE
		,L.NOME AS UNIDADE
		,S.ID_USUARIO_TIPO_SERVICO
		,U.NOME AS USUARIO
		,U.ID_TIPO_SERVICO
		,(T.NOME + (CASE WHEN DESCRICAO_NAO_TIPIFICADO IS NULL THEN '' ELSE (' - ' + DESCRICAO_NAO_TIPIFICADO)END))  AS TIPO_SERVICO
		,T.ID_TIPO_PROTECAO
		,P.NOME AS PROTECAO_SOCIAL
		,S.NUMERO_ATENDIDOS_MENSAL AS NUMERO_ATENDIDOS
		,A.ABREVIACAO AS ABRANGENCIA
		,S.SERVICO_ESTADUALIZADO
		,COALESCE((S.VALOR_ESTADUAL_ASSISTENCIA),0) AS PREVISAO_ORCAMENTARIA
		,5 AS ORDEM
	 
  FROM TB_SERVICOS_RECURSOS_FINANCEIROS_CENTRO_POP S
  INNER JOIN TB_UNIDADE_PUBLICA UP (NOLOCK) ON (UP.ID_PREFEITURA = @ID_PREFEITURA) --brunov
  INNER JOIN TB_CENTRO_POP L ON(L.ID = S.ID_CENTRO_POP AND L.ID_UNIDADE_PUBLICA = UP.ID) --brunov
  --INNER JOIN TB_CENTRO_POP L ON(L.ID = S.ID_CENTRO_POP AND L.ID_PREFEITURA = @ID_PREFEITURA) --original
  INNER JOIN TB_USUARIO_TIPO_SERVICO U ON (U.ID = S.ID_USUARIO_TIPO_SERVICO)
  INNER JOIN TB_TIPO_SERVICO T ON(T.ID = U.ID_TIPO_SERVICO AND T.ID_TIPO_PROTECAO = @ID_TIPO_PROTECAO )
  INNER JOIN TB_TIPO_PROTECAO P ON(P.ID = T.ID_TIPO_PROTECAO)
  INNER JOIN TB_ABRANGENCIA_SERVICO A ON(A.ID = S.ID_ABRANGENCIA_SERVICO)
  WHERE S.VALOR_ESTADUAL_ASSISTENCIA > 0

  UNION ALL

  SELECT S.ID		
		,L.ID AS ID_UNIDADE
		,4 AS ID_TIPO_UNIDADE
		,'CREAS' AS TIPO_UNIDADE
		,L.NOME AS UNIDADE
		,S.ID_USUARIO_TIPO_SERVICO
		,U.NOME AS USUARIO
		,U.ID_TIPO_SERVICO
		,(T.NOME + (CASE WHEN DESCRICAO_NAO_TIPIFICADO IS NULL THEN '' ELSE (' - ' + DESCRICAO_NAO_TIPIFICADO)END))  AS TIPO_SERVICO
		,T.ID_TIPO_PROTECAO
		,P.NOME AS PROTECAO_SOCIAL
		,S.NUMERO_ATENDIDOS_MENSAL AS NUMERO_ATENDIDOS
		,A.ABREVIACAO AS ABRANGENCIA
		,S.SERVICO_ESTADUALIZADO
		,COALESCE((S.VALOR_ESTADUAL_ASSISTENCIA),0) AS PREVISAO_ORCAMENTARIA
		,5 AS ORDEM
	 
  FROM TB_SERVICOS_RECURSOS_FINANCEIROS_CREAS S
  INNER JOIN TB_UNIDADE_PUBLICA UP (NOLOCK) ON (UP.ID_PREFEITURA = @ID_PREFEITURA) --brunov
  INNER JOIN TB_CREAS L ON(L.ID = S.ID_CREAS AND L.ID_UNIDADE_PUBLICA = UP.ID) --brunov
  --INNER JOIN TB_CREAS L ON(L.ID = S.ID_CREAS AND L.ID_PREFEITURA = @ID_PREFEITURA) --original
  INNER JOIN TB_USUARIO_TIPO_SERVICO U ON (U.ID = S.ID_USUARIO_TIPO_SERVICO)
  INNER JOIN TB_TIPO_SERVICO T ON(T.ID = U.ID_TIPO_SERVICO AND T.ID_TIPO_PROTECAO = @ID_TIPO_PROTECAO )
  INNER JOIN TB_TIPO_PROTECAO P ON(P.ID = T.ID_TIPO_PROTECAO)
  INNER JOIN TB_ABRANGENCIA_SERVICO A ON(A.ID = S.ID_ABRANGENCIA_SERVICO)
  WHERE S.VALOR_ESTADUAL_ASSISTENCIA > 0

  UNION ALL

  SELECT S.ID		
		,L.ID AS ID_UNIDADE
		,3 AS ID_TIPO_UNIDADE
		,'CRAS' AS TIPO_UNIDADE
		,L.NOME AS UNIDADE
		,S.ID_USUARIO_TIPO_SERVICO
		,U.NOME AS USUARIO
		,U.ID_TIPO_SERVICO
		,(T.NOME + (CASE WHEN DESCRICAO_NAO_TIPIFICADO IS NULL THEN '' ELSE (' - ' + DESCRICAO_NAO_TIPIFICADO)END))  AS TIPO_SERVICO
		,T.ID_TIPO_PROTECAO
		,P.NOME AS PROTECAO_SOCIAL
		,S.NUMERO_ATENDIDOS_MENSAL AS NUMERO_ATENDIDOS
		,A.ABREVIACAO AS ABRANGENCIA
		,S.SERVICO_ESTADUALIZADO
		,COALESCE((S.VALOR_ESTADUAL_ASSISTENCIA),0) AS PREVISAO_ORCAMENTARIA
		,5 AS ORDEM
	 
  FROM TB_SERVICOS_RECURSOS_FINANCEIROS_CRAS S
  INNER JOIN TB_UNIDADE_PUBLICA UP (NOLOCK) ON (UP.ID_PREFEITURA = @ID_PREFEITURA) --brunov
  INNER JOIN TB_CRAS L ON(L.ID = S.ID_CRAS AND L.ID_UNIDADE_PUBLICA = UP.ID) --brunov
  --INNER JOIN TB_CRAS L ON(L.ID = S.ID_CRAS AND L.ID_PREFEITURA = @ID_PREFEITURA) --original
  INNER JOIN TB_USUARIO_TIPO_SERVICO U ON (U.ID = S.ID_USUARIO_TIPO_SERVICO)
  INNER JOIN TB_TIPO_SERVICO T ON(T.ID = U.ID_TIPO_SERVICO AND T.ID_TIPO_PROTECAO = @ID_TIPO_PROTECAO )
  INNER JOIN TB_TIPO_PROTECAO P ON(P.ID = T.ID_TIPO_PROTECAO)
  INNER JOIN TB_ABRANGENCIA_SERVICO A ON(A.ID = S.ID_ABRANGENCIA_SERVICO)
  WHERE S.VALOR_ESTADUAL_ASSISTENCIA > 0

  UNION ALL

  SELECT S.ID		
		,L.ID AS ID_UNIDADE
		,1 AS ID_TIPO_UNIDADE
		,'Unidade Pública' AS TIPO_UNIDADE
		,(L.RAZAO_SOCIAL + (CASE WHEN L.RAZAO_SOCIAL <> E.NOME THEN ' - ' + E.NOME ELSE '' END)) AS UNIDADE
		,S.ID_USUARIO_TIPO_SERVICO
		,U.NOME AS USUARIO
		,U.ID_TIPO_SERVICO
		,(T.NOME + (CASE WHEN DESCRICAO_NAO_TIPIFICADO IS NULL THEN '' ELSE (' - ' + DESCRICAO_NAO_TIPIFICADO)END))  AS TIPO_SERVICO
		,T.ID_TIPO_PROTECAO
		,P.NOME AS PROTECAO_SOCIAL
		,S.NUMERO_ATENDIDOS_MENSAL AS NUMERO_ATENDIDOS
		,A.ABREVIACAO AS ABRANGENCIA
		,S.SERVICO_ESTADUALIZADO
		,COALESCE((S.VALOR_ESTADUAL_ASSISTENCIA),0) AS PREVISAO_ORCAMENTARIA
		,5 AS ORDEM
	 
  FROM TB_SERVICOS_RECURSOS_FINANCEIROS_PUBLICO S
  INNER JOIN TB_LOCAL_EXECUCAO_PUBLICO E ON(E.ID = S.ID_LOCAL_EXECUCAO_PUBLICO)
  INNER JOIN TB_UNIDADE_PUBLICA L ON(L.ID = E.ID_UNIDADE_PUBLICA AND L.ID_PREFEITURA = @ID_PREFEITURA)
  INNER JOIN TB_USUARIO_TIPO_SERVICO U ON (U.ID = S.ID_USUARIO_TIPO_SERVICO)
  INNER JOIN TB_TIPO_SERVICO T ON(T.ID = U.ID_TIPO_SERVICO AND T.ID_TIPO_PROTECAO = @ID_TIPO_PROTECAO )
  INNER JOIN TB_TIPO_PROTECAO P ON(P.ID = T.ID_TIPO_PROTECAO)
  INNER JOIN TB_ABRANGENCIA_SERVICO A ON(A.ID = S.ID_ABRANGENCIA_SERVICO)
  WHERE S.VALOR_ESTADUAL_ASSISTENCIA > 0

  UNION ALL

  SELECT S.ID		
		,L.ID AS ID_UNIDADE
		,2 AS ID_TIPO_UNIDADE
		,'Unidade Privada' AS TIPO_UNIDADE
		,(L.RAZAO_SOCIAL + (CASE WHEN L.RAZAO_SOCIAL <> E.NOME THEN ' - ' + E.NOME ELSE '' END)) AS UNIDADE
		,S.ID_USUARIO_TIPO_SERVICO
		,U.NOME AS USUARIO
		,U.ID_TIPO_SERVICO
		,(T.NOME + (CASE WHEN DESCRICAO_NAO_TIPIFICADO IS NULL THEN '' ELSE (' - ' + DESCRICAO_NAO_TIPIFICADO)END))  AS TIPO_SERVICO
		,T.ID_TIPO_PROTECAO
		,P.NOME AS PROTECAO_SOCIAL
		,S.NUMERO_ATENDIDOS_MENSAL AS NUMERO_ATENDIDOS
		,A.ABREVIACAO AS ABRANGENCIA
		,S.SERVICO_ESTADUALIZADO
		,COALESCE((S.VALOR_ESTADUAL_ASSISTENCIA),0) AS PREVISAO_ORCAMENTARIA
		,5 AS ORDEM
	 
  FROM TB_SERVICOS_RECURSOS_FINANCEIROS_PRIVADO S
  INNER JOIN TB_LOCAL_EXECUCAO_PRIVADO E ON(E.ID = S.ID_LOCAL_EXECUCAO_PRIVADO)
  INNER JOIN TB_UNIDADE_PRIVADA L ON(L.ID = E.ID_UNIDADE_PRIVADA AND L.ID_PREFEITURA = @ID_PREFEITURA)
  INNER JOIN TB_USUARIO_TIPO_SERVICO U ON (U.ID = S.ID_USUARIO_TIPO_SERVICO)
  INNER JOIN TB_TIPO_SERVICO T ON(T.ID = U.ID_TIPO_SERVICO AND T.ID_TIPO_PROTECAO = @ID_TIPO_PROTECAO )
  INNER JOIN TB_TIPO_PROTECAO P ON(P.ID = T.ID_TIPO_PROTECAO)
  INNER JOIN TB_ABRANGENCIA_SERVICO A ON(A.ID = S.ID_ABRANGENCIA_SERVICO)
  WHERE S.VALOR_ESTADUAL_ASSISTENCIA > 0

  UNION ALL

  SELECT 0 AS ID		
		,0 AS ID_UNIDADE
		,1 AS ID_TIPO_UNIDADE
		,'Programa São Paulo Solidário - Etapa de Busca Ativa' AS TIPO_UNIDADE
		,'Programa São Paulo Solidário - Etapa de Busca Ativa' AS UNIDADE
		,0 AS ID_USUARIO_TIPO_SERVICO
		,'' AS USUARIO
		,0 AS ID_TIPO_SERVICO
		,''  AS TIPO_SERVICO
		,CAST(1 AS SMALLINT) AS ID_TIPO_PROTECAO
		,'' AS PROTECAO_SOCIAL
		,0 AS NUMERO_ATENDIDOS
		,'' AS ABRANGENCIA
		,CAST(0 as BIT) AS SERVICO_ESTADUALIZADO
		,COALESCE((T.SP_SOLIDARIO_BUSCA_ATIVA_VALOR_FEAS),0) AS PREVISAO_ORCAMENTARIA
		,1 AS ORDEM
	 
  FROM TB_PROGRAMA_PROJETO T
  WHERE @ID_TIPO_PROTECAO = 1 AND T.ID_PREFEITURA = @ID_PREFEITURA AND T.PROGRAMA_ESTADUAL = 1 AND T.NOME like '%São Paulo Solidário%' AND T.ID_FASE_PROGRAMA_TRANSFERENCIA_RENDA_SP_SOLIDARIO >= 1
  AND T.SP_SOLIDARIO_BUSCA_ATIVA_ANO_TERMINO = 2014 AND (T.SP_SOLIDARIO_ANO_REPASSE_FEAS_BUSCA_ATIVA = 2014 OR (T.SP_SOLIDARIO_ANO_REPASSE_FEAS_BUSCA_ATIVA = 2013 AND T.SP_SOLIDARIO_VALOR_FEAS_RETIDO_FMAS_2014 = 1))
  AND T.SP_SOLIDARIO_BUSCA_ATIVA_VALOR_FEAS IS NOT NULL AND T.SP_SOLIDARIO_BUSCA_ATIVA_VALOR_FEAS > 0

  UNION ALL  

  SELECT 0 AS ID		
		,0 AS ID_UNIDADE
		,1 AS ID_TIPO_UNIDADE
		,'Programa São Paulo Solidário - Etapa de Além da Renda' AS TIPO_UNIDADE
		,'Programa São Paulo Solidário - Etapa de Além da Renda' AS UNIDADE
		,0 AS ID_USUARIO_TIPO_SERVICO
		,'' AS USUARIO
		,0 AS ID_TIPO_SERVICO
		,''  AS TIPO_SERVICO
		,CAST(1 AS SMALLINT) AS ID_TIPO_PROTECAO
		,'' AS PROTECAO_SOCIAL
		,0 AS NUMERO_ATENDIDOS
		,'' AS ABRANGENCIA
		,CAST(0 as BIT) AS SERVICO_ESTADUALIZADO
		,COALESCE((T.SP_SOLIDARIO_AGENDA_FAMILIA_VALOR_FEAS),0) AS PREVISAO_ORCAMENTARIA
		,2 AS ORDEM
	 
  FROM TB_PROGRAMA_PROJETO T
  WHERE @ID_TIPO_PROTECAO = 1 AND T.ID_PREFEITURA = @ID_PREFEITURA AND T.PROGRAMA_ESTADUAL = 1 AND T.NOME like '%São Paulo Solidário%' AND T.ID_FASE_PROGRAMA_TRANSFERENCIA_RENDA_SP_SOLIDARIO = 3
  AND (T.SP_SOLIDARIO_ANO_REPASSE_FEAS_AGENDA_FAMILIA = 2014 OR (T.SP_SOLIDARIO_ANO_REPASSE_FEAS_AGENDA_FAMILIA = 2013 AND T.SP_SOLIDARIO_VALOR_FEAS_RETIDO_FMAS_2014_AGENDA_FAMILIA = 1))
  AND T.SP_SOLIDARIO_AGENDA_FAMILIA_VALOR_FEAS IS NOT NULL AND T.SP_SOLIDARIO_AGENDA_FAMILIA_VALOR_FEAS > 0

  UNION ALL  

  SELECT 0 AS ID		
		,0 AS ID_UNIDADE
		,1 AS ID_TIPO_UNIDADE
		,'Implantação de CRAS conforme Resolução SEDS-004, de 25/03/2014' AS TIPO_UNIDADE
		,'Implantação de CRAS conforme Resolução SEDS-004, de 25/03/2014' AS UNIDADE
		,0 AS ID_USUARIO_TIPO_SERVICO
		,'' AS USUARIO
		,0 AS ID_TIPO_SERVICO
		,''  AS TIPO_SERVICO
		,CAST(1 AS SMALLINT) AS ID_TIPO_PROTECAO
		,'' AS PROTECAO_SOCIAL
		,0 AS NUMERO_ATENDIDOS
		,'' AS ABRANGENCIA
		,CAST(0 as BIT) AS SERVICO_ESTADUALIZADO
		,ISNULL(AP.VALOR_FEAS, 0.0) AS PREVISAO_ORCAMENTARIA
		,3 AS ORDEM
	 
  FROM TB_PREFEITURA_ACAO_PLANEJAMENTO AP
  WHERE AP.ID_PREFEITURA = @ID_PREFEITURA AND AP.ID_ACAO_PLANEJAMENTO = 26 AND ISNULL(AP.VALOR_FEAS, 0.0) > 0.0

  UNION ALL  

  SELECT 0 AS ID		
		,0 AS ID_UNIDADE
		,1 AS ID_TIPO_UNIDADE
		,'Benefício Eventual - Auxílio Natalidade' AS TIPO_UNIDADE
		,'Benefício Eventual - Auxílio Natalidade' AS UNIDADE
		,0 AS ID_USUARIO_TIPO_SERVICO
		,'' AS USUARIO
		,0 AS ID_TIPO_SERVICO
		,''  AS TIPO_SERVICO
		,CAST(1 AS SMALLINT) AS ID_TIPO_PROTECAO
		,'' AS PROTECAO_SOCIAL
		,0 AS NUMERO_ATENDIDOS
		,'' AS ABRANGENCIA
		,CAST(0 as BIT) AS SERVICO_ESTADUALIZADO
		,ISNULL((T.VALOR_FEAS),0.0) AS PREVISAO_ORCAMENTARIA
		,4 AS ORDEM
	 
  FROM TB_PREFEITURA_BENEFICIO_EVENTUAL T
  WHERE @ID_TIPO_PROTECAO = 1 AND T.ID_PREFEITURA = @ID_PREFEITURA AND T.ID_TIPO_BENEFICIO_EVENTUAL = 1 AND ISNULL((T.VALOR_FEAS),0.0) > 0

  UNION ALL  

  SELECT 0 AS ID		
		,0 AS ID_UNIDADE
		,1 AS ID_TIPO_UNIDADE
		,'Benefício Eventual - Auxílio Funeral' AS TIPO_UNIDADE
		,'Benefício Eventual - Auxílio Funeral' AS UNIDADE
		,0 AS ID_USUARIO_TIPO_SERVICO
		,'' AS USUARIO
		,0 AS ID_TIPO_SERVICO
		,''  AS TIPO_SERVICO
		,CAST(1 AS SMALLINT) AS ID_TIPO_PROTECAO
		,'' AS PROTECAO_SOCIAL
		,0 AS NUMERO_ATENDIDOS
		,'' AS ABRANGENCIA
		,CAST(0 as BIT) AS SERVICO_ESTADUALIZADO
		,ISNULL((T.VALOR_FEAS),0.0) AS PREVISAO_ORCAMENTARIA
		,4 AS ORDEM
	 
  FROM TB_PREFEITURA_BENEFICIO_EVENTUAL T
  WHERE @ID_TIPO_PROTECAO = 1 AND T.ID_PREFEITURA = @ID_PREFEITURA AND T.ID_TIPO_BENEFICIO_EVENTUAL = 2 AND ISNULL((T.VALOR_FEAS),0.0) > 0

  UNION ALL  

  SELECT 0 AS ID		
		,0 AS ID_UNIDADE
		,1 AS ID_TIPO_UNIDADE
		,'Benefício Eventual - Calamidades Públicas e Emergências' AS TIPO_UNIDADE
		,'Benefício Eventual - Calamidades Públicas e Emergências' AS UNIDADE
		,0 AS ID_USUARIO_TIPO_SERVICO
		,'' AS USUARIO
		,0 AS ID_TIPO_SERVICO
		,''  AS TIPO_SERVICO
		,CAST(1 AS SMALLINT) AS ID_TIPO_PROTECAO
		,'' AS PROTECAO_SOCIAL
		,0 AS NUMERO_ATENDIDOS
		,'' AS ABRANGENCIA
		,CAST(0 as BIT) AS SERVICO_ESTADUALIZADO
		,ISNULL((T.VALOR_FEAS),0.0) AS PREVISAO_ORCAMENTARIA
		,4 AS ORDEM
	 
  FROM TB_PREFEITURA_BENEFICIO_EVENTUAL T
  WHERE @ID_TIPO_PROTECAO = 1 AND T.ID_PREFEITURA = @ID_PREFEITURA AND T.ID_TIPO_BENEFICIO_EVENTUAL = 3 AND ISNULL((T.VALOR_FEAS),0.0) > 0

  UNION ALL  

  SELECT 0 AS ID		
		,0 AS ID_UNIDADE
		,1 AS ID_TIPO_UNIDADE
		,'Benefício Eventual - Vulnerabilidade Temporária' AS TIPO_UNIDADE
		,'Benefício Eventual - Vulnerabilidade Temporária' AS UNIDADE
		,0 AS ID_USUARIO_TIPO_SERVICO
		,'' AS USUARIO
		,0 AS ID_TIPO_SERVICO
		,''  AS TIPO_SERVICO
		,CAST(1 AS SMALLINT) AS ID_TIPO_PROTECAO
		,'' AS PROTECAO_SOCIAL
		,0 AS NUMERO_ATENDIDOS
		,'' AS ABRANGENCIA
		,CAST(0 as BIT) AS SERVICO_ESTADUALIZADO
		,ISNULL((T.VALOR_FEAS),0.0) AS PREVISAO_ORCAMENTARIA
		,4 AS ORDEM
	 
  FROM TB_PREFEITURA_BENEFICIO_EVENTUAL T
  WHERE @ID_TIPO_PROTECAO = 1 AND T.ID_PREFEITURA = @ID_PREFEITURA AND T.ID_TIPO_BENEFICIO_EVENTUAL = 4 AND ISNULL((T.VALOR_FEAS),0.0) > 0

  ) T
  ORDER BY T.ORDEM, T.TIPO_UNIDADE,T.UNIDADE,T.TIPO_SERVICO, T.USUARIO


ALTER TABLE [DBPMAS2015].[dbo].[TB_TRANSFERENCIA_RENDA] ADD
	PETI_COFINANCIAMENTO_FEDERAL_TRANSFERENCIA_RENDA money NULL,
	PETI_COFINANCIAMENTO_FEDERAL_ANUAL_ACOES_ESTRATEGICAS money NULL,
	PETI_DATA_ADESAO datetime NULL
GO


USE [DBPMAS2015]
GO

/****** Object:  View [dbo].[VW_TRANSFERENCIA_RENDA]    Script Date: 17/06/2014 09:49:58 ******/
SET ANSI_NULLS ON
GO

SET QUOTED_IDENTIFIER ON
GO




ALTER VIEW [dbo].[VW_TRANSFERENCIA_RENDA]
AS
SELECT	P.ID,
		P.ID_PREFEITURA,
		P.NOME,
		P.ID_TIPO_TRANSFERENCIA_RENDA,
		CASE
		WHEN P.ID_TIPO_TRANSFERENCIA_RENDA = 1 THEN CASE WHEN isnull(P.BPC_NUMERO_BENEFICIARIOS, 0) > 0 THEN 1 ELSE 0 END
		WHEN P.ID_TIPO_TRANSFERENCIA_RENDA = 2 THEN CASE WHEN isnull(P.BPC_NUMERO_BENEFICIARIOS, 0) > 0 THEN 1 ELSE 0 END
		WHEN P.ID_TIPO_TRANSFERENCIA_RENDA = 3 THEN CASE WHEN isnull(P.BOLSA_FAMILIA_ESTIMATIVA_FAMILIAS, 0) > 0 OR isnull(P.BOLSA_FAMILIA_NUMERO_FAMILIAS, 0) > 0 OR isnull(P.BOLSA_FAMILIA_REPASSE_MENSAL, 0.0) > 0.0 THEN 1 ELSE 0 END
		WHEN P.ID_TIPO_TRANSFERENCIA_RENDA = 4 THEN CASE WHEN isnull(P.PETI_NUMERO_BENEFICIARIOS, 0) > 0 OR isnull(P.PETI_PREVISAO_MENSAL, 0.0) > 0.0 THEN 1 ELSE 0 END
		WHEN P.ID_TIPO_TRANSFERENCIA_RENDA = 5 THEN CASE WHEN isnull(P.ACAO_RENDA_META, 0) > 0 THEN 1 ELSE 0 END
		WHEN P.ID_TIPO_TRANSFERENCIA_RENDA = 6 THEN CASE WHEN isnull(P.ACAO_RENDA_META, 0) > 0 THEN 1 ELSE 0 END
		ELSE CASE WHEN isnull(P.MUNICIPAIS_NUMERO_BENEFICIARIOS, 0.0) > 0.0 OR isnull(P.RENDA_MUNICIPAIS_REPASSE, 0) > 0 THEN 1 ELSE 0 END
		END ADERIU,
		((SELECT COUNT(U.ID) FROM TB_CRAS U
		WHERE U.ID IN(SELECT A.ID_CRAS FROM TB_SERVICOS_RECURSOS_FINANCEIROS_CRAS A 
				INNER JOIN TB_TRANSFERENCIA_RENDA_COFINANCIAMENTO C ON(C.ID_SERVICOS_RECURSOS_FINANCEIROS_CRAS = A.ID AND C.ID_TRANSFERENCIA_RENDA = P.ID)			             
				))
		+
		(SELECT COUNT(U.ID) FROM TB_CREAS U
		WHERE U.ID IN(SELECT A.ID_CREAS FROM TB_SERVICOS_RECURSOS_FINANCEIROS_CREAS A 
				INNER JOIN TB_TRANSFERENCIA_RENDA_COFINANCIAMENTO C ON(C.ID_SERVICOS_RECURSOS_FINANCEIROS_CREAS = A.ID AND C.ID_TRANSFERENCIA_RENDA = P.ID)			             
				))
		+
		(SELECT COUNT(U.ID) FROM TB_CENTRO_POP U
		WHERE U.ID IN(SELECT A.ID_CENTRO_POP FROM TB_SERVICOS_RECURSOS_FINANCEIROS_CENTRO_POP A 
				INNER JOIN TB_TRANSFERENCIA_RENDA_COFINANCIAMENTO C ON(C.ID_SERVICOS_RECURSOS_FINANCEIROS_CENTRO_POP = A.ID AND C.ID_TRANSFERENCIA_RENDA = P.ID)			             
				))
		+
		(SELECT COUNT(U.ID) FROM TB_LOCAL_EXECUCAO_PUBLICO U
		WHERE U.ID IN(SELECT A.ID_LOCAL_EXECUCAO_PUBLICO FROM TB_SERVICOS_RECURSOS_FINANCEIROS_PUBLICO A 
				INNER JOIN TB_TRANSFERENCIA_RENDA_COFINANCIAMENTO C ON(C.ID_SERVICOS_RECURSOS_FINANCEIROS_PUBLICO = A.ID AND C.ID_TRANSFERENCIA_RENDA = P.ID)			             
				))
		+
		(SELECT COUNT(U.ID) FROM TB_LOCAL_EXECUCAO_PRIVADO U
		WHERE U.ID IN(SELECT A.ID_LOCAL_EXECUCAO_PRIVADO FROM TB_SERVICOS_RECURSOS_FINANCEIROS_PRIVADO A 
				INNER JOIN TB_TRANSFERENCIA_RENDA_COFINANCIAMENTO C ON(C.ID_SERVICOS_RECURSOS_FINANCEIROS_PRIVADO = A.ID AND C.ID_TRANSFERENCIA_RENDA = P.ID)			             
				))
		)AS TOTAL_UNIDADES		
		,COUNT(C.ID) AS TOTAL_SERVICOS
		,COALESCE((COALESCE(CAST(724 * 12 * CAST(BPC_NUMERO_BENEFICIARIOS AS BIGINT) AS BIGINT),0)
		+ COALESCE((P.BOLSA_FAMILIA_REPASSE_MENSAL * 12 ),0)		
		+ COALESCE((P.PETI_PREVISAO_MENSAL * 12 ),0)
		+ COALESCE((P.ACAO_RENDA_META * 100 * 12),0)
		+ COALESCE((P.RENDA_MUNICIPAIS_REPASSE * 12),0)
		+ COALESCE((P.SP_SOLIDARIO_REPASSE_ANUAL),0)
		),0) AS PREVISAO_ANUAL_REPASSE
		,COALESCE(P.BENEFICIARIO_ATENDIDO_REDE_SOCIOASSISTENCIAL,0) AS INTEGRACAO_REDE
		,case
		when P.ID_TIPO_TRANSFERENCIA_RENDA = 1 then isnull(P.BPC_NUMERO_BENEFICIARIOS, 0)
		when P.ID_TIPO_TRANSFERENCIA_RENDA = 2 then isnull(P.BPC_NUMERO_BENEFICIARIOS, 0)
		else 0
		end NUMERO_BENEFICIARIOS
	FROM TB_TRANSFERENCIA_RENDA P
	LEFT JOIN TB_TRANSFERENCIA_RENDA_COFINANCIAMENTO C ON(C.ID_TRANSFERENCIA_RENDA = P.ID)	
	GROUP BY P.ID, P.ID_TIPO_TRANSFERENCIA_RENDA,P.NOME,P.ID_PREFEITURA,BPC_NUMERO_BENEFICIARIOS,
	BOLSA_FAMILIA_REPASSE_MENSAL,PETI_PREVISAO_MENSAL,ACAO_RENDA_META,
	RENDA_MUNICIPAIS_REPASSE,BOLSA_FAMILIA_ESTIMATIVA_FAMILIAS, BOLSA_FAMILIA_NUMERO_FAMILIAS, 
	PETI_NUMERO_BENEFICIARIOS, MUNICIPAIS_NUMERO_BENEFICIARIOS, BENEFICIARIO_ATENDIDO_REDE_SOCIOASSISTENCIAL, ID_FASE_PROGRAMA_TRANSFERENCIA_RENDA_SP_SOLIDARIO, SP_SOLIDARIO_REPASSE_ANUAL



GO


USE [DBPMAS2015]
GO
/****** Object:  StoredProcedure [dbo].[PR_TRANSFERENCIA_RENDA_ANUAL]    Script Date: 17/06/2014 09:52:26 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO

ALTER PROCEDURE [dbo].[PR_TRANSFERENCIA_RENDA_ANUAL]
	@ID_PREFEITURA INT, @ID_TIPO_TRANSFERENCIA_RENDA INT =	NULL
AS	
SELECT	A.ID
		,B.NOME
		,A.ID_TIPO_TRANSFERENCIA_RENDA AS TIPO_TRANSFERENCIA
		,ISNULL((CASE WHEN A.ID_TIPO_TRANSFERENCIA_RENDA = 8 THEN SUM(CAST(RENDA_MUNICIPAIS_REPASSE * 12 AS MONEY))		
		ELSE 0
		END),0) AS VALOR_ANUAL_MUNICIPAL
		,ISNULL((CASE WHEN A.ID_TIPO_TRANSFERENCIA_RENDA IN (5,6) THEN SUM(CAST(ACAO_RENDA_META * 100 * 12 AS MONEY))
		WHEN A.ID_TIPO_TRANSFERENCIA_RENDA = 9 THEN SUM(SP_SOLIDARIO_REPASSE_ANUAL)
		ELSE 0
		END),0) AS VALOR_ANUAL_ESTADUAL
		,ISNULL((CASE WHEN A.ID_TIPO_TRANSFERENCIA_RENDA IN (1,2) THEN SUM(CAST(BPC_NUMERO_BENEFICIARIOS AS MONEY) * 12 * 724)
		WHEN A.ID_TIPO_TRANSFERENCIA_RENDA = 3 THEN SUM(CAST((BOLSA_FAMILIA_REPASSE_MENSAL * 12) AS MONEY))
		WHEN A.ID_TIPO_TRANSFERENCIA_RENDA = 4 THEN SUM(CAST(PETI_PREVISAO_MENSAL AS MONEY) * 12)
		ELSE 0
		END),0) AS VALOR_ANUAL_FEDERAL
FROM TB_TRANSFERENCIA_RENDA A
INNER JOIN TB_TIPO_TRANSFERENCIA_RENDA B ON(B.ID = A.ID_TIPO_TRANSFERENCIA_RENDA)
WHERE ID_PREFEITURA = @ID_PREFEITURA AND (@ID_TIPO_TRANSFERENCIA_RENDA IS NULL OR A.ID_TIPO_TRANSFERENCIA_RENDA = @ID_TIPO_TRANSFERENCIA_RENDA)
GROUP BY A.ID,B.NOME, A.ID_TIPO_TRANSFERENCIA_RENDA


USE [DBPMAS2015]
GO

SET ANSI_NULLS ON
GO

SET QUOTED_IDENTIFIER ON
GO

CREATE TABLE [dbo].[TB_UNIDADE_PRIVADAxCARACTERIZACAO_ATIVIDADES](
	[ID_UNIDADE_PRIVADA] [int] NOT NULL,
	[ID_CARACTERIZACAO_ATIVIDADES] [int] NOT NULL,
 CONSTRAINT [PK_TB_UNIDADE_PRIVADAxCARACTERIZACAO_ATIVIDADES] PRIMARY KEY CLUSTERED 
(
	[ID_UNIDADE_PRIVADA] ASC,
	[ID_CARACTERIZACAO_ATIVIDADES] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY]

GO


ALTER TABLE [dbo].[TB_UNIDADE_PRIVADAxCARACTERIZACAO_ATIVIDADES]  WITH CHECK ADD  CONSTRAINT [FK_TB_UNIDADE_PRIVADAxCARACTERIZACAO_ATIVIDADES_TB_CARACTERIZACAO_ATIVIDADES] FOREIGN KEY([ID_CARACTERIZACAO_ATIVIDADES])
REFERENCES [dbo].[TB_CARACTERIZACAO_ATIVIDADES] ([ID])
GO

ALTER TABLE [dbo].[TB_UNIDADE_PRIVADAxCARACTERIZACAO_ATIVIDADES] CHECK CONSTRAINT [FK_TB_UNIDADE_PRIVADAxCARACTERIZACAO_ATIVIDADES_TB_CARACTERIZACAO_ATIVIDADES]
GO

ALTER TABLE [dbo].[TB_UNIDADE_PRIVADAxCARACTERIZACAO_ATIVIDADES]  WITH CHECK ADD  CONSTRAINT [FK_TB_UNIDADE_PRIVADAxCARACTERIZACAO_ATIVIDADES_TB_UNIDADE_PRIVADA] FOREIGN KEY([ID_UNIDADE_PRIVADA])
REFERENCES [dbo].[TB_UNIDADE_PRIVADA] ([ID])
ON DELETE CASCADE
GO

ALTER TABLE [dbo].[TB_UNIDADE_PRIVADAxCARACTERIZACAO_ATIVIDADES] CHECK CONSTRAINT [FK_TB_UNIDADE_PRIVADAxCARACTERIZACAO_ATIVIDADES_TB_UNIDADE_PRIVADA]
GO


update [DBPMAS2015].[dbo].[TB_TRANSFERENCIA_RENDA]
set objetivo = 'Retirar crianças e adolescentes abaixo de 16 anos de todas as formas de trabalho infantil, mantê-los na escola e promover a inserção social de suas famílias por meio de transferência direta de renda e serviços socioassistenciais.'
where id_tipo_transferencia_renda = 4


USE [DBPMAS2015]
GO

SET ANSI_NULLS ON
GO

SET QUOTED_IDENTIFIER ON
GO

CREATE TABLE [dbo].[TB_PETI_EIXO_ATUACAO](
	[ID] [int] IDENTITY(1,1) NOT NULL,
	[NOME] [nvarchar](max) NOT NULL,
 CONSTRAINT [PK_TB_PETI_EIXO_ATUACAO] PRIMARY KEY CLUSTERED 
(
	[ID] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY] TEXTIMAGE_ON [PRIMARY]

GO



USE [DBPMAS2015]
GO

SET ANSI_NULLS ON
GO

SET QUOTED_IDENTIFIER ON
GO

CREATE TABLE [dbo].[TB_PETI_TIPO_ACAO](
	[ID] [int] IDENTITY(1,1) NOT NULL,
	[NOME] [nvarchar](max) NOT NULL,
	[ID_PETI_EIXO_ATUACAO] [int] NOT NULL,
	[EXIBE] [bit] NOT NULL,
 CONSTRAINT [PK_TB_PETI_TIPO_ACAO] PRIMARY KEY CLUSTERED 
(
	[ID] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY] TEXTIMAGE_ON [PRIMARY]

GO

ALTER TABLE [dbo].[TB_PETI_TIPO_ACAO]  WITH CHECK ADD  CONSTRAINT [FK_TB_PETI_TIPO_ACAO_TB_PETI_EIXO_ATUACAO] FOREIGN KEY([ID_PETI_EIXO_ATUACAO])
REFERENCES [dbo].[TB_PETI_EIXO_ATUACAO] ([ID])
GO

ALTER TABLE [dbo].[TB_PETI_TIPO_ACAO] CHECK CONSTRAINT [FK_TB_PETI_TIPO_ACAO_TB_PETI_EIXO_ATUACAO]
GO


insert [DBPMAS2015].[dbo].[TB_PETI_EIXO_ATUACAO] (NOME) values ('Informação e mobilização nos territórios de incidência do trabalho infantil')
insert [DBPMAS2015].[dbo].[TB_PETI_EIXO_ATUACAO] (NOME) values ('Identificação de crianças e adolescentes em situação de trabalho infantil')
insert [DBPMAS2015].[dbo].[TB_PETI_EIXO_ATUACAO] (NOME) values ('Proteção social para crianças e adolescentes em situação de trabalho infantil e suas famílias')
insert [DBPMAS2015].[dbo].[TB_PETI_EIXO_ATUACAO] (NOME) values ('Apoio e acompanhamento das ações de defesa e responsabilização')
insert [DBPMAS2015].[dbo].[TB_PETI_EIXO_ATUACAO] (NOME) values ('Monitoramento das ações do PETI')

insert [DBPMAS2015].[dbo].[TB_PETI_TIPO_ACAO] (NOME, ID_PETI_EIXO_ATUACAO, EXIBE)
values ('Sensibilização dos atores e segmentos sociais', 1, 1)

insert [DBPMAS2015].[dbo].[TB_PETI_TIPO_ACAO] (NOME, ID_PETI_EIXO_ATUACAO, EXIBE)
values ('Mobilização social de instituições e/ou movimentos sociais', 1, 1)

insert [DBPMAS2015].[dbo].[TB_PETI_TIPO_ACAO] (NOME, ID_PETI_EIXO_ATUACAO, EXIBE)
values ('Realização de campanhas', 1, 1)

insert [DBPMAS2015].[dbo].[TB_PETI_TIPO_ACAO] (NOME, ID_PETI_EIXO_ATUACAO, EXIBE)
values ('Apoio e acompanhamento da realização de audiências públicas', 1, 1)

insert [DBPMAS2015].[dbo].[TB_PETI_TIPO_ACAO] (NOME, ID_PETI_EIXO_ATUACAO, EXIBE)
values ('Busca ativa e identificação de trabalho infantil', 2, 1)

insert [DBPMAS2015].[dbo].[TB_PETI_TIPO_ACAO] (NOME, ID_PETI_EIXO_ATUACAO, EXIBE)
values ('Registro no CadÚnico de crianças e adolescentes e suas famílias identificadas em situação de trabalho infantil', 2, 1)

insert [DBPMAS2015].[dbo].[TB_PETI_TIPO_ACAO] (NOME, ID_PETI_EIXO_ATUACAO, EXIBE)
values ('Transferência de renda', 3, 1)

insert [DBPMAS2015].[dbo].[TB_PETI_TIPO_ACAO] (NOME, ID_PETI_EIXO_ATUACAO, EXIBE)
values ('Inserção das crianças e adolescentes e suas famílias em serviços socioassistenciais', 3, 1)

insert [DBPMAS2015].[dbo].[TB_PETI_TIPO_ACAO] (NOME, ID_PETI_EIXO_ATUACAO, EXIBE)
values ('Encaminhamento das crianças e adolescentes e suas famílias para serviços de saúde, educação, cultura, esporte e lazer', 3, 1)

insert [DBPMAS2015].[dbo].[TB_PETI_TIPO_ACAO] (NOME, ID_PETI_EIXO_ATUACAO, EXIBE)
values ('Encaminhamento das famílias para ações de inclusão produtiva', 3, 1)

insert [DBPMAS2015].[dbo].[TB_PETI_TIPO_ACAO] (NOME, ID_PETI_EIXO_ATUACAO, EXIBE)
values ('Articulação com órgãos das políticas de Trabalho e Emprego para fomento das ações de fiscalização', 4, 1)

insert [DBPMAS2015].[dbo].[TB_PETI_TIPO_ACAO] (NOME, ID_PETI_EIXO_ATUACAO, EXIBE)
values ('Acompanhamento das famílias com aplicação de medidas protetivas', 4, 1)

insert [DBPMAS2015].[dbo].[TB_PETI_TIPO_ACAO] (NOME, ID_PETI_EIXO_ATUACAO, EXIBE)
values ('Articulação com o Poder Judiciário e Ministério Público', 4, 1)

insert [DBPMAS2015].[dbo].[TB_PETI_TIPO_ACAO] (NOME, ID_PETI_EIXO_ATUACAO, EXIBE)
values ('Articulação com os Conselhos Tutelares', 4, 1)

insert [DBPMAS2015].[dbo].[TB_PETI_TIPO_ACAO] (NOME, ID_PETI_EIXO_ATUACAO, EXIBE)
values ('Registro pertinente ao PETI', 5, 1)

insert [DBPMAS2015].[dbo].[TB_PETI_TIPO_ACAO] (NOME, ID_PETI_EIXO_ATUACAO, EXIBE)
values ('Monitoramento do processo de identificação e cadastramento das crianças, adolescentes em trabalho infantil e suas famílias', 5, 1)

insert [DBPMAS2015].[dbo].[TB_PETI_TIPO_ACAO] (NOME, ID_PETI_EIXO_ATUACAO, EXIBE)
values ('Monitoramento do atendimento das crianças e adolescentes e suas famílias nos serviços de assistência social', 5, 1)


ALTER VIEW [dbo].[VW_PROGRAMA_PROJETO]
AS
SELECT	P.ID,
		P.ID_PREFEITURA,
		P.NOME,
		CASE ((SELECT  COUNT(A.ID)  
				FROM TB_SERVICOS_RECURSOS_FINANCEIROS_PUBLICO A 
				INNER JOIN TB_PROGRAMA_PROJETO_COFINANCIAMENTO C ON(C.ID_SERVICOS_RECURSOS_FINANCEIROS_PUBLICO = A.ID)			             
				WHERE C.ID_PROGRAMA_PROJETO = P.ID AND A.VALOR_ESTADUAL_ASSISTENCIA > 0)
				+
				(SELECT  COUNT(A.ID)  
				FROM TB_SERVICOS_RECURSOS_FINANCEIROS_PRIVADO A 
				INNER JOIN TB_PROGRAMA_PROJETO_COFINANCIAMENTO C ON(C.ID_SERVICOS_RECURSOS_FINANCEIROS_PRIVADO = A.ID)			             
				WHERE C.ID_PROGRAMA_PROJETO = P.ID AND A.VALOR_ESTADUAL_ASSISTENCIA > 0)
				+
				(SELECT  COUNT(A.ID)  
				FROM TB_SERVICOS_RECURSOS_FINANCEIROS_CRAS A 
				INNER JOIN TB_PROGRAMA_PROJETO_COFINANCIAMENTO C ON(C.ID_SERVICOS_RECURSOS_FINANCEIROS_CRAS = A.ID)			             
				WHERE C.ID_PROGRAMA_PROJETO = P.ID AND A.VALOR_ESTADUAL_ASSISTENCIA > 0)
				+
				(SELECT  COUNT(A.ID)  
				FROM TB_SERVICOS_RECURSOS_FINANCEIROS_CREAS A 
				INNER JOIN TB_PROGRAMA_PROJETO_COFINANCIAMENTO C ON(C.ID_SERVICOS_RECURSOS_FINANCEIROS_CREAS = A.ID)			             
				WHERE C.ID_PROGRAMA_PROJETO = P.ID AND A.VALOR_ESTADUAL_ASSISTENCIA > 0)
				+
				(SELECT  COUNT(A.ID)  
				FROM TB_SERVICOS_RECURSOS_FINANCEIROS_CENTRO_POP A 
				INNER JOIN TB_PROGRAMA_PROJETO_COFINANCIAMENTO C ON(C.ID_SERVICOS_RECURSOS_FINANCEIROS_CENTRO_POP = A.ID)			             
				WHERE C.ID_PROGRAMA_PROJETO = P.ID AND A.VALOR_ESTADUAL_ASSISTENCIA > 0)
			)   
	WHEN 0   
	THEN 'Não'   
	ELSE 'Sim'   
	END 'COFINANCIAMENTO'		
	,CASE ((SELECT COUNT(A.ID)  
				FROM TB_SERVICOS_RECURSOS_FINANCEIROS_PUBLICO A 
				INNER JOIN TB_PROGRAMA_PROJETO_COFINANCIAMENTO C ON(C.ID_SERVICOS_RECURSOS_FINANCEIROS_PUBLICO = A.ID)			             
				WHERE C.ID_PROGRAMA_PROJETO = P.ID AND A.SERVICO_ESTADUALIZADO = 1)
				+
				(SELECT COUNT(A.ID)  
				FROM TB_SERVICOS_RECURSOS_FINANCEIROS_PRIVADO A 
				INNER JOIN TB_PROGRAMA_PROJETO_COFINANCIAMENTO C ON(C.ID_SERVICOS_RECURSOS_FINANCEIROS_PRIVADO = A.ID)			             
				WHERE C.ID_PROGRAMA_PROJETO = P.ID AND A.SERVICO_ESTADUALIZADO = 1)
				+
				(SELECT COUNT(A.ID)  
				FROM TB_SERVICOS_RECURSOS_FINANCEIROS_CRAS A 
				INNER JOIN TB_PROGRAMA_PROJETO_COFINANCIAMENTO C ON(C.ID_SERVICOS_RECURSOS_FINANCEIROS_CRAS = A.ID)			             
				WHERE C.ID_PROGRAMA_PROJETO = P.ID AND A.SERVICO_ESTADUALIZADO = 1)
				+
				(SELECT COUNT(A.ID)  
				FROM TB_SERVICOS_RECURSOS_FINANCEIROS_CREAS A 
				INNER JOIN TB_PROGRAMA_PROJETO_COFINANCIAMENTO C ON(C.ID_SERVICOS_RECURSOS_FINANCEIROS_CREAS = A.ID)			             
				WHERE C.ID_PROGRAMA_PROJETO = P.ID AND A.SERVICO_ESTADUALIZADO = 1)
				+
				(SELECT COUNT(A.ID)  
				FROM TB_SERVICOS_RECURSOS_FINANCEIROS_CENTRO_POP A 
				INNER JOIN TB_PROGRAMA_PROJETO_COFINANCIAMENTO C ON(C.ID_SERVICOS_RECURSOS_FINANCEIROS_CENTRO_POP = A.ID)			             
				WHERE C.ID_PROGRAMA_PROJETO = P.ID AND A.SERVICO_ESTADUALIZADO = 1)
			)
		WHEN 0
		THEN 'Não'
		ELSE 'Sim'   
		END 'ESTADUALIZADO'  
		,COUNT(C.ID) AS TOTAL_SERVICOS
		,(
		COALESCE((SELECT SUM(A.VALOR_MUNICIPAL_ASSISTENCIA + A.VALOR_MUNICIPAL_FMDCA + A.VALOR_ESTADUAL_ASSISTENCIA + A.VALOR_ESTADUAL_FEDCA + A.VALOR_FEDERAL_ASSISTENCIA + A.VALOR_FEDERAL_FNDCA + COALESCE(A.VALOR_ESTADUALIZADO,0))
				FROM TB_SERVICOS_RECURSOS_FINANCEIROS_PUBLICO A 
				INNER JOIN TB_PROGRAMA_PROJETO_COFINANCIAMENTO C ON(C.ID_SERVICOS_RECURSOS_FINANCEIROS_PUBLICO = A.ID)			             
				WHERE C.ID_PROGRAMA_PROJETO = P.ID
		),0) 
		+
		COALESCE((SELECT SUM(A.VALOR_MUNICIPAL_ASSISTENCIA + A.VALOR_MUNICIPAL_FMDCA + A.VALOR_ESTADUAL_ASSISTENCIA + A.VALOR_ESTADUAL_FEDCA + A.VALOR_FEDERAL_ASSISTENCIA + A.VALOR_FEDERAL_FNDCA + COALESCE(A.VALOR_ESTADUALIZADO,0) + A.VALOR_PRIVADO_EMPRESAS + A.VALOR_PRIVADO_PESSOAS_FISICAS + A.VALOR_PRIVADO_ORGANIZACOES + A.VALOR_PRIVADO_PROPRIOS)
				FROM TB_SERVICOS_RECURSOS_FINANCEIROS_PRIVADO A 
				INNER JOIN TB_PROGRAMA_PROJETO_COFINANCIAMENTO C ON(C.ID_SERVICOS_RECURSOS_FINANCEIROS_PRIVADO = A.ID)			             
				WHERE C.ID_PROGRAMA_PROJETO = P.ID
		),0) 
		+
		COALESCE((SELECT SUM(A.VALOR_MUNICIPAL_ASSISTENCIA + A.VALOR_MUNICIPAL_FMDCA + A.VALOR_ESTADUAL_ASSISTENCIA + A.VALOR_ESTADUAL_FEDCA + A.VALOR_FEDERAL_ASSISTENCIA + A.VALOR_FEDERAL_FNDCA + COALESCE(A.VALOR_ESTADUALIZADO,0))
				FROM TB_SERVICOS_RECURSOS_FINANCEIROS_CREAS A 
				INNER JOIN TB_PROGRAMA_PROJETO_COFINANCIAMENTO C ON(C.ID_SERVICOS_RECURSOS_FINANCEIROS_CREAS = A.ID)			             
				WHERE C.ID_PROGRAMA_PROJETO = P.ID
		),0) 
		+
		COALESCE((SELECT SUM(A.VALOR_MUNICIPAL_ASSISTENCIA + A.VALOR_MUNICIPAL_FMDCA + A.VALOR_ESTADUAL_ASSISTENCIA + A.VALOR_ESTADUAL_FEDCA + A.VALOR_FEDERAL_ASSISTENCIA + A.VALOR_FEDERAL_FNDCA + COALESCE(A.VALOR_ESTADUALIZADO,0))
				FROM TB_SERVICOS_RECURSOS_FINANCEIROS_CRAS A 
				INNER JOIN TB_PROGRAMA_PROJETO_COFINANCIAMENTO C ON(C.ID_SERVICOS_RECURSOS_FINANCEIROS_CRAS = A.ID)			             
				WHERE C.ID_PROGRAMA_PROJETO = P.ID
		),0) 
		+
		COALESCE((SELECT SUM(A.VALOR_MUNICIPAL_ASSISTENCIA + A.VALOR_MUNICIPAL_FMDCA + A.VALOR_ESTADUAL_ASSISTENCIA + A.VALOR_ESTADUAL_FEDCA + A.VALOR_FEDERAL_ASSISTENCIA + A.VALOR_FEDERAL_FNDCA + COALESCE(A.VALOR_ESTADUALIZADO,0))
				FROM TB_SERVICOS_RECURSOS_FINANCEIROS_CENTRO_POP A 
				INNER JOIN TB_PROGRAMA_PROJETO_COFINANCIAMENTO C ON(C.ID_SERVICOS_RECURSOS_FINANCEIROS_CENTRO_POP = A.ID)			             
				WHERE C.ID_PROGRAMA_PROJETO = P.ID
		),0)
		) AS PREVISAO_ORCAMENTARIA,
		isnull(P.PROGRAMA_MUNICIPAL, 0) PROGRAMA_MUNICIPAL,
		isnull(P.PROGRAMA_ESTADUAL, 0) PROGRAMA_ESTADUAL,
		isnull(P.PROGRAMA_FEDERAL, 0) PROGRAMA_FEDERAL,
		isnull(P.BENEFICIARIO_ATENDIDO_REDE_SOCIOASSISTENCIAL, 0) BENEFICIARIO_ATENDIDO_REDE_SOCIOASSISTENCIAL,
		case
		when P.NOME like '%acessuas%' and isnull(P.VALOR_PREVISAO_ANUAL_ACESSUAS, 0.0) > 0.0 then 1
		when P.NOME like '%solidário%' and (isnull(P.SP_SOLIDARIO_BUSCA_ATIVA_MES_INICIO, 0) > 0 or isnull(P.SP_SOLIDARIO_BUSCA_ATIVA_MES_TERMINO, 0) > 0 or isnull(P.SP_SOLIDARIO_BUSCA_ATIVA_ANO_INICIO, 0) > 0 or isnull(P.SP_SOLIDARIO_BUSCA_ATIVA_ANO_TERMINO, 0) > 0) then 1
		when P.NOME like '%amigo do idoso%' and (isnull(P.META_PACTUADA, 0.0) > 0.0 or isnull(P.VALOR_DIA_IDOSO, 0.0) > 0.0 or isnull(P.VALOR_CONVIVENCIA_IDOSO, 0.0) > 0.0) then 1
		else 0
		end ADERIU_BENEFICIO
	FROM TB_PROGRAMA_PROJETO P
	LEFT JOIN TB_PROGRAMA_PROJETO_COFINANCIAMENTO C ON(C.ID_PROGRAMA_PROJETO = P.ID)	
	GROUP BY P.ID, P.NOME,P.ID_PREFEITURA, P.PROGRAMA_MUNICIPAL, P.PROGRAMA_ESTADUAL, P.PROGRAMA_FEDERAL, P.BENEFICIARIO_ATENDIDO_REDE_SOCIOASSISTENCIAL,
	P.VALOR_PREVISAO_ANUAL_ACESSUAS, P.SP_SOLIDARIO_BUSCA_ATIVA_VALOR_FEAS, P.META_PACTUADA, P.VALOR_DIA_IDOSO, P.VALOR_CONVIVENCIA_IDOSO,
	P.SP_SOLIDARIO_BUSCA_ATIVA_MES_INICIO, P.SP_SOLIDARIO_BUSCA_ATIVA_MES_TERMINO, P.SP_SOLIDARIO_BUSCA_ATIVA_ANO_INICIO, P.SP_SOLIDARIO_BUSCA_ATIVA_ANO_TERMINO

GO


USE [DBPMAS2015]
GO

SET ANSI_NULLS ON
GO

SET QUOTED_IDENTIFIER ON
GO

CREATE TABLE [dbo].[TB_PETI_SITUACAO_ACAO](
	[ID] [int] IDENTITY(1,1) NOT NULL,
	[NOME] [nvarchar](max) NOT NULL,
 CONSTRAINT [PK_TB_PETI_SITUACAO_ACAO] PRIMARY KEY CLUSTERED 
(
	[ID] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY] TEXTIMAGE_ON [PRIMARY]

GO

insert [DBPMAS2015].[dbo].[TB_PETI_SITUACAO_ACAO] (nome)
values ('Planejada')
insert [DBPMAS2015].[dbo].[TB_PETI_SITUACAO_ACAO] (nome)
values ('Em andamento')
insert [DBPMAS2015].[dbo].[TB_PETI_SITUACAO_ACAO] (nome)
values ('Realizada')


USE [DBPMAS2015]
GO

SET ANSI_NULLS ON
GO

SET QUOTED_IDENTIFIER ON
GO

CREATE TABLE [dbo].[TB_PETI_ACAO](
	[ID] [int] IDENTITY(1,1) NOT NULL,
	[ID_TRANSFERENCIA_RENDA] [int] NOT NULL,
	[ID_PETI_EIXO_ATUACAO] [int] NOT NULL,
	[ID_PETI_TIPO_ACAO] [int] NOT NULL,
	[PERIODO_REALIZACAO] [nvarchar](max) NOT NULL,
	[ID_PETI_SITUACAO_ACAO] [int] NOT NULL,
 CONSTRAINT [PK_TB_PETI_ACAO] PRIMARY KEY CLUSTERED 
(
	[ID] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY] TEXTIMAGE_ON [PRIMARY]

GO

ALTER TABLE [dbo].[TB_PETI_ACAO]  WITH CHECK ADD  CONSTRAINT [FK_TB_PETI_ACAO_TB_PETI_EIXO_ATUACAO] FOREIGN KEY([ID_PETI_EIXO_ATUACAO])
REFERENCES [dbo].[TB_PETI_EIXO_ATUACAO] ([ID])
GO

ALTER TABLE [dbo].[TB_PETI_ACAO] CHECK CONSTRAINT [FK_TB_PETI_ACAO_TB_PETI_EIXO_ATUACAO]
GO

ALTER TABLE [dbo].[TB_PETI_ACAO]  WITH CHECK ADD  CONSTRAINT [FK_TB_PETI_ACAO_TB_PETI_SITUACAO_ACAO] FOREIGN KEY([ID_PETI_SITUACAO_ACAO])
REFERENCES [dbo].[TB_PETI_SITUACAO_ACAO] ([ID])
GO

ALTER TABLE [dbo].[TB_PETI_ACAO] CHECK CONSTRAINT [FK_TB_PETI_ACAO_TB_PETI_SITUACAO_ACAO]
GO

ALTER TABLE [dbo].[TB_PETI_ACAO]  WITH CHECK ADD  CONSTRAINT [FK_TB_PETI_ACAO_TB_PETI_TIPO_ACAO] FOREIGN KEY([ID_PETI_TIPO_ACAO])
REFERENCES [dbo].[TB_PETI_TIPO_ACAO] ([ID])
GO

ALTER TABLE [dbo].[TB_PETI_ACAO] CHECK CONSTRAINT [FK_TB_PETI_ACAO_TB_PETI_TIPO_ACAO]
GO

ALTER TABLE [dbo].[TB_PETI_ACAO]  WITH CHECK ADD  CONSTRAINT [FK_TB_PETI_ACAO_TB_TRANSFERENCIA_RENDA] FOREIGN KEY([ID_TRANSFERENCIA_RENDA])
REFERENCES [dbo].[TB_TRANSFERENCIA_RENDA] ([ID])
GO

ALTER TABLE [dbo].[TB_PETI_ACAO] CHECK CONSTRAINT [FK_TB_PETI_ACAO_TB_TRANSFERENCIA_RENDA]
GO

BEGIN TRANSACTION
SET QUOTED_IDENTIFIER ON
SET ARITHABORT ON
SET NUMERIC_ROUNDABORT OFF
SET CONCAT_NULL_YIELDS_NULL ON
SET ANSI_NULLS ON
SET ANSI_PADDING ON
SET ANSI_WARNINGS ON
COMMIT
BEGIN TRANSACTION
GO
ALTER TABLE dbo.TB_TRANSFERENCIA_RENDA ADD
	PETI_NUMERO_TRABALHO_INFANTIL_CAD_UNICO int NULL,
	PETI_BENEFICIARIO_TRANSFERENCIA_RENDA bit NULL,
	PETI_BENEFICIARIO_BOLSA_FAMILIA bit NULL,
	PETI_NUMERO_BENEFICIARIO_BOLSA_FAMILIA int NULL,
	PETI_BENEFICIARIO_PETI_PURO bit NULL,
	PETI_NUMERO_BENEFICIARIO_PETI_PURO_URBANO int NULL,
	PETI_NUMERO_BENEFICIARIO_PETI_PURO_RURAL int NULL,
	PETI_BENEFICIARIO_PROGRAMA_MUNICIPAL bit NULL,
	PETI_NUMERO_BENEFICIARIO_PROGRAMA_MUNICIPAL int NULL,
	PETI_ADERIU_COFINANCIAMENTO_FEDERAL bit NULL,
	PETI_ACOES_TRABALHO_INFANTIL bit NULL,
	VALOR_FMAS money NULL,
	VALOR_ORCAMENTO_MUNICIPAL money NULL,
	VALOR_FUNDO_MUNICIPAL money NULL,
	VALOR_FEAS money NULL,
	VALOR_ORCAMENTO_ESTADUAL money NULL,
	VALOR_FUNDO_ESTADUAL money NULL,
	VALOR_FNAS money NULL,
	VALOR_ORCAMENTO_FEDERAL money NULL,
	VALOR_FUNDO_FEDERAL money NULL,
	VALOR_IGD_PBF money NULL,
	VALOR_IGD_SUAS money NULL
GO
COMMIT


USE [DBPMAS2015]
GO

SET ANSI_NULLS ON
GO

SET QUOTED_IDENTIFIER ON
GO

CREATE TABLE [dbo].[TB_PETI_INDICADORES](
	[ID] [int] IDENTITY(1,1) NOT NULL,
	[ID_MUNICIPIO] [int] NOT NULL,
	[NUM_CRIANCAS_ADOLESCENTES_TRABALHO_INFANTIL_CENSO_2010] [int] NOT NULL,
	[PCT_CRIANCAS_ADOLESCENTES_TRABALHO_INFANTIL_CENSO_2010] [decimal](5, 2) NOT NULL,
 CONSTRAINT [PK_TB_PETI_INDICADORES] PRIMARY KEY CLUSTERED 
(
	[ID] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY]

GO


USE [DBPMAS2015]
GO

SET ANSI_NULLS ON
GO

SET QUOTED_IDENTIFIER ON
GO

ALTER VIEW [dbo].[VW_TRANSFERENCIA_RENDA]
AS
SELECT	P.ID,
		P.ID_PREFEITURA,
		P.NOME,
		P.ID_TIPO_TRANSFERENCIA_RENDA,
		CASE
		WHEN P.ID_TIPO_TRANSFERENCIA_RENDA = 1 THEN CASE WHEN isnull(P.BPC_NUMERO_BENEFICIARIOS, 0) > 0 THEN 1 ELSE 0 END
		WHEN P.ID_TIPO_TRANSFERENCIA_RENDA = 2 THEN CASE WHEN isnull(P.BPC_NUMERO_BENEFICIARIOS, 0) > 0 THEN 1 ELSE 0 END
		WHEN P.ID_TIPO_TRANSFERENCIA_RENDA = 3 THEN CASE WHEN isnull(P.BOLSA_FAMILIA_ESTIMATIVA_FAMILIAS, 0) > 0 OR isnull(P.BOLSA_FAMILIA_NUMERO_FAMILIAS, 0) > 0 OR isnull(P.BOLSA_FAMILIA_REPASSE_MENSAL, 0.0) > 0.0 THEN 1 ELSE 0 END
		WHEN P.ID_TIPO_TRANSFERENCIA_RENDA = 4 THEN CASE
		WHEN isnull(P.PETI_BENEFICIARIO_TRANSFERENCIA_RENDA, 0) = 1 and ((isnull(P.PETI_NUMERO_BENEFICIARIO_BOLSA_FAMILIA, 0) + isnull(P.PETI_NUMERO_BENEFICIARIO_PETI_PURO_URBANO, 0) + isnull(P.PETI_NUMERO_BENEFICIARIO_PETI_PURO_RURAL, 0) + isnull(P.PETI_NUMERO_BENEFICIARIO_PROGRAMA_MUNICIPAL, 0)) > 0) THEN 1
		ELSE 0 END
		WHEN P.ID_TIPO_TRANSFERENCIA_RENDA = 5 THEN CASE WHEN isnull(P.ACAO_RENDA_META, 0) > 0 THEN 1 ELSE 0 END
		WHEN P.ID_TIPO_TRANSFERENCIA_RENDA = 6 THEN CASE WHEN isnull(P.ACAO_RENDA_META, 0) > 0 THEN 1 ELSE 0 END
		ELSE CASE WHEN isnull(P.MUNICIPAIS_NUMERO_BENEFICIARIOS, 0.0) > 0.0 OR isnull(P.RENDA_MUNICIPAIS_REPASSE, 0) > 0 THEN 1 ELSE 0 END
		END ADERIU,
		((SELECT COUNT(U.ID) FROM TB_CRAS U
		WHERE U.ID IN(SELECT A.ID_CRAS FROM TB_SERVICOS_RECURSOS_FINANCEIROS_CRAS A 
				INNER JOIN TB_TRANSFERENCIA_RENDA_COFINANCIAMENTO C ON(C.ID_SERVICOS_RECURSOS_FINANCEIROS_CRAS = A.ID AND C.ID_TRANSFERENCIA_RENDA = P.ID)			             
				))
		+
		(SELECT COUNT(U.ID) FROM TB_CREAS U
		WHERE U.ID IN(SELECT A.ID_CREAS FROM TB_SERVICOS_RECURSOS_FINANCEIROS_CREAS A 
				INNER JOIN TB_TRANSFERENCIA_RENDA_COFINANCIAMENTO C ON(C.ID_SERVICOS_RECURSOS_FINANCEIROS_CREAS = A.ID AND C.ID_TRANSFERENCIA_RENDA = P.ID)			             
				))
		+
		(SELECT COUNT(U.ID) FROM TB_CENTRO_POP U
		WHERE U.ID IN(SELECT A.ID_CENTRO_POP FROM TB_SERVICOS_RECURSOS_FINANCEIROS_CENTRO_POP A 
				INNER JOIN TB_TRANSFERENCIA_RENDA_COFINANCIAMENTO C ON(C.ID_SERVICOS_RECURSOS_FINANCEIROS_CENTRO_POP = A.ID AND C.ID_TRANSFERENCIA_RENDA = P.ID)			             
				))
		+
		(SELECT COUNT(U.ID) FROM TB_LOCAL_EXECUCAO_PUBLICO U
		WHERE U.ID IN(SELECT A.ID_LOCAL_EXECUCAO_PUBLICO FROM TB_SERVICOS_RECURSOS_FINANCEIROS_PUBLICO A 
				INNER JOIN TB_TRANSFERENCIA_RENDA_COFINANCIAMENTO C ON(C.ID_SERVICOS_RECURSOS_FINANCEIROS_PUBLICO = A.ID AND C.ID_TRANSFERENCIA_RENDA = P.ID)			             
				))
		+
		(SELECT COUNT(U.ID) FROM TB_LOCAL_EXECUCAO_PRIVADO U
		WHERE U.ID IN(SELECT A.ID_LOCAL_EXECUCAO_PRIVADO FROM TB_SERVICOS_RECURSOS_FINANCEIROS_PRIVADO A 
				INNER JOIN TB_TRANSFERENCIA_RENDA_COFINANCIAMENTO C ON(C.ID_SERVICOS_RECURSOS_FINANCEIROS_PRIVADO = A.ID AND C.ID_TRANSFERENCIA_RENDA = P.ID)			             
				))
		)AS TOTAL_UNIDADES		
		,COUNT(C.ID) AS TOTAL_SERVICOS
		,COALESCE((COALESCE(CAST(724 * 12 * CAST(BPC_NUMERO_BENEFICIARIOS AS BIGINT) AS BIGINT),0)
		+ COALESCE((P.BOLSA_FAMILIA_REPASSE_MENSAL * 12 ),0)		
		+ COALESCE((P.PETI_PREVISAO_MENSAL * 12 ),0)
		+ COALESCE((P.ACAO_RENDA_META * 100 * 12),0)
		+ COALESCE((P.RENDA_MUNICIPAIS_REPASSE * 12),0)
		+ COALESCE((P.SP_SOLIDARIO_REPASSE_ANUAL),0)
		),0) AS PREVISAO_ANUAL_REPASSE
		,COALESCE(P.BENEFICIARIO_ATENDIDO_REDE_SOCIOASSISTENCIAL,0) AS INTEGRACAO_REDE
		,case
		when P.ID_TIPO_TRANSFERENCIA_RENDA = 1 then isnull(P.BPC_NUMERO_BENEFICIARIOS, 0)
		when P.ID_TIPO_TRANSFERENCIA_RENDA = 2 then isnull(P.BPC_NUMERO_BENEFICIARIOS, 0)
		else 0
		end NUMERO_BENEFICIARIOS
	FROM TB_TRANSFERENCIA_RENDA P
	LEFT JOIN TB_TRANSFERENCIA_RENDA_COFINANCIAMENTO C ON(C.ID_TRANSFERENCIA_RENDA = P.ID)	
	GROUP BY P.ID, P.ID_TIPO_TRANSFERENCIA_RENDA,P.NOME,P.ID_PREFEITURA,BPC_NUMERO_BENEFICIARIOS,
	BOLSA_FAMILIA_REPASSE_MENSAL,PETI_PREVISAO_MENSAL,ACAO_RENDA_META,
	RENDA_MUNICIPAIS_REPASSE,BOLSA_FAMILIA_ESTIMATIVA_FAMILIAS, BOLSA_FAMILIA_NUMERO_FAMILIAS, 
	PETI_NUMERO_BENEFICIARIOS, MUNICIPAIS_NUMERO_BENEFICIARIOS, BENEFICIARIO_ATENDIDO_REDE_SOCIOASSISTENCIAL, ID_FASE_PROGRAMA_TRANSFERENCIA_RENDA_SP_SOLIDARIO, SP_SOLIDARIO_REPASSE_ANUAL,
	PETI_BENEFICIARIO_TRANSFERENCIA_RENDA, PETI_NUMERO_BENEFICIARIO_BOLSA_FAMILIA, PETI_NUMERO_BENEFICIARIO_PETI_PURO_URBANO, PETI_NUMERO_BENEFICIARIO_PETI_PURO_RURAL,
	PETI_NUMERO_BENEFICIARIO_PROGRAMA_MUNICIPAL

GO


USE [DBPMAS2015]
GO

SET ANSI_NULLS ON
GO

SET QUOTED_IDENTIFIER ON
GO

ALTER VIEW [dbo].[VW_TRANSFERENCIA_RENDA]
AS
SELECT	P.ID,
		P.ID_PREFEITURA,
		P.NOME,
		P.ID_TIPO_TRANSFERENCIA_RENDA,
		CASE
		WHEN P.ID_TIPO_TRANSFERENCIA_RENDA = 1 THEN CASE WHEN isnull(P.BPC_NUMERO_BENEFICIARIOS, 0) > 0 THEN 1 ELSE 0 END
		WHEN P.ID_TIPO_TRANSFERENCIA_RENDA = 2 THEN CASE WHEN isnull(P.BPC_NUMERO_BENEFICIARIOS, 0) > 0 THEN 1 ELSE 0 END
		WHEN P.ID_TIPO_TRANSFERENCIA_RENDA = 3 THEN CASE WHEN isnull(P.BOLSA_FAMILIA_ESTIMATIVA_FAMILIAS, 0) > 0 OR isnull(P.BOLSA_FAMILIA_NUMERO_FAMILIAS, 0) > 0 OR isnull(P.BOLSA_FAMILIA_REPASSE_MENSAL, 0.0) > 0.0 THEN 1 ELSE 0 END
		WHEN P.ID_TIPO_TRANSFERENCIA_RENDA = 4 THEN CASE
		WHEN isnull(P.PETI_BENEFICIARIO_TRANSFERENCIA_RENDA, 0) = 1 and ((isnull(P.PETI_NUMERO_BENEFICIARIO_BOLSA_FAMILIA, 0) + isnull(P.PETI_NUMERO_BENEFICIARIO_PETI_PURO_URBANO, 0) + isnull(P.PETI_NUMERO_BENEFICIARIO_PETI_PURO_RURAL, 0) + isnull(P.PETI_NUMERO_BENEFICIARIO_PROGRAMA_MUNICIPAL, 0)) > 0) THEN 1
		ELSE 0 END
		WHEN P.ID_TIPO_TRANSFERENCIA_RENDA = 5 THEN CASE WHEN isnull(P.ACAO_RENDA_META, 0) > 0 THEN 1 ELSE 0 END
		WHEN P.ID_TIPO_TRANSFERENCIA_RENDA = 6 THEN CASE WHEN isnull(P.ACAO_RENDA_META, 0) > 0 THEN 1 ELSE 0 END
		ELSE CASE WHEN isnull(P.MUNICIPAIS_NUMERO_BENEFICIARIOS, 0.0) > 0.0 OR isnull(P.RENDA_MUNICIPAIS_REPASSE, 0) > 0 THEN 1 ELSE 0 END
		END ADERIU,
		((SELECT COUNT(U.ID) FROM TB_CRAS U
		WHERE U.ID IN(SELECT A.ID_CRAS FROM TB_SERVICOS_RECURSOS_FINANCEIROS_CRAS A 
				INNER JOIN TB_TRANSFERENCIA_RENDA_COFINANCIAMENTO C ON(C.ID_SERVICOS_RECURSOS_FINANCEIROS_CRAS = A.ID AND C.ID_TRANSFERENCIA_RENDA = P.ID)			             
				))
		+
		(SELECT COUNT(U.ID) FROM TB_CREAS U
		WHERE U.ID IN(SELECT A.ID_CREAS FROM TB_SERVICOS_RECURSOS_FINANCEIROS_CREAS A 
				INNER JOIN TB_TRANSFERENCIA_RENDA_COFINANCIAMENTO C ON(C.ID_SERVICOS_RECURSOS_FINANCEIROS_CREAS = A.ID AND C.ID_TRANSFERENCIA_RENDA = P.ID)			             
				))
		+
		(SELECT COUNT(U.ID) FROM TB_CENTRO_POP U
		WHERE U.ID IN(SELECT A.ID_CENTRO_POP FROM TB_SERVICOS_RECURSOS_FINANCEIROS_CENTRO_POP A 
				INNER JOIN TB_TRANSFERENCIA_RENDA_COFINANCIAMENTO C ON(C.ID_SERVICOS_RECURSOS_FINANCEIROS_CENTRO_POP = A.ID AND C.ID_TRANSFERENCIA_RENDA = P.ID)			             
				))
		+
		(SELECT COUNT(U.ID) FROM TB_LOCAL_EXECUCAO_PUBLICO U
		WHERE U.ID IN(SELECT A.ID_LOCAL_EXECUCAO_PUBLICO FROM TB_SERVICOS_RECURSOS_FINANCEIROS_PUBLICO A 
				INNER JOIN TB_TRANSFERENCIA_RENDA_COFINANCIAMENTO C ON(C.ID_SERVICOS_RECURSOS_FINANCEIROS_PUBLICO = A.ID AND C.ID_TRANSFERENCIA_RENDA = P.ID)			             
				))
		+
		(SELECT COUNT(U.ID) FROM TB_LOCAL_EXECUCAO_PRIVADO U
		WHERE U.ID IN(SELECT A.ID_LOCAL_EXECUCAO_PRIVADO FROM TB_SERVICOS_RECURSOS_FINANCEIROS_PRIVADO A 
				INNER JOIN TB_TRANSFERENCIA_RENDA_COFINANCIAMENTO C ON(C.ID_SERVICOS_RECURSOS_FINANCEIROS_PRIVADO = A.ID AND C.ID_TRANSFERENCIA_RENDA = P.ID)			             
				))
		)AS TOTAL_UNIDADES		
		,COUNT(C.ID) AS TOTAL_SERVICOS
		,COALESCE((COALESCE(CAST(724 * 12 * CAST(BPC_NUMERO_BENEFICIARIOS AS BIGINT) AS BIGINT),0)
		+ COALESCE((P.BOLSA_FAMILIA_REPASSE_MENSAL * 12 ),0)		
		+ COALESCE((P.PETI_PREVISAO_MENSAL * 12 ),0)
		+ COALESCE((P.ACAO_RENDA_META * 80 * 12),0)
		+ COALESCE((P.RENDA_MUNICIPAIS_REPASSE * 12),0)
		+ COALESCE((P.SP_SOLIDARIO_REPASSE_ANUAL),0)
		),0) AS PREVISAO_ANUAL_REPASSE
		,COALESCE(P.BENEFICIARIO_ATENDIDO_REDE_SOCIOASSISTENCIAL,0) AS INTEGRACAO_REDE
		,case
		when P.ID_TIPO_TRANSFERENCIA_RENDA = 1 then isnull(P.BPC_NUMERO_BENEFICIARIOS, 0)
		when P.ID_TIPO_TRANSFERENCIA_RENDA = 2 then isnull(P.BPC_NUMERO_BENEFICIARIOS, 0)
		else 0
		end NUMERO_BENEFICIARIOS
	FROM TB_TRANSFERENCIA_RENDA P
	LEFT JOIN TB_TRANSFERENCIA_RENDA_COFINANCIAMENTO C ON(C.ID_TRANSFERENCIA_RENDA = P.ID)	
	GROUP BY P.ID, P.ID_TIPO_TRANSFERENCIA_RENDA,P.NOME,P.ID_PREFEITURA,BPC_NUMERO_BENEFICIARIOS,
	BOLSA_FAMILIA_REPASSE_MENSAL,PETI_PREVISAO_MENSAL,ACAO_RENDA_META,
	RENDA_MUNICIPAIS_REPASSE,BOLSA_FAMILIA_ESTIMATIVA_FAMILIAS, BOLSA_FAMILIA_NUMERO_FAMILIAS, 
	PETI_NUMERO_BENEFICIARIOS, MUNICIPAIS_NUMERO_BENEFICIARIOS, BENEFICIARIO_ATENDIDO_REDE_SOCIOASSISTENCIAL, ID_FASE_PROGRAMA_TRANSFERENCIA_RENDA_SP_SOLIDARIO, SP_SOLIDARIO_REPASSE_ANUAL,
	PETI_BENEFICIARIO_TRANSFERENCIA_RENDA, PETI_NUMERO_BENEFICIARIO_BOLSA_FAMILIA, PETI_NUMERO_BENEFICIARIO_PETI_PURO_URBANO, PETI_NUMERO_BENEFICIARIO_PETI_PURO_RURAL,
	PETI_NUMERO_BENEFICIARIO_PROGRAMA_MUNICIPAL

GO


USE [DBPMAS2015]
GO
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO

ALTER PROCEDURE [dbo].[PR_TRANSFERENCIA_RENDA_ANUAL]
	@ID_PREFEITURA INT, @ID_TIPO_TRANSFERENCIA_RENDA INT =	NULL
AS	
SELECT	A.ID
		,B.NOME
		,A.ID_TIPO_TRANSFERENCIA_RENDA AS TIPO_TRANSFERENCIA
		,ISNULL((CASE WHEN A.ID_TIPO_TRANSFERENCIA_RENDA = 8 THEN SUM(CAST(RENDA_MUNICIPAIS_REPASSE * 12 AS MONEY))
		WHEN A.ID_TIPO_TRANSFERENCIA_RENDA = 4 THEN SUM(cast((isnull(VALOR_FMAS, 0.0) + isnull(A.VALOR_ORCAMENTO_MUNICIPAL, 0.0) + isnull(A.VALOR_FUNDO_MUNICIPAL, 0.0)) AS MONEY))
		ELSE 0
		END),0) AS VALOR_ANUAL_MUNICIPAL
		,ISNULL((CASE WHEN A.ID_TIPO_TRANSFERENCIA_RENDA IN (5,6) THEN SUM(CAST(ACAO_RENDA_META * 100 * 12 AS MONEY))
		WHEN A.ID_TIPO_TRANSFERENCIA_RENDA = 9 THEN SUM(SP_SOLIDARIO_REPASSE_ANUAL)
		WHEN A.ID_TIPO_TRANSFERENCIA_RENDA = 4 THEN SUM(cast((isnull(A.VALOR_FEAS, 0.0) + isnull(A.VALOR_ORCAMENTO_ESTADUAL, 0.0) + isnull(A.VALOR_FUNDO_ESTADUAL, 0.0)) AS MONEY))
		ELSE 0
		END),0) AS VALOR_ANUAL_ESTADUAL
		,ISNULL((CASE WHEN A.ID_TIPO_TRANSFERENCIA_RENDA IN (1,2) THEN SUM(CAST(BPC_NUMERO_BENEFICIARIOS AS MONEY) * 12 * 724)
		WHEN A.ID_TIPO_TRANSFERENCIA_RENDA = 3 THEN SUM(CAST((BOLSA_FAMILIA_REPASSE_MENSAL * 12) AS MONEY))
		WHEN A.ID_TIPO_TRANSFERENCIA_RENDA = 4 THEN SUM(cast((isnull(A.VALOR_FNAS, 0.0) + isnull(A.VALOR_ORCAMENTO_FEDERAL, 0.0) + isnull(A.VALOR_FUNDO_FEDERAL, 0.0) + (isnull(A.PETI_NUMERO_BENEFICIARIO_PETI_PURO_URBANO, 0.0) * 40 * 12) + (isnull(A.PETI_NUMERO_BENEFICIARIO_PETI_PURO_RURAL, 0.0) * 70 * 12)) AS MONEY))
		ELSE 0
		END),0) AS VALOR_ANUAL_FEDERAL
FROM TB_TRANSFERENCIA_RENDA A
INNER JOIN TB_TIPO_TRANSFERENCIA_RENDA B ON(B.ID = A.ID_TIPO_TRANSFERENCIA_RENDA)
WHERE ID_PREFEITURA = @ID_PREFEITURA AND (@ID_TIPO_TRANSFERENCIA_RENDA IS NULL OR A.ID_TIPO_TRANSFERENCIA_RENDA = @ID_TIPO_TRANSFERENCIA_RENDA)
GROUP BY A.ID,B.NOME, A.ID_TIPO_TRANSFERENCIA_RENDA


USE [DBPMAS2015]
GO

SET ANSI_NULLS ON
GO

SET QUOTED_IDENTIFIER ON
GO

CREATE TABLE [dbo].[TB_DISTRITOS_SAO_PAULO](
	[ID] [int] IDENTITY(1,1) NOT NULL,
	[NOME] [nvarchar](max) NOT NULL,
 CONSTRAINT [PK_TB_DISTRITOS_SAO_PAULO] PRIMARY KEY CLUSTERED 
(
	[ID] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY] TEXTIMAGE_ON [PRIMARY]

GO

insert [DBPMAS2015].[dbo].[TB_DISTRITOS_SAO_PAULO] (NOME) values('Água Rasa')
insert [DBPMAS2015].[dbo].[TB_DISTRITOS_SAO_PAULO] (NOME) values('Alto de Pinheiros')
insert [DBPMAS2015].[dbo].[TB_DISTRITOS_SAO_PAULO] (NOME) values('Anhanguera')
insert [DBPMAS2015].[dbo].[TB_DISTRITOS_SAO_PAULO] (NOME) values('Aricanduva')
insert [DBPMAS2015].[dbo].[TB_DISTRITOS_SAO_PAULO] (NOME) values('Artur Alvim')
insert [DBPMAS2015].[dbo].[TB_DISTRITOS_SAO_PAULO] (NOME) values('Barra Funda')
insert [DBPMAS2015].[dbo].[TB_DISTRITOS_SAO_PAULO] (NOME) values('Bela Vista')
insert [DBPMAS2015].[dbo].[TB_DISTRITOS_SAO_PAULO] (NOME) values('Belém')
insert [DBPMAS2015].[dbo].[TB_DISTRITOS_SAO_PAULO] (NOME) values('Bom Retiro')
insert [DBPMAS2015].[dbo].[TB_DISTRITOS_SAO_PAULO] (NOME) values('Brás')
insert [DBPMAS2015].[dbo].[TB_DISTRITOS_SAO_PAULO] (NOME) values('Brasilândia')
insert [DBPMAS2015].[dbo].[TB_DISTRITOS_SAO_PAULO] (NOME) values('Butantã')
insert [DBPMAS2015].[dbo].[TB_DISTRITOS_SAO_PAULO] (NOME) values('Cachoeirinha')
insert [DBPMAS2015].[dbo].[TB_DISTRITOS_SAO_PAULO] (NOME) values('Cambuci')
insert [DBPMAS2015].[dbo].[TB_DISTRITOS_SAO_PAULO] (NOME) values('Campo Belo')
insert [DBPMAS2015].[dbo].[TB_DISTRITOS_SAO_PAULO] (NOME) values('Campo Grande')
insert [DBPMAS2015].[dbo].[TB_DISTRITOS_SAO_PAULO] (NOME) values('Campo Limpo')
insert [DBPMAS2015].[dbo].[TB_DISTRITOS_SAO_PAULO] (NOME) values('Cangaíba')
insert [DBPMAS2015].[dbo].[TB_DISTRITOS_SAO_PAULO] (NOME) values('Capão Redondo')
insert [DBPMAS2015].[dbo].[TB_DISTRITOS_SAO_PAULO] (NOME) values('Carrão')
insert [DBPMAS2015].[dbo].[TB_DISTRITOS_SAO_PAULO] (NOME) values('Casa Verde')
insert [DBPMAS2015].[dbo].[TB_DISTRITOS_SAO_PAULO] (NOME) values('Cidade Ademar')
insert [DBPMAS2015].[dbo].[TB_DISTRITOS_SAO_PAULO] (NOME) values('Cidade Dutra')
insert [DBPMAS2015].[dbo].[TB_DISTRITOS_SAO_PAULO] (NOME) values('Cidade Líder')
insert [DBPMAS2015].[dbo].[TB_DISTRITOS_SAO_PAULO] (NOME) values('Cidade Tiradentes')
insert [DBPMAS2015].[dbo].[TB_DISTRITOS_SAO_PAULO] (NOME) values('Consolação')
insert [DBPMAS2015].[dbo].[TB_DISTRITOS_SAO_PAULO] (NOME) values('Cursino')
insert [DBPMAS2015].[dbo].[TB_DISTRITOS_SAO_PAULO] (NOME) values('Ermelino Matarazzo')
insert [DBPMAS2015].[dbo].[TB_DISTRITOS_SAO_PAULO] (NOME) values('Freguesia do Ó')
insert [DBPMAS2015].[dbo].[TB_DISTRITOS_SAO_PAULO] (NOME) values('Grajaú')
insert [DBPMAS2015].[dbo].[TB_DISTRITOS_SAO_PAULO] (NOME) values('Guaianazes')
insert [DBPMAS2015].[dbo].[TB_DISTRITOS_SAO_PAULO] (NOME) values('Iguatemi')
insert [DBPMAS2015].[dbo].[TB_DISTRITOS_SAO_PAULO] (NOME) values('Ipiranga')
insert [DBPMAS2015].[dbo].[TB_DISTRITOS_SAO_PAULO] (NOME) values('Itaim Bibi')
insert [DBPMAS2015].[dbo].[TB_DISTRITOS_SAO_PAULO] (NOME) values('Itaim Paulista')
insert [DBPMAS2015].[dbo].[TB_DISTRITOS_SAO_PAULO] (NOME) values('Itaquera')
insert [DBPMAS2015].[dbo].[TB_DISTRITOS_SAO_PAULO] (NOME) values('Jabaquara')
insert [DBPMAS2015].[dbo].[TB_DISTRITOS_SAO_PAULO] (NOME) values('Jaçanã')
insert [DBPMAS2015].[dbo].[TB_DISTRITOS_SAO_PAULO] (NOME) values('Jaguara')
insert [DBPMAS2015].[dbo].[TB_DISTRITOS_SAO_PAULO] (NOME) values('Jaguaré')
insert [DBPMAS2015].[dbo].[TB_DISTRITOS_SAO_PAULO] (NOME) values('Jaraguá')
insert [DBPMAS2015].[dbo].[TB_DISTRITOS_SAO_PAULO] (NOME) values('Jardim Ângela')
insert [DBPMAS2015].[dbo].[TB_DISTRITOS_SAO_PAULO] (NOME) values('Jardim Helena')
insert [DBPMAS2015].[dbo].[TB_DISTRITOS_SAO_PAULO] (NOME) values('Jardim Paulista')
insert [DBPMAS2015].[dbo].[TB_DISTRITOS_SAO_PAULO] (NOME) values('Jardim São Luís')
insert [DBPMAS2015].[dbo].[TB_DISTRITOS_SAO_PAULO] (NOME) values('José Bonifácio')
insert [DBPMAS2015].[dbo].[TB_DISTRITOS_SAO_PAULO] (NOME) values('Lajeado')
insert [DBPMAS2015].[dbo].[TB_DISTRITOS_SAO_PAULO] (NOME) values('Lapa')
insert [DBPMAS2015].[dbo].[TB_DISTRITOS_SAO_PAULO] (NOME) values('Liberdade')
insert [DBPMAS2015].[dbo].[TB_DISTRITOS_SAO_PAULO] (NOME) values('Limão')
insert [DBPMAS2015].[dbo].[TB_DISTRITOS_SAO_PAULO] (NOME) values('Mandaqui')
insert [DBPMAS2015].[dbo].[TB_DISTRITOS_SAO_PAULO] (NOME) values('Marsilac')
insert [DBPMAS2015].[dbo].[TB_DISTRITOS_SAO_PAULO] (NOME) values('Moema')
insert [DBPMAS2015].[dbo].[TB_DISTRITOS_SAO_PAULO] (NOME) values('Mooca')
insert [DBPMAS2015].[dbo].[TB_DISTRITOS_SAO_PAULO] (NOME) values('Morumbi')
insert [DBPMAS2015].[dbo].[TB_DISTRITOS_SAO_PAULO] (NOME) values('Parelheiros')
insert [DBPMAS2015].[dbo].[TB_DISTRITOS_SAO_PAULO] (NOME) values('Pari')
insert [DBPMAS2015].[dbo].[TB_DISTRITOS_SAO_PAULO] (NOME) values('Parque do Carmo')
insert [DBPMAS2015].[dbo].[TB_DISTRITOS_SAO_PAULO] (NOME) values('Pedreira')
insert [DBPMAS2015].[dbo].[TB_DISTRITOS_SAO_PAULO] (NOME) values('Penha')
insert [DBPMAS2015].[dbo].[TB_DISTRITOS_SAO_PAULO] (NOME) values('Perdizes')
insert [DBPMAS2015].[dbo].[TB_DISTRITOS_SAO_PAULO] (NOME) values('Perus')
insert [DBPMAS2015].[dbo].[TB_DISTRITOS_SAO_PAULO] (NOME) values('Pinheiros')
insert [DBPMAS2015].[dbo].[TB_DISTRITOS_SAO_PAULO] (NOME) values('Pirituba')
insert [DBPMAS2015].[dbo].[TB_DISTRITOS_SAO_PAULO] (NOME) values('Ponte Rasa')
insert [DBPMAS2015].[dbo].[TB_DISTRITOS_SAO_PAULO] (NOME) values('Raposo Tavares')
insert [DBPMAS2015].[dbo].[TB_DISTRITOS_SAO_PAULO] (NOME) values('República')
insert [DBPMAS2015].[dbo].[TB_DISTRITOS_SAO_PAULO] (NOME) values('Rio Pequeno')
insert [DBPMAS2015].[dbo].[TB_DISTRITOS_SAO_PAULO] (NOME) values('Sacomã')
insert [DBPMAS2015].[dbo].[TB_DISTRITOS_SAO_PAULO] (NOME) values('Santa Cecília')
insert [DBPMAS2015].[dbo].[TB_DISTRITOS_SAO_PAULO] (NOME) values('Santana')
insert [DBPMAS2015].[dbo].[TB_DISTRITOS_SAO_PAULO] (NOME) values('Santo Amaro')
insert [DBPMAS2015].[dbo].[TB_DISTRITOS_SAO_PAULO] (NOME) values('São Domingos')
insert [DBPMAS2015].[dbo].[TB_DISTRITOS_SAO_PAULO] (NOME) values('São Lucas')
insert [DBPMAS2015].[dbo].[TB_DISTRITOS_SAO_PAULO] (NOME) values('São Mateus')
insert [DBPMAS2015].[dbo].[TB_DISTRITOS_SAO_PAULO] (NOME) values('São Miguel')
insert [DBPMAS2015].[dbo].[TB_DISTRITOS_SAO_PAULO] (NOME) values('São Rafael')
insert [DBPMAS2015].[dbo].[TB_DISTRITOS_SAO_PAULO] (NOME) values('Sapopemba')
insert [DBPMAS2015].[dbo].[TB_DISTRITOS_SAO_PAULO] (NOME) values('Saúde')
insert [DBPMAS2015].[dbo].[TB_DISTRITOS_SAO_PAULO] (NOME) values('Sé')
insert [DBPMAS2015].[dbo].[TB_DISTRITOS_SAO_PAULO] (NOME) values('Socorro')
insert [DBPMAS2015].[dbo].[TB_DISTRITOS_SAO_PAULO] (NOME) values('Tatuapé')
insert [DBPMAS2015].[dbo].[TB_DISTRITOS_SAO_PAULO] (NOME) values('Tremembé')
insert [DBPMAS2015].[dbo].[TB_DISTRITOS_SAO_PAULO] (NOME) values('Tucuruvi')
insert [DBPMAS2015].[dbo].[TB_DISTRITOS_SAO_PAULO] (NOME) values('Vila Andrade')
insert [DBPMAS2015].[dbo].[TB_DISTRITOS_SAO_PAULO] (NOME) values('Vila Curuçá')
insert [DBPMAS2015].[dbo].[TB_DISTRITOS_SAO_PAULO] (NOME) values('Vila Formosa')
insert [DBPMAS2015].[dbo].[TB_DISTRITOS_SAO_PAULO] (NOME) values('Vila Guilherme')
insert [DBPMAS2015].[dbo].[TB_DISTRITOS_SAO_PAULO] (NOME) values('Vila Jacuí')
insert [DBPMAS2015].[dbo].[TB_DISTRITOS_SAO_PAULO] (NOME) values('Vila Leopoldina')
insert [DBPMAS2015].[dbo].[TB_DISTRITOS_SAO_PAULO] (NOME) values('Vila Maria')
insert [DBPMAS2015].[dbo].[TB_DISTRITOS_SAO_PAULO] (NOME) values('Vila Mariana')
insert [DBPMAS2015].[dbo].[TB_DISTRITOS_SAO_PAULO] (NOME) values('Vila Matilde')
insert [DBPMAS2015].[dbo].[TB_DISTRITOS_SAO_PAULO] (NOME) values('Vila Medeiros')
insert [DBPMAS2015].[dbo].[TB_DISTRITOS_SAO_PAULO] (NOME) values('Vila Prudente')
insert [DBPMAS2015].[dbo].[TB_DISTRITOS_SAO_PAULO] (NOME) values('Vila Sônia')


ALTER TABLE dbo.TB_LOCAL_EXECUCAO_PUBLICO ADD
	ID_DISTRITOS_SAO_PAULO int NULL
GO
ALTER TABLE dbo.TB_LOCAL_EXECUCAO_PUBLICO ADD CONSTRAINT
	FK_TB_LOCAL_EXECUCAO_PUBLICO_TB_DISTRITOS_SAO_PAULO FOREIGN KEY
	(
	ID_DISTRITOS_SAO_PAULO
	) REFERENCES dbo.TB_DISTRITOS_SAO_PAULO
	(
	ID
	) ON UPDATE  NO ACTION 
	 ON DELETE  NO ACTION 
	
GO

ALTER TABLE dbo.TB_LOCAL_EXECUCAO_PRIVADO ADD
	ID_DISTRITOS_SAO_PAULO int NULL
GO
ALTER TABLE dbo.TB_LOCAL_EXECUCAO_PRIVADO ADD CONSTRAINT
	FK_TB_LOCAL_EXECUCAO_PRIVADO_TB_DISTRITOS_SAO_PAULO FOREIGN KEY
	(
	ID_DISTRITOS_SAO_PAULO
	) REFERENCES dbo.TB_DISTRITOS_SAO_PAULO
	(
	ID
	) ON UPDATE  NO ACTION 
	 ON DELETE  NO ACTION 
	
GO

ALTER TABLE dbo.TB_CRAS ADD
	ID_DISTRITOS_SAO_PAULO int NULL
GO
ALTER TABLE dbo.TB_CRAS ADD CONSTRAINT
	FK_TB_CRAS_TB_DISTRITOS_SAO_PAULO FOREIGN KEY
	(
	ID_DISTRITOS_SAO_PAULO
	) REFERENCES dbo.TB_DISTRITOS_SAO_PAULO
	(
	ID
	) ON UPDATE  NO ACTION 
	 ON DELETE  NO ACTION 
	
GO

ALTER TABLE dbo.TB_CREAS ADD
	ID_DISTRITOS_SAO_PAULO int NULL
GO
ALTER TABLE dbo.TB_CREAS ADD CONSTRAINT
	FK_TB_CREAS_TB_DISTRITOS_SAO_PAULO FOREIGN KEY
	(
	ID_DISTRITOS_SAO_PAULO
	) REFERENCES dbo.TB_DISTRITOS_SAO_PAULO
	(
	ID
	) ON UPDATE  NO ACTION 
	 ON DELETE  NO ACTION 
	
GO

ALTER TABLE dbo.TB_CENTRO_POP ADD
	ID_DISTRITOS_SAO_PAULO int NULL
GO
ALTER TABLE dbo.TB_CENTRO_POP ADD CONSTRAINT
	FK_TB_CENTRO_POP_TB_DISTRITOS_SAO_PAULO FOREIGN KEY
	(
	ID_DISTRITOS_SAO_PAULO
	) REFERENCES dbo.TB_DISTRITOS_SAO_PAULO
	(
	ID
	) ON UPDATE  NO ACTION 
	 ON DELETE  NO ACTION 
	
GO


alter table [DBPMAS2015].[dbo].[TB_TIPO_SERVICO] add NAO_TIPIFICADO bit null

insert [DBPMAS2015].[dbo].[TB_TIPO_SERVICO] (ID, NOME, ID_TIPO_PROTECAO, ORDEM, NAO_TIPIFICADO)
values (154, 'Serviço de atendimento a famílias realizado fora do CRAS', 1, 100, 1)

insert [DBPMAS2015].[dbo].[TB_TIPO_SERVICO] (ID, NOME, ID_TIPO_PROTECAO, ORDEM, NAO_TIPIFICADO)
values (155, 'Serviço exclusivo para as ações complementares dos programas estaduais de transferência de renda', 1, 101, 1)

insert [DBPMAS2015].[dbo].[TB_TIPO_SERVICO] (ID, NOME, ID_TIPO_PROTECAO, ORDEM, NAO_TIPIFICADO)
values (156, 'Outro', 1, 102, 1)

insert [DBPMAS2015].[dbo].[TB_TIPO_SERVICO] (ID, NOME, ID_TIPO_PROTECAO, ORDEM, NAO_TIPIFICADO)
values (157, 'Serviço de atendimento a famílias e indivíduos em situação de risco social realizado fora do CREAS', 2, 100, 1)

insert [DBPMAS2015].[dbo].[TB_TIPO_SERVICO] (ID, NOME, ID_TIPO_PROTECAO, ORDEM, NAO_TIPIFICADO)
values (158, 'Serviço de atendimento especializado complementar ao PAEFI ofertado fora do CREAS', 2, 101, 1)

insert [DBPMAS2015].[dbo].[TB_TIPO_SERVICO] (ID, NOME, ID_TIPO_PROTECAO, ORDEM, NAO_TIPIFICADO)
values (159, 'Outro', 2, 102, 1)



insert [DBPMAS2015].[dbo].[TB_USUARIO_TIPO_SERVICO] (NOME, ID_TIPO_SERVICO)
values ('famílias', 154)

insert [DBPMAS2015].[dbo].[TB_USUARIO_TIPO_SERVICO] (NOME, ID_TIPO_SERVICO)
values ('famílias', 155)
insert [DBPMAS2015].[dbo].[TB_USUARIO_TIPO_SERVICO] (NOME, ID_TIPO_SERVICO)
values ('jovens', 155)

insert [DBPMAS2015].[dbo].[TB_USUARIO_TIPO_SERVICO] (NOME, ID_TIPO_SERVICO)
values ('famílias', 156)
insert [DBPMAS2015].[dbo].[TB_USUARIO_TIPO_SERVICO] (NOME, ID_TIPO_SERVICO)
values ('crianças', 156)
insert [DBPMAS2015].[dbo].[TB_USUARIO_TIPO_SERVICO] (NOME, ID_TIPO_SERVICO)
values ('adolescentes', 156)
insert [DBPMAS2015].[dbo].[TB_USUARIO_TIPO_SERVICO] (NOME, ID_TIPO_SERVICO)
values ('crianças e adolescentes', 156)
insert [DBPMAS2015].[dbo].[TB_USUARIO_TIPO_SERVICO] (NOME, ID_TIPO_SERVICO)
values ('jovens', 156)
insert [DBPMAS2015].[dbo].[TB_USUARIO_TIPO_SERVICO] (NOME, ID_TIPO_SERVICO)
values ('adultos', 156)
insert [DBPMAS2015].[dbo].[TB_USUARIO_TIPO_SERVICO] (NOME, ID_TIPO_SERVICO)
values ('idosos', 156)
insert [DBPMAS2015].[dbo].[TB_USUARIO_TIPO_SERVICO] (NOME, ID_TIPO_SERVICO)
values ('pessoas com deficiência', 156)

insert [DBPMAS2015].[dbo].[TB_USUARIO_TIPO_SERVICO] (NOME, ID_TIPO_SERVICO)
values ('famílias e indivíduos', 157)

insert [DBPMAS2015].[dbo].[TB_USUARIO_TIPO_SERVICO] (NOME, ID_TIPO_SERVICO)
values ('famílias', 158)
insert [DBPMAS2015].[dbo].[TB_USUARIO_TIPO_SERVICO] (NOME, ID_TIPO_SERVICO)
values ('crianças', 158)
insert [DBPMAS2015].[dbo].[TB_USUARIO_TIPO_SERVICO] (NOME, ID_TIPO_SERVICO)
values ('adolescentes', 158)
insert [DBPMAS2015].[dbo].[TB_USUARIO_TIPO_SERVICO] (NOME, ID_TIPO_SERVICO)
values ('crianças e adolescentes', 158)
insert [DBPMAS2015].[dbo].[TB_USUARIO_TIPO_SERVICO] (NOME, ID_TIPO_SERVICO)
values ('jovens', 158)
insert [DBPMAS2015].[dbo].[TB_USUARIO_TIPO_SERVICO] (NOME, ID_TIPO_SERVICO)
values ('adultos', 158)
insert [DBPMAS2015].[dbo].[TB_USUARIO_TIPO_SERVICO] (NOME, ID_TIPO_SERVICO)
values ('idosos', 158)
insert [DBPMAS2015].[dbo].[TB_USUARIO_TIPO_SERVICO] (NOME, ID_TIPO_SERVICO)
values ('pessoas com deficiência', 158)

insert [DBPMAS2015].[dbo].[TB_USUARIO_TIPO_SERVICO] (NOME, ID_TIPO_SERVICO)
values ('famílias', 159)
insert [DBPMAS2015].[dbo].[TB_USUARIO_TIPO_SERVICO] (NOME, ID_TIPO_SERVICO)
values ('crianças', 159)
insert [DBPMAS2015].[dbo].[TB_USUARIO_TIPO_SERVICO] (NOME, ID_TIPO_SERVICO)
values ('adolescentes', 159)
insert [DBPMAS2015].[dbo].[TB_USUARIO_TIPO_SERVICO] (NOME, ID_TIPO_SERVICO)
values ('crianças e adolescentes', 159)
insert [DBPMAS2015].[dbo].[TB_USUARIO_TIPO_SERVICO] (NOME, ID_TIPO_SERVICO)
values ('jovens', 159)
insert [DBPMAS2015].[dbo].[TB_USUARIO_TIPO_SERVICO] (NOME, ID_TIPO_SERVICO)
values ('adultos', 159)
insert [DBPMAS2015].[dbo].[TB_USUARIO_TIPO_SERVICO] (NOME, ID_TIPO_SERVICO)
values ('idosos', 159)
insert [DBPMAS2015].[dbo].[TB_USUARIO_TIPO_SERVICO] (NOME, ID_TIPO_SERVICO)
values ('pessoas com deficiência', 159)


insert [DBPMAS2015].[dbo].[TB_SITUACAO_ESPECIFICA] (ID, ID_SITUACAO_VULNERABILIDADE, NOME) values (44, 17, 'Em situação de acolhimento')
insert [DBPMAS2015].[dbo].[TB_SITUACAO_ESPECIFICA] (ID, ID_SITUACAO_VULNERABILIDADE, NOME) values (45, 3, 'Egressos de medidas de proteção previstas no ECA')
insert [DBPMAS2015].[dbo].[TB_SITUACAO_ESPECIFICA] (ID, ID_SITUACAO_VULNERABILIDADE, NOME) values (46, 1, 'Pessoas com deficiência intelectual acima de 30 anos egressas dos convênios com a Secretaria de Educação')
insert [DBPMAS2015].[dbo].[TB_SITUACAO_ESPECIFICA] (ID, ID_SITUACAO_VULNERABILIDADE, NOME) values (47, 18, 'Beneficiários do Programa Ação Jovem')
insert [DBPMAS2015].[dbo].[TB_SITUACAO_ESPECIFICA] (ID, ID_SITUACAO_VULNERABILIDADE, NOME) values (48, 18, 'Beneficiários do Programa Renda Cidadã')



insert [DBPMAS2015].[dbo].[TB_USUARIO_TIPO_SERVICOxSITUACAO_ESPECIFICA] (ID_USUARIO_TIPO_SERVICO, ID_SITUACAO_ESPECIFICA)
values (11, 45)
insert [DBPMAS2015].[dbo].[TB_USUARIO_TIPO_SERVICOxSITUACAO_ESPECIFICA] (ID_USUARIO_TIPO_SERVICO, ID_SITUACAO_ESPECIFICA)
values (12, 45)
insert [DBPMAS2015].[dbo].[TB_USUARIO_TIPO_SERVICOxSITUACAO_ESPECIFICA] (ID_USUARIO_TIPO_SERVICO, ID_SITUACAO_ESPECIFICA)
values (13, 45)
insert [DBPMAS2015].[dbo].[TB_USUARIO_TIPO_SERVICOxSITUACAO_ESPECIFICA] (ID_USUARIO_TIPO_SERVICO, ID_SITUACAO_ESPECIFICA)
values (14, 45)
insert [DBPMAS2015].[dbo].[TB_USUARIO_TIPO_SERVICOxSITUACAO_ESPECIFICA] (ID_USUARIO_TIPO_SERVICO, ID_SITUACAO_ESPECIFICA)
values (15, 45)
insert [DBPMAS2015].[dbo].[TB_USUARIO_TIPO_SERVICOxSITUACAO_ESPECIFICA] (ID_USUARIO_TIPO_SERVICO, ID_SITUACAO_ESPECIFICA)
values (16, 45)
insert [DBPMAS2015].[dbo].[TB_USUARIO_TIPO_SERVICOxSITUACAO_ESPECIFICA] (ID_USUARIO_TIPO_SERVICO, ID_SITUACAO_ESPECIFICA)
values (17, 45)
insert [DBPMAS2015].[dbo].[TB_USUARIO_TIPO_SERVICOxSITUACAO_ESPECIFICA] (ID_USUARIO_TIPO_SERVICO, ID_SITUACAO_ESPECIFICA)
values (62, 45)


insert [DBPMAS2015].[dbo].[TB_USUARIO_TIPO_SERVICOxSITUACAO_ESPECIFICA] (ID_USUARIO_TIPO_SERVICO, ID_SITUACAO_ESPECIFICA)
values (30, 45)
insert [DBPMAS2015].[dbo].[TB_USUARIO_TIPO_SERVICOxSITUACAO_ESPECIFICA] (ID_USUARIO_TIPO_SERVICO, ID_SITUACAO_ESPECIFICA)
values (31, 45)
insert [DBPMAS2015].[dbo].[TB_USUARIO_TIPO_SERVICOxSITUACAO_ESPECIFICA] (ID_USUARIO_TIPO_SERVICO, ID_SITUACAO_ESPECIFICA)
values (32, 45)
insert [DBPMAS2015].[dbo].[TB_USUARIO_TIPO_SERVICOxSITUACAO_ESPECIFICA] (ID_USUARIO_TIPO_SERVICO, ID_SITUACAO_ESPECIFICA)
values (33, 45)
insert [DBPMAS2015].[dbo].[TB_USUARIO_TIPO_SERVICOxSITUACAO_ESPECIFICA] (ID_USUARIO_TIPO_SERVICO, ID_SITUACAO_ESPECIFICA)
values (34, 45)
insert [DBPMAS2015].[dbo].[TB_USUARIO_TIPO_SERVICOxSITUACAO_ESPECIFICA] (ID_USUARIO_TIPO_SERVICO, ID_SITUACAO_ESPECIFICA)
values (35, 45)
insert [DBPMAS2015].[dbo].[TB_USUARIO_TIPO_SERVICOxSITUACAO_ESPECIFICA] (ID_USUARIO_TIPO_SERVICO, ID_SITUACAO_ESPECIFICA)
values (36, 45)
insert [DBPMAS2015].[dbo].[TB_USUARIO_TIPO_SERVICOxSITUACAO_ESPECIFICA] (ID_USUARIO_TIPO_SERVICO, ID_SITUACAO_ESPECIFICA)
values (63, 45)


insert [DBPMAS2015].[dbo].[TB_USUARIO_TIPO_SERVICOxSITUACAO_ESPECIFICA] (ID_USUARIO_TIPO_SERVICO, ID_SITUACAO_ESPECIFICA)
values (54, 45)
insert [DBPMAS2015].[dbo].[TB_USUARIO_TIPO_SERVICOxSITUACAO_ESPECIFICA] (ID_USUARIO_TIPO_SERVICO, ID_SITUACAO_ESPECIFICA)
values (55, 45)
insert [DBPMAS2015].[dbo].[TB_USUARIO_TIPO_SERVICOxSITUACAO_ESPECIFICA] (ID_USUARIO_TIPO_SERVICO, ID_SITUACAO_ESPECIFICA)
values (56, 45)
insert [DBPMAS2015].[dbo].[TB_USUARIO_TIPO_SERVICOxSITUACAO_ESPECIFICA] (ID_USUARIO_TIPO_SERVICO, ID_SITUACAO_ESPECIFICA)
values (57, 45)
insert [DBPMAS2015].[dbo].[TB_USUARIO_TIPO_SERVICOxSITUACAO_ESPECIFICA] (ID_USUARIO_TIPO_SERVICO, ID_SITUACAO_ESPECIFICA)
values (58, 45)
insert [DBPMAS2015].[dbo].[TB_USUARIO_TIPO_SERVICOxSITUACAO_ESPECIFICA] (ID_USUARIO_TIPO_SERVICO, ID_SITUACAO_ESPECIFICA)
values (59, 45)
insert [DBPMAS2015].[dbo].[TB_USUARIO_TIPO_SERVICOxSITUACAO_ESPECIFICA] (ID_USUARIO_TIPO_SERVICO, ID_SITUACAO_ESPECIFICA)
values (60, 45)
insert [DBPMAS2015].[dbo].[TB_USUARIO_TIPO_SERVICOxSITUACAO_ESPECIFICA] (ID_USUARIO_TIPO_SERVICO, ID_SITUACAO_ESPECIFICA)
values (64, 45)


insert [DBPMAS2015].[dbo].[TB_USUARIO_TIPO_SERVICOxSITUACAO_ESPECIFICA] (ID_USUARIO_TIPO_SERVICO, ID_SITUACAO_ESPECIFICA)
values (65, 2)
insert [DBPMAS2015].[dbo].[TB_USUARIO_TIPO_SERVICOxSITUACAO_ESPECIFICA] (ID_USUARIO_TIPO_SERVICO, ID_SITUACAO_ESPECIFICA)
values (65, 3)
insert [DBPMAS2015].[dbo].[TB_USUARIO_TIPO_SERVICOxSITUACAO_ESPECIFICA] (ID_USUARIO_TIPO_SERVICO, ID_SITUACAO_ESPECIFICA)
values (65, 21)
insert [DBPMAS2015].[dbo].[TB_USUARIO_TIPO_SERVICOxSITUACAO_ESPECIFICA] (ID_USUARIO_TIPO_SERVICO, ID_SITUACAO_ESPECIFICA)
values (65, 7)
insert [DBPMAS2015].[dbo].[TB_USUARIO_TIPO_SERVICOxSITUACAO_ESPECIFICA] (ID_USUARIO_TIPO_SERVICO, ID_SITUACAO_ESPECIFICA)
values (65, 8)
insert [DBPMAS2015].[dbo].[TB_USUARIO_TIPO_SERVICOxSITUACAO_ESPECIFICA] (ID_USUARIO_TIPO_SERVICO, ID_SITUACAO_ESPECIFICA)
values (65, 26)
insert [DBPMAS2015].[dbo].[TB_USUARIO_TIPO_SERVICOxSITUACAO_ESPECIFICA] (ID_USUARIO_TIPO_SERVICO, ID_SITUACAO_ESPECIFICA)
values (65, 27)
insert [DBPMAS2015].[dbo].[TB_USUARIO_TIPO_SERVICOxSITUACAO_ESPECIFICA] (ID_USUARIO_TIPO_SERVICO, ID_SITUACAO_ESPECIFICA)
values (65, 11)
insert [DBPMAS2015].[dbo].[TB_USUARIO_TIPO_SERVICOxSITUACAO_ESPECIFICA] (ID_USUARIO_TIPO_SERVICO, ID_SITUACAO_ESPECIFICA)
values (65, 30)
insert [DBPMAS2015].[dbo].[TB_USUARIO_TIPO_SERVICOxSITUACAO_ESPECIFICA] (ID_USUARIO_TIPO_SERVICO, ID_SITUACAO_ESPECIFICA)
values (65, 34)
insert [DBPMAS2015].[dbo].[TB_USUARIO_TIPO_SERVICOxSITUACAO_ESPECIFICA] (ID_USUARIO_TIPO_SERVICO, ID_SITUACAO_ESPECIFICA)
values (65, 38)
insert [DBPMAS2015].[dbo].[TB_USUARIO_TIPO_SERVICOxSITUACAO_ESPECIFICA] (ID_USUARIO_TIPO_SERVICO, ID_SITUACAO_ESPECIFICA)
values (65, 40)
insert [DBPMAS2015].[dbo].[TB_USUARIO_TIPO_SERVICOxSITUACAO_ESPECIFICA] (ID_USUARIO_TIPO_SERVICO, ID_SITUACAO_ESPECIFICA)
values (65, 44)
insert [DBPMAS2015].[dbo].[TB_USUARIO_TIPO_SERVICOxSITUACAO_ESPECIFICA] (ID_USUARIO_TIPO_SERVICO, ID_SITUACAO_ESPECIFICA)
values (65, 45)



insert [DBPMAS2015].[dbo].[TB_USUARIO_TIPO_SERVICOxSITUACAO_ESPECIFICA] (ID_USUARIO_TIPO_SERVICO, ID_SITUACAO_ESPECIFICA)
values (66, 2)
insert [DBPMAS2015].[dbo].[TB_USUARIO_TIPO_SERVICOxSITUACAO_ESPECIFICA] (ID_USUARIO_TIPO_SERVICO, ID_SITUACAO_ESPECIFICA)
values (66, 3)
insert [DBPMAS2015].[dbo].[TB_USUARIO_TIPO_SERVICOxSITUACAO_ESPECIFICA] (ID_USUARIO_TIPO_SERVICO, ID_SITUACAO_ESPECIFICA)
values (66, 7)
insert [DBPMAS2015].[dbo].[TB_USUARIO_TIPO_SERVICOxSITUACAO_ESPECIFICA] (ID_USUARIO_TIPO_SERVICO, ID_SITUACAO_ESPECIFICA)
values (66, 8)
insert [DBPMAS2015].[dbo].[TB_USUARIO_TIPO_SERVICOxSITUACAO_ESPECIFICA] (ID_USUARIO_TIPO_SERVICO, ID_SITUACAO_ESPECIFICA)
values (66, 26)
insert [DBPMAS2015].[dbo].[TB_USUARIO_TIPO_SERVICOxSITUACAO_ESPECIFICA] (ID_USUARIO_TIPO_SERVICO, ID_SITUACAO_ESPECIFICA)
values (66, 27)
insert [DBPMAS2015].[dbo].[TB_USUARIO_TIPO_SERVICOxSITUACAO_ESPECIFICA] (ID_USUARIO_TIPO_SERVICO, ID_SITUACAO_ESPECIFICA)
values (66, 11)
insert [DBPMAS2015].[dbo].[TB_USUARIO_TIPO_SERVICOxSITUACAO_ESPECIFICA] (ID_USUARIO_TIPO_SERVICO, ID_SITUACAO_ESPECIFICA)
values (66, 30)
insert [DBPMAS2015].[dbo].[TB_USUARIO_TIPO_SERVICOxSITUACAO_ESPECIFICA] (ID_USUARIO_TIPO_SERVICO, ID_SITUACAO_ESPECIFICA)
values (66, 34)
insert [DBPMAS2015].[dbo].[TB_USUARIO_TIPO_SERVICOxSITUACAO_ESPECIFICA] (ID_USUARIO_TIPO_SERVICO, ID_SITUACAO_ESPECIFICA)
values (66, 38)
insert [DBPMAS2015].[dbo].[TB_USUARIO_TIPO_SERVICOxSITUACAO_ESPECIFICA] (ID_USUARIO_TIPO_SERVICO, ID_SITUACAO_ESPECIFICA)
values (66, 40)
insert [DBPMAS2015].[dbo].[TB_USUARIO_TIPO_SERVICOxSITUACAO_ESPECIFICA] (ID_USUARIO_TIPO_SERVICO, ID_SITUACAO_ESPECIFICA)
values (66, 44)
insert [DBPMAS2015].[dbo].[TB_USUARIO_TIPO_SERVICOxSITUACAO_ESPECIFICA] (ID_USUARIO_TIPO_SERVICO, ID_SITUACAO_ESPECIFICA)
values (66, 46)

insert [DBPMAS2015].[dbo].[TB_USUARIO_TIPO_SERVICOxSITUACAO_ESPECIFICA] (ID_USUARIO_TIPO_SERVICO, ID_SITUACAO_ESPECIFICA)
values (67, 2)
insert [DBPMAS2015].[dbo].[TB_USUARIO_TIPO_SERVICOxSITUACAO_ESPECIFICA] (ID_USUARIO_TIPO_SERVICO, ID_SITUACAO_ESPECIFICA)
values (67, 3)
insert [DBPMAS2015].[dbo].[TB_USUARIO_TIPO_SERVICOxSITUACAO_ESPECIFICA] (ID_USUARIO_TIPO_SERVICO, ID_SITUACAO_ESPECIFICA)
values (67, 4)
insert [DBPMAS2015].[dbo].[TB_USUARIO_TIPO_SERVICOxSITUACAO_ESPECIFICA] (ID_USUARIO_TIPO_SERVICO, ID_SITUACAO_ESPECIFICA)
values (67, 5)
insert [DBPMAS2015].[dbo].[TB_USUARIO_TIPO_SERVICOxSITUACAO_ESPECIFICA] (ID_USUARIO_TIPO_SERVICO, ID_SITUACAO_ESPECIFICA)
values (67, 25)
insert [DBPMAS2015].[dbo].[TB_USUARIO_TIPO_SERVICOxSITUACAO_ESPECIFICA] (ID_USUARIO_TIPO_SERVICO, ID_SITUACAO_ESPECIFICA)
values (67, 22)
insert [DBPMAS2015].[dbo].[TB_USUARIO_TIPO_SERVICOxSITUACAO_ESPECIFICA] (ID_USUARIO_TIPO_SERVICO, ID_SITUACAO_ESPECIFICA)
values (67, 6)
insert [DBPMAS2015].[dbo].[TB_USUARIO_TIPO_SERVICOxSITUACAO_ESPECIFICA] (ID_USUARIO_TIPO_SERVICO, ID_SITUACAO_ESPECIFICA)
values (67, 29)
insert [DBPMAS2015].[dbo].[TB_USUARIO_TIPO_SERVICOxSITUACAO_ESPECIFICA] (ID_USUARIO_TIPO_SERVICO, ID_SITUACAO_ESPECIFICA)
values (67, 9)
insert [DBPMAS2015].[dbo].[TB_USUARIO_TIPO_SERVICOxSITUACAO_ESPECIFICA] (ID_USUARIO_TIPO_SERVICO, ID_SITUACAO_ESPECIFICA)
values (67, 11)
insert [DBPMAS2015].[dbo].[TB_USUARIO_TIPO_SERVICOxSITUACAO_ESPECIFICA] (ID_USUARIO_TIPO_SERVICO, ID_SITUACAO_ESPECIFICA)
values (67, 12)
insert [DBPMAS2015].[dbo].[TB_USUARIO_TIPO_SERVICOxSITUACAO_ESPECIFICA] (ID_USUARIO_TIPO_SERVICO, ID_SITUACAO_ESPECIFICA)
values (67, 34)
insert [DBPMAS2015].[dbo].[TB_USUARIO_TIPO_SERVICOxSITUACAO_ESPECIFICA] (ID_USUARIO_TIPO_SERVICO, ID_SITUACAO_ESPECIFICA)
values (67, 35)
insert [DBPMAS2015].[dbo].[TB_USUARIO_TIPO_SERVICOxSITUACAO_ESPECIFICA] (ID_USUARIO_TIPO_SERVICO, ID_SITUACAO_ESPECIFICA)
values (67, 36)
insert [DBPMAS2015].[dbo].[TB_USUARIO_TIPO_SERVICOxSITUACAO_ESPECIFICA] (ID_USUARIO_TIPO_SERVICO, ID_SITUACAO_ESPECIFICA)
values (67, 37)
insert [DBPMAS2015].[dbo].[TB_USUARIO_TIPO_SERVICOxSITUACAO_ESPECIFICA] (ID_USUARIO_TIPO_SERVICO, ID_SITUACAO_ESPECIFICA)
values (67, 38)
insert [DBPMAS2015].[dbo].[TB_USUARIO_TIPO_SERVICOxSITUACAO_ESPECIFICA] (ID_USUARIO_TIPO_SERVICO, ID_SITUACAO_ESPECIFICA)
values (67, 39)


insert [DBPMAS2015].[dbo].[TB_USUARIO_TIPO_SERVICOxSITUACAO_ESPECIFICA] (ID_USUARIO_TIPO_SERVICO, ID_SITUACAO_ESPECIFICA)
values (68, 4)
insert [DBPMAS2015].[dbo].[TB_USUARIO_TIPO_SERVICOxSITUACAO_ESPECIFICA] (ID_USUARIO_TIPO_SERVICO, ID_SITUACAO_ESPECIFICA)
values (68, 29)
insert [DBPMAS2015].[dbo].[TB_USUARIO_TIPO_SERVICOxSITUACAO_ESPECIFICA] (ID_USUARIO_TIPO_SERVICO, ID_SITUACAO_ESPECIFICA)
values (68, 11)
insert [DBPMAS2015].[dbo].[TB_USUARIO_TIPO_SERVICOxSITUACAO_ESPECIFICA] (ID_USUARIO_TIPO_SERVICO, ID_SITUACAO_ESPECIFICA)
values (68, 12)
insert [DBPMAS2015].[dbo].[TB_USUARIO_TIPO_SERVICOxSITUACAO_ESPECIFICA] (ID_USUARIO_TIPO_SERVICO, ID_SITUACAO_ESPECIFICA)
values (68, 34)
insert [DBPMAS2015].[dbo].[TB_USUARIO_TIPO_SERVICOxSITUACAO_ESPECIFICA] (ID_USUARIO_TIPO_SERVICO, ID_SITUACAO_ESPECIFICA)
values (68, 36)
insert [DBPMAS2015].[dbo].[TB_USUARIO_TIPO_SERVICOxSITUACAO_ESPECIFICA] (ID_USUARIO_TIPO_SERVICO, ID_SITUACAO_ESPECIFICA)
values (68, 37)
insert [DBPMAS2015].[dbo].[TB_USUARIO_TIPO_SERVICOxSITUACAO_ESPECIFICA] (ID_USUARIO_TIPO_SERVICO, ID_SITUACAO_ESPECIFICA)
values (68, 38)
insert [DBPMAS2015].[dbo].[TB_USUARIO_TIPO_SERVICOxSITUACAO_ESPECIFICA] (ID_USUARIO_TIPO_SERVICO, ID_SITUACAO_ESPECIFICA)
values (68, 48)

insert [DBPMAS2015].[dbo].[TB_USUARIO_TIPO_SERVICOxSITUACAO_ESPECIFICA] (ID_USUARIO_TIPO_SERVICO, ID_SITUACAO_ESPECIFICA)
values (69, 4)
insert [DBPMAS2015].[dbo].[TB_USUARIO_TIPO_SERVICOxSITUACAO_ESPECIFICA] (ID_USUARIO_TIPO_SERVICO, ID_SITUACAO_ESPECIFICA)
values (69, 29)
insert [DBPMAS2015].[dbo].[TB_USUARIO_TIPO_SERVICOxSITUACAO_ESPECIFICA] (ID_USUARIO_TIPO_SERVICO, ID_SITUACAO_ESPECIFICA)
values (69, 11)
insert [DBPMAS2015].[dbo].[TB_USUARIO_TIPO_SERVICOxSITUACAO_ESPECIFICA] (ID_USUARIO_TIPO_SERVICO, ID_SITUACAO_ESPECIFICA)
values (69, 12)
insert [DBPMAS2015].[dbo].[TB_USUARIO_TIPO_SERVICOxSITUACAO_ESPECIFICA] (ID_USUARIO_TIPO_SERVICO, ID_SITUACAO_ESPECIFICA)
values (69, 34)
insert [DBPMAS2015].[dbo].[TB_USUARIO_TIPO_SERVICOxSITUACAO_ESPECIFICA] (ID_USUARIO_TIPO_SERVICO, ID_SITUACAO_ESPECIFICA)
values (69, 36)
insert [DBPMAS2015].[dbo].[TB_USUARIO_TIPO_SERVICOxSITUACAO_ESPECIFICA] (ID_USUARIO_TIPO_SERVICO, ID_SITUACAO_ESPECIFICA)
values (69, 37)
insert [DBPMAS2015].[dbo].[TB_USUARIO_TIPO_SERVICOxSITUACAO_ESPECIFICA] (ID_USUARIO_TIPO_SERVICO, ID_SITUACAO_ESPECIFICA)
values (69, 38)
insert [DBPMAS2015].[dbo].[TB_USUARIO_TIPO_SERVICOxSITUACAO_ESPECIFICA] (ID_USUARIO_TIPO_SERVICO, ID_SITUACAO_ESPECIFICA)
values (69, 47)


insert [DBPMAS2015].[dbo].[TB_USUARIO_TIPO_SERVICOxSITUACAO_ESPECIFICA] (ID_USUARIO_TIPO_SERVICO, ID_SITUACAO_ESPECIFICA)
values (70, 14)
insert [DBPMAS2015].[dbo].[TB_USUARIO_TIPO_SERVICOxSITUACAO_ESPECIFICA] (ID_USUARIO_TIPO_SERVICO, ID_SITUACAO_ESPECIFICA)
values (70, 15)
insert [DBPMAS2015].[dbo].[TB_USUARIO_TIPO_SERVICOxSITUACAO_ESPECIFICA] (ID_USUARIO_TIPO_SERVICO, ID_SITUACAO_ESPECIFICA)
values (70, 16)
insert [DBPMAS2015].[dbo].[TB_USUARIO_TIPO_SERVICOxSITUACAO_ESPECIFICA] (ID_USUARIO_TIPO_SERVICO, ID_SITUACAO_ESPECIFICA)
values (70, 17)
insert [DBPMAS2015].[dbo].[TB_USUARIO_TIPO_SERVICOxSITUACAO_ESPECIFICA] (ID_USUARIO_TIPO_SERVICO, ID_SITUACAO_ESPECIFICA)
values (70, 18)
insert [DBPMAS2015].[dbo].[TB_USUARIO_TIPO_SERVICOxSITUACAO_ESPECIFICA] (ID_USUARIO_TIPO_SERVICO, ID_SITUACAO_ESPECIFICA)
values (70, 19)
insert [DBPMAS2015].[dbo].[TB_USUARIO_TIPO_SERVICOxSITUACAO_ESPECIFICA] (ID_USUARIO_TIPO_SERVICO, ID_SITUACAO_ESPECIFICA)
values (70, 20)
insert [DBPMAS2015].[dbo].[TB_USUARIO_TIPO_SERVICOxSITUACAO_ESPECIFICA] (ID_USUARIO_TIPO_SERVICO, ID_SITUACAO_ESPECIFICA)
values (70, 6)
insert [DBPMAS2015].[dbo].[TB_USUARIO_TIPO_SERVICOxSITUACAO_ESPECIFICA] (ID_USUARIO_TIPO_SERVICO, ID_SITUACAO_ESPECIFICA)
values (70, 7)
insert [DBPMAS2015].[dbo].[TB_USUARIO_TIPO_SERVICOxSITUACAO_ESPECIFICA] (ID_USUARIO_TIPO_SERVICO, ID_SITUACAO_ESPECIFICA)
values (70, 8)
insert [DBPMAS2015].[dbo].[TB_USUARIO_TIPO_SERVICOxSITUACAO_ESPECIFICA] (ID_USUARIO_TIPO_SERVICO, ID_SITUACAO_ESPECIFICA)
values (70, 26)
insert [DBPMAS2015].[dbo].[TB_USUARIO_TIPO_SERVICOxSITUACAO_ESPECIFICA] (ID_USUARIO_TIPO_SERVICO, ID_SITUACAO_ESPECIFICA)
values (70, 27)
insert [DBPMAS2015].[dbo].[TB_USUARIO_TIPO_SERVICOxSITUACAO_ESPECIFICA] (ID_USUARIO_TIPO_SERVICO, ID_SITUACAO_ESPECIFICA)
values (70, 10)
insert [DBPMAS2015].[dbo].[TB_USUARIO_TIPO_SERVICOxSITUACAO_ESPECIFICA] (ID_USUARIO_TIPO_SERVICO, ID_SITUACAO_ESPECIFICA)
values (70, 13)
insert [DBPMAS2015].[dbo].[TB_USUARIO_TIPO_SERVICOxSITUACAO_ESPECIFICA] (ID_USUARIO_TIPO_SERVICO, ID_SITUACAO_ESPECIFICA)
values (70, 23)
insert [DBPMAS2015].[dbo].[TB_USUARIO_TIPO_SERVICOxSITUACAO_ESPECIFICA] (ID_USUARIO_TIPO_SERVICO, ID_SITUACAO_ESPECIFICA)
values (70, 24)
insert [DBPMAS2015].[dbo].[TB_USUARIO_TIPO_SERVICOxSITUACAO_ESPECIFICA] (ID_USUARIO_TIPO_SERVICO, ID_SITUACAO_ESPECIFICA)
values (70, 35)
insert [DBPMAS2015].[dbo].[TB_USUARIO_TIPO_SERVICOxSITUACAO_ESPECIFICA] (ID_USUARIO_TIPO_SERVICO, ID_SITUACAO_ESPECIFICA)
values (70, 36)
insert [DBPMAS2015].[dbo].[TB_USUARIO_TIPO_SERVICOxSITUACAO_ESPECIFICA] (ID_USUARIO_TIPO_SERVICO, ID_SITUACAO_ESPECIFICA)
values (70, 37)
insert [DBPMAS2015].[dbo].[TB_USUARIO_TIPO_SERVICOxSITUACAO_ESPECIFICA] (ID_USUARIO_TIPO_SERVICO, ID_SITUACAO_ESPECIFICA)
values (70, 42)


insert [DBPMAS2015].[dbo].[TB_USUARIO_TIPO_SERVICOxSITUACAO_ESPECIFICA] (ID_USUARIO_TIPO_SERVICO, ID_SITUACAO_ESPECIFICA)
values (71, 14)
insert [DBPMAS2015].[dbo].[TB_USUARIO_TIPO_SERVICOxSITUACAO_ESPECIFICA] (ID_USUARIO_TIPO_SERVICO, ID_SITUACAO_ESPECIFICA)
values (71, 15)
insert [DBPMAS2015].[dbo].[TB_USUARIO_TIPO_SERVICOxSITUACAO_ESPECIFICA] (ID_USUARIO_TIPO_SERVICO, ID_SITUACAO_ESPECIFICA)
values (71, 16)
insert [DBPMAS2015].[dbo].[TB_USUARIO_TIPO_SERVICOxSITUACAO_ESPECIFICA] (ID_USUARIO_TIPO_SERVICO, ID_SITUACAO_ESPECIFICA)
values (71, 17)
insert [DBPMAS2015].[dbo].[TB_USUARIO_TIPO_SERVICOxSITUACAO_ESPECIFICA] (ID_USUARIO_TIPO_SERVICO, ID_SITUACAO_ESPECIFICA)
values (71, 18)
insert [DBPMAS2015].[dbo].[TB_USUARIO_TIPO_SERVICOxSITUACAO_ESPECIFICA] (ID_USUARIO_TIPO_SERVICO, ID_SITUACAO_ESPECIFICA)
values (71, 19)
insert [DBPMAS2015].[dbo].[TB_USUARIO_TIPO_SERVICOxSITUACAO_ESPECIFICA] (ID_USUARIO_TIPO_SERVICO, ID_SITUACAO_ESPECIFICA)
values (71, 20)
insert [DBPMAS2015].[dbo].[TB_USUARIO_TIPO_SERVICOxSITUACAO_ESPECIFICA] (ID_USUARIO_TIPO_SERVICO, ID_SITUACAO_ESPECIFICA)
values (71, 6)
insert [DBPMAS2015].[dbo].[TB_USUARIO_TIPO_SERVICOxSITUACAO_ESPECIFICA] (ID_USUARIO_TIPO_SERVICO, ID_SITUACAO_ESPECIFICA)
values (71, 7)
insert [DBPMAS2015].[dbo].[TB_USUARIO_TIPO_SERVICOxSITUACAO_ESPECIFICA] (ID_USUARIO_TIPO_SERVICO, ID_SITUACAO_ESPECIFICA)
values (71, 8)
insert [DBPMAS2015].[dbo].[TB_USUARIO_TIPO_SERVICOxSITUACAO_ESPECIFICA] (ID_USUARIO_TIPO_SERVICO, ID_SITUACAO_ESPECIFICA)
values (71, 26)
insert [DBPMAS2015].[dbo].[TB_USUARIO_TIPO_SERVICOxSITUACAO_ESPECIFICA] (ID_USUARIO_TIPO_SERVICO, ID_SITUACAO_ESPECIFICA)
values (71, 27)
insert [DBPMAS2015].[dbo].[TB_USUARIO_TIPO_SERVICOxSITUACAO_ESPECIFICA] (ID_USUARIO_TIPO_SERVICO, ID_SITUACAO_ESPECIFICA)
values (71, 10)
insert [DBPMAS2015].[dbo].[TB_USUARIO_TIPO_SERVICOxSITUACAO_ESPECIFICA] (ID_USUARIO_TIPO_SERVICO, ID_SITUACAO_ESPECIFICA)
values (71, 13)
insert [DBPMAS2015].[dbo].[TB_USUARIO_TIPO_SERVICOxSITUACAO_ESPECIFICA] (ID_USUARIO_TIPO_SERVICO, ID_SITUACAO_ESPECIFICA)
values (71, 23)
insert [DBPMAS2015].[dbo].[TB_USUARIO_TIPO_SERVICOxSITUACAO_ESPECIFICA] (ID_USUARIO_TIPO_SERVICO, ID_SITUACAO_ESPECIFICA)
values (71, 24)
insert [DBPMAS2015].[dbo].[TB_USUARIO_TIPO_SERVICOxSITUACAO_ESPECIFICA] (ID_USUARIO_TIPO_SERVICO, ID_SITUACAO_ESPECIFICA)
values (71, 35)
insert [DBPMAS2015].[dbo].[TB_USUARIO_TIPO_SERVICOxSITUACAO_ESPECIFICA] (ID_USUARIO_TIPO_SERVICO, ID_SITUACAO_ESPECIFICA)
values (71, 36)
insert [DBPMAS2015].[dbo].[TB_USUARIO_TIPO_SERVICOxSITUACAO_ESPECIFICA] (ID_USUARIO_TIPO_SERVICO, ID_SITUACAO_ESPECIFICA)
values (71, 37)
insert [DBPMAS2015].[dbo].[TB_USUARIO_TIPO_SERVICOxSITUACAO_ESPECIFICA] (ID_USUARIO_TIPO_SERVICO, ID_SITUACAO_ESPECIFICA)
values (71, 42)


insert [DBPMAS2015].[dbo].[TB_USUARIO_TIPO_SERVICOxSITUACAO_ESPECIFICA] (ID_USUARIO_TIPO_SERVICO, ID_SITUACAO_ESPECIFICA)
values (72, 14)
insert [DBPMAS2015].[dbo].[TB_USUARIO_TIPO_SERVICOxSITUACAO_ESPECIFICA] (ID_USUARIO_TIPO_SERVICO, ID_SITUACAO_ESPECIFICA)
values (72, 15)
insert [DBPMAS2015].[dbo].[TB_USUARIO_TIPO_SERVICOxSITUACAO_ESPECIFICA] (ID_USUARIO_TIPO_SERVICO, ID_SITUACAO_ESPECIFICA)
values (72, 16)
insert [DBPMAS2015].[dbo].[TB_USUARIO_TIPO_SERVICOxSITUACAO_ESPECIFICA] (ID_USUARIO_TIPO_SERVICO, ID_SITUACAO_ESPECIFICA)
values (72, 17)
insert [DBPMAS2015].[dbo].[TB_USUARIO_TIPO_SERVICOxSITUACAO_ESPECIFICA] (ID_USUARIO_TIPO_SERVICO, ID_SITUACAO_ESPECIFICA)
values (72, 18)
insert [DBPMAS2015].[dbo].[TB_USUARIO_TIPO_SERVICOxSITUACAO_ESPECIFICA] (ID_USUARIO_TIPO_SERVICO, ID_SITUACAO_ESPECIFICA)
values (72, 19)
insert [DBPMAS2015].[dbo].[TB_USUARIO_TIPO_SERVICOxSITUACAO_ESPECIFICA] (ID_USUARIO_TIPO_SERVICO, ID_SITUACAO_ESPECIFICA)
values (72, 20)
insert [DBPMAS2015].[dbo].[TB_USUARIO_TIPO_SERVICOxSITUACAO_ESPECIFICA] (ID_USUARIO_TIPO_SERVICO, ID_SITUACAO_ESPECIFICA)
values (72, 6)
insert [DBPMAS2015].[dbo].[TB_USUARIO_TIPO_SERVICOxSITUACAO_ESPECIFICA] (ID_USUARIO_TIPO_SERVICO, ID_SITUACAO_ESPECIFICA)
values (72, 7)
insert [DBPMAS2015].[dbo].[TB_USUARIO_TIPO_SERVICOxSITUACAO_ESPECIFICA] (ID_USUARIO_TIPO_SERVICO, ID_SITUACAO_ESPECIFICA)
values (72, 8)
insert [DBPMAS2015].[dbo].[TB_USUARIO_TIPO_SERVICOxSITUACAO_ESPECIFICA] (ID_USUARIO_TIPO_SERVICO, ID_SITUACAO_ESPECIFICA)
values (72, 26)
insert [DBPMAS2015].[dbo].[TB_USUARIO_TIPO_SERVICOxSITUACAO_ESPECIFICA] (ID_USUARIO_TIPO_SERVICO, ID_SITUACAO_ESPECIFICA)
values (72, 27)
insert [DBPMAS2015].[dbo].[TB_USUARIO_TIPO_SERVICOxSITUACAO_ESPECIFICA] (ID_USUARIO_TIPO_SERVICO, ID_SITUACAO_ESPECIFICA)
values (72, 10)
insert [DBPMAS2015].[dbo].[TB_USUARIO_TIPO_SERVICOxSITUACAO_ESPECIFICA] (ID_USUARIO_TIPO_SERVICO, ID_SITUACAO_ESPECIFICA)
values (72, 13)
insert [DBPMAS2015].[dbo].[TB_USUARIO_TIPO_SERVICOxSITUACAO_ESPECIFICA] (ID_USUARIO_TIPO_SERVICO, ID_SITUACAO_ESPECIFICA)
values (72, 23)
insert [DBPMAS2015].[dbo].[TB_USUARIO_TIPO_SERVICOxSITUACAO_ESPECIFICA] (ID_USUARIO_TIPO_SERVICO, ID_SITUACAO_ESPECIFICA)
values (72, 24)
insert [DBPMAS2015].[dbo].[TB_USUARIO_TIPO_SERVICOxSITUACAO_ESPECIFICA] (ID_USUARIO_TIPO_SERVICO, ID_SITUACAO_ESPECIFICA)
values (72, 35)
insert [DBPMAS2015].[dbo].[TB_USUARIO_TIPO_SERVICOxSITUACAO_ESPECIFICA] (ID_USUARIO_TIPO_SERVICO, ID_SITUACAO_ESPECIFICA)
values (72, 36)
insert [DBPMAS2015].[dbo].[TB_USUARIO_TIPO_SERVICOxSITUACAO_ESPECIFICA] (ID_USUARIO_TIPO_SERVICO, ID_SITUACAO_ESPECIFICA)
values (72, 37)
insert [DBPMAS2015].[dbo].[TB_USUARIO_TIPO_SERVICOxSITUACAO_ESPECIFICA] (ID_USUARIO_TIPO_SERVICO, ID_SITUACAO_ESPECIFICA)
values (72, 42)


insert [DBPMAS2015].[dbo].[TB_USUARIO_TIPO_SERVICOxSITUACAO_ESPECIFICA] (ID_USUARIO_TIPO_SERVICO, ID_SITUACAO_ESPECIFICA)
values (73, 14)
insert [DBPMAS2015].[dbo].[TB_USUARIO_TIPO_SERVICOxSITUACAO_ESPECIFICA] (ID_USUARIO_TIPO_SERVICO, ID_SITUACAO_ESPECIFICA)
values (73, 15)
insert [DBPMAS2015].[dbo].[TB_USUARIO_TIPO_SERVICOxSITUACAO_ESPECIFICA] (ID_USUARIO_TIPO_SERVICO, ID_SITUACAO_ESPECIFICA)
values (73, 16)
insert [DBPMAS2015].[dbo].[TB_USUARIO_TIPO_SERVICOxSITUACAO_ESPECIFICA] (ID_USUARIO_TIPO_SERVICO, ID_SITUACAO_ESPECIFICA)
values (73, 17)
insert [DBPMAS2015].[dbo].[TB_USUARIO_TIPO_SERVICOxSITUACAO_ESPECIFICA] (ID_USUARIO_TIPO_SERVICO, ID_SITUACAO_ESPECIFICA)
values (73, 18)
insert [DBPMAS2015].[dbo].[TB_USUARIO_TIPO_SERVICOxSITUACAO_ESPECIFICA] (ID_USUARIO_TIPO_SERVICO, ID_SITUACAO_ESPECIFICA)
values (73, 19)
insert [DBPMAS2015].[dbo].[TB_USUARIO_TIPO_SERVICOxSITUACAO_ESPECIFICA] (ID_USUARIO_TIPO_SERVICO, ID_SITUACAO_ESPECIFICA)
values (73, 20)
insert [DBPMAS2015].[dbo].[TB_USUARIO_TIPO_SERVICOxSITUACAO_ESPECIFICA] (ID_USUARIO_TIPO_SERVICO, ID_SITUACAO_ESPECIFICA)
values (73, 6)
insert [DBPMAS2015].[dbo].[TB_USUARIO_TIPO_SERVICOxSITUACAO_ESPECIFICA] (ID_USUARIO_TIPO_SERVICO, ID_SITUACAO_ESPECIFICA)
values (73, 7)
insert [DBPMAS2015].[dbo].[TB_USUARIO_TIPO_SERVICOxSITUACAO_ESPECIFICA] (ID_USUARIO_TIPO_SERVICO, ID_SITUACAO_ESPECIFICA)
values (73, 8)
insert [DBPMAS2015].[dbo].[TB_USUARIO_TIPO_SERVICOxSITUACAO_ESPECIFICA] (ID_USUARIO_TIPO_SERVICO, ID_SITUACAO_ESPECIFICA)
values (73, 26)
insert [DBPMAS2015].[dbo].[TB_USUARIO_TIPO_SERVICOxSITUACAO_ESPECIFICA] (ID_USUARIO_TIPO_SERVICO, ID_SITUACAO_ESPECIFICA)
values (73, 27)
insert [DBPMAS2015].[dbo].[TB_USUARIO_TIPO_SERVICOxSITUACAO_ESPECIFICA] (ID_USUARIO_TIPO_SERVICO, ID_SITUACAO_ESPECIFICA)
values (73, 10)
insert [DBPMAS2015].[dbo].[TB_USUARIO_TIPO_SERVICOxSITUACAO_ESPECIFICA] (ID_USUARIO_TIPO_SERVICO, ID_SITUACAO_ESPECIFICA)
values (73, 13)
insert [DBPMAS2015].[dbo].[TB_USUARIO_TIPO_SERVICOxSITUACAO_ESPECIFICA] (ID_USUARIO_TIPO_SERVICO, ID_SITUACAO_ESPECIFICA)
values (73, 23)
insert [DBPMAS2015].[dbo].[TB_USUARIO_TIPO_SERVICOxSITUACAO_ESPECIFICA] (ID_USUARIO_TIPO_SERVICO, ID_SITUACAO_ESPECIFICA)
values (73, 24)
insert [DBPMAS2015].[dbo].[TB_USUARIO_TIPO_SERVICOxSITUACAO_ESPECIFICA] (ID_USUARIO_TIPO_SERVICO, ID_SITUACAO_ESPECIFICA)
values (73, 35)
insert [DBPMAS2015].[dbo].[TB_USUARIO_TIPO_SERVICOxSITUACAO_ESPECIFICA] (ID_USUARIO_TIPO_SERVICO, ID_SITUACAO_ESPECIFICA)
values (73, 36)
insert [DBPMAS2015].[dbo].[TB_USUARIO_TIPO_SERVICOxSITUACAO_ESPECIFICA] (ID_USUARIO_TIPO_SERVICO, ID_SITUACAO_ESPECIFICA)
values (73, 37)
insert [DBPMAS2015].[dbo].[TB_USUARIO_TIPO_SERVICOxSITUACAO_ESPECIFICA] (ID_USUARIO_TIPO_SERVICO, ID_SITUACAO_ESPECIFICA)
values (73, 42)


insert [DBPMAS2015].[dbo].[TB_USUARIO_TIPO_SERVICOxSITUACAO_ESPECIFICA] (ID_USUARIO_TIPO_SERVICO, ID_SITUACAO_ESPECIFICA)
values (74, 14)
insert [DBPMAS2015].[dbo].[TB_USUARIO_TIPO_SERVICOxSITUACAO_ESPECIFICA] (ID_USUARIO_TIPO_SERVICO, ID_SITUACAO_ESPECIFICA)
values (74, 15)
insert [DBPMAS2015].[dbo].[TB_USUARIO_TIPO_SERVICOxSITUACAO_ESPECIFICA] (ID_USUARIO_TIPO_SERVICO, ID_SITUACAO_ESPECIFICA)
values (74, 16)
insert [DBPMAS2015].[dbo].[TB_USUARIO_TIPO_SERVICOxSITUACAO_ESPECIFICA] (ID_USUARIO_TIPO_SERVICO, ID_SITUACAO_ESPECIFICA)
values (74, 17)
insert [DBPMAS2015].[dbo].[TB_USUARIO_TIPO_SERVICOxSITUACAO_ESPECIFICA] (ID_USUARIO_TIPO_SERVICO, ID_SITUACAO_ESPECIFICA)
values (74, 18)
insert [DBPMAS2015].[dbo].[TB_USUARIO_TIPO_SERVICOxSITUACAO_ESPECIFICA] (ID_USUARIO_TIPO_SERVICO, ID_SITUACAO_ESPECIFICA)
values (74, 19)
insert [DBPMAS2015].[dbo].[TB_USUARIO_TIPO_SERVICOxSITUACAO_ESPECIFICA] (ID_USUARIO_TIPO_SERVICO, ID_SITUACAO_ESPECIFICA)
values (74, 20)
insert [DBPMAS2015].[dbo].[TB_USUARIO_TIPO_SERVICOxSITUACAO_ESPECIFICA] (ID_USUARIO_TIPO_SERVICO, ID_SITUACAO_ESPECIFICA)
values (74, 6)
insert [DBPMAS2015].[dbo].[TB_USUARIO_TIPO_SERVICOxSITUACAO_ESPECIFICA] (ID_USUARIO_TIPO_SERVICO, ID_SITUACAO_ESPECIFICA)
values (74, 7)
insert [DBPMAS2015].[dbo].[TB_USUARIO_TIPO_SERVICOxSITUACAO_ESPECIFICA] (ID_USUARIO_TIPO_SERVICO, ID_SITUACAO_ESPECIFICA)
values (74, 8)
insert [DBPMAS2015].[dbo].[TB_USUARIO_TIPO_SERVICOxSITUACAO_ESPECIFICA] (ID_USUARIO_TIPO_SERVICO, ID_SITUACAO_ESPECIFICA)
values (74, 26)
insert [DBPMAS2015].[dbo].[TB_USUARIO_TIPO_SERVICOxSITUACAO_ESPECIFICA] (ID_USUARIO_TIPO_SERVICO, ID_SITUACAO_ESPECIFICA)
values (74, 27)
insert [DBPMAS2015].[dbo].[TB_USUARIO_TIPO_SERVICOxSITUACAO_ESPECIFICA] (ID_USUARIO_TIPO_SERVICO, ID_SITUACAO_ESPECIFICA)
values (74, 10)
insert [DBPMAS2015].[dbo].[TB_USUARIO_TIPO_SERVICOxSITUACAO_ESPECIFICA] (ID_USUARIO_TIPO_SERVICO, ID_SITUACAO_ESPECIFICA)
values (74, 13)
insert [DBPMAS2015].[dbo].[TB_USUARIO_TIPO_SERVICOxSITUACAO_ESPECIFICA] (ID_USUARIO_TIPO_SERVICO, ID_SITUACAO_ESPECIFICA)
values (74, 23)
insert [DBPMAS2015].[dbo].[TB_USUARIO_TIPO_SERVICOxSITUACAO_ESPECIFICA] (ID_USUARIO_TIPO_SERVICO, ID_SITUACAO_ESPECIFICA)
values (74, 24)
insert [DBPMAS2015].[dbo].[TB_USUARIO_TIPO_SERVICOxSITUACAO_ESPECIFICA] (ID_USUARIO_TIPO_SERVICO, ID_SITUACAO_ESPECIFICA)
values (74, 35)
insert [DBPMAS2015].[dbo].[TB_USUARIO_TIPO_SERVICOxSITUACAO_ESPECIFICA] (ID_USUARIO_TIPO_SERVICO, ID_SITUACAO_ESPECIFICA)
values (74, 36)
insert [DBPMAS2015].[dbo].[TB_USUARIO_TIPO_SERVICOxSITUACAO_ESPECIFICA] (ID_USUARIO_TIPO_SERVICO, ID_SITUACAO_ESPECIFICA)
values (74, 37)
insert [DBPMAS2015].[dbo].[TB_USUARIO_TIPO_SERVICOxSITUACAO_ESPECIFICA] (ID_USUARIO_TIPO_SERVICO, ID_SITUACAO_ESPECIFICA)
values (74, 42)


insert [DBPMAS2015].[dbo].[TB_USUARIO_TIPO_SERVICOxSITUACAO_ESPECIFICA] (ID_USUARIO_TIPO_SERVICO, ID_SITUACAO_ESPECIFICA)
values (75, 14)
insert [DBPMAS2015].[dbo].[TB_USUARIO_TIPO_SERVICOxSITUACAO_ESPECIFICA] (ID_USUARIO_TIPO_SERVICO, ID_SITUACAO_ESPECIFICA)
values (75, 15)
insert [DBPMAS2015].[dbo].[TB_USUARIO_TIPO_SERVICOxSITUACAO_ESPECIFICA] (ID_USUARIO_TIPO_SERVICO, ID_SITUACAO_ESPECIFICA)
values (75, 16)
insert [DBPMAS2015].[dbo].[TB_USUARIO_TIPO_SERVICOxSITUACAO_ESPECIFICA] (ID_USUARIO_TIPO_SERVICO, ID_SITUACAO_ESPECIFICA)
values (75, 17)
insert [DBPMAS2015].[dbo].[TB_USUARIO_TIPO_SERVICOxSITUACAO_ESPECIFICA] (ID_USUARIO_TIPO_SERVICO, ID_SITUACAO_ESPECIFICA)
values (75, 18)
insert [DBPMAS2015].[dbo].[TB_USUARIO_TIPO_SERVICOxSITUACAO_ESPECIFICA] (ID_USUARIO_TIPO_SERVICO, ID_SITUACAO_ESPECIFICA)
values (75, 19)
insert [DBPMAS2015].[dbo].[TB_USUARIO_TIPO_SERVICOxSITUACAO_ESPECIFICA] (ID_USUARIO_TIPO_SERVICO, ID_SITUACAO_ESPECIFICA)
values (75, 20)
insert [DBPMAS2015].[dbo].[TB_USUARIO_TIPO_SERVICOxSITUACAO_ESPECIFICA] (ID_USUARIO_TIPO_SERVICO, ID_SITUACAO_ESPECIFICA)
values (75, 6)
insert [DBPMAS2015].[dbo].[TB_USUARIO_TIPO_SERVICOxSITUACAO_ESPECIFICA] (ID_USUARIO_TIPO_SERVICO, ID_SITUACAO_ESPECIFICA)
values (75, 7)
insert [DBPMAS2015].[dbo].[TB_USUARIO_TIPO_SERVICOxSITUACAO_ESPECIFICA] (ID_USUARIO_TIPO_SERVICO, ID_SITUACAO_ESPECIFICA)
values (75, 8)
insert [DBPMAS2015].[dbo].[TB_USUARIO_TIPO_SERVICOxSITUACAO_ESPECIFICA] (ID_USUARIO_TIPO_SERVICO, ID_SITUACAO_ESPECIFICA)
values (75, 26)
insert [DBPMAS2015].[dbo].[TB_USUARIO_TIPO_SERVICOxSITUACAO_ESPECIFICA] (ID_USUARIO_TIPO_SERVICO, ID_SITUACAO_ESPECIFICA)
values (75, 27)
insert [DBPMAS2015].[dbo].[TB_USUARIO_TIPO_SERVICOxSITUACAO_ESPECIFICA] (ID_USUARIO_TIPO_SERVICO, ID_SITUACAO_ESPECIFICA)
values (75, 10)
insert [DBPMAS2015].[dbo].[TB_USUARIO_TIPO_SERVICOxSITUACAO_ESPECIFICA] (ID_USUARIO_TIPO_SERVICO, ID_SITUACAO_ESPECIFICA)
values (75, 13)
insert [DBPMAS2015].[dbo].[TB_USUARIO_TIPO_SERVICOxSITUACAO_ESPECIFICA] (ID_USUARIO_TIPO_SERVICO, ID_SITUACAO_ESPECIFICA)
values (75, 23)
insert [DBPMAS2015].[dbo].[TB_USUARIO_TIPO_SERVICOxSITUACAO_ESPECIFICA] (ID_USUARIO_TIPO_SERVICO, ID_SITUACAO_ESPECIFICA)
values (75, 24)
insert [DBPMAS2015].[dbo].[TB_USUARIO_TIPO_SERVICOxSITUACAO_ESPECIFICA] (ID_USUARIO_TIPO_SERVICO, ID_SITUACAO_ESPECIFICA)
values (75, 35)
insert [DBPMAS2015].[dbo].[TB_USUARIO_TIPO_SERVICOxSITUACAO_ESPECIFICA] (ID_USUARIO_TIPO_SERVICO, ID_SITUACAO_ESPECIFICA)
values (75, 36)
insert [DBPMAS2015].[dbo].[TB_USUARIO_TIPO_SERVICOxSITUACAO_ESPECIFICA] (ID_USUARIO_TIPO_SERVICO, ID_SITUACAO_ESPECIFICA)
values (75, 37)
insert [DBPMAS2015].[dbo].[TB_USUARIO_TIPO_SERVICOxSITUACAO_ESPECIFICA] (ID_USUARIO_TIPO_SERVICO, ID_SITUACAO_ESPECIFICA)
values (75, 42)


insert [DBPMAS2015].[dbo].[TB_USUARIO_TIPO_SERVICOxSITUACAO_ESPECIFICA] (ID_USUARIO_TIPO_SERVICO, ID_SITUACAO_ESPECIFICA)
values (76, 14)
insert [DBPMAS2015].[dbo].[TB_USUARIO_TIPO_SERVICOxSITUACAO_ESPECIFICA] (ID_USUARIO_TIPO_SERVICO, ID_SITUACAO_ESPECIFICA)
values (76, 15)
insert [DBPMAS2015].[dbo].[TB_USUARIO_TIPO_SERVICOxSITUACAO_ESPECIFICA] (ID_USUARIO_TIPO_SERVICO, ID_SITUACAO_ESPECIFICA)
values (76, 16)
insert [DBPMAS2015].[dbo].[TB_USUARIO_TIPO_SERVICOxSITUACAO_ESPECIFICA] (ID_USUARIO_TIPO_SERVICO, ID_SITUACAO_ESPECIFICA)
values (76, 17)
insert [DBPMAS2015].[dbo].[TB_USUARIO_TIPO_SERVICOxSITUACAO_ESPECIFICA] (ID_USUARIO_TIPO_SERVICO, ID_SITUACAO_ESPECIFICA)
values (76, 18)
insert [DBPMAS2015].[dbo].[TB_USUARIO_TIPO_SERVICOxSITUACAO_ESPECIFICA] (ID_USUARIO_TIPO_SERVICO, ID_SITUACAO_ESPECIFICA)
values (76, 19)
insert [DBPMAS2015].[dbo].[TB_USUARIO_TIPO_SERVICOxSITUACAO_ESPECIFICA] (ID_USUARIO_TIPO_SERVICO, ID_SITUACAO_ESPECIFICA)
values (76, 20)
insert [DBPMAS2015].[dbo].[TB_USUARIO_TIPO_SERVICOxSITUACAO_ESPECIFICA] (ID_USUARIO_TIPO_SERVICO, ID_SITUACAO_ESPECIFICA)
values (76, 6)
insert [DBPMAS2015].[dbo].[TB_USUARIO_TIPO_SERVICOxSITUACAO_ESPECIFICA] (ID_USUARIO_TIPO_SERVICO, ID_SITUACAO_ESPECIFICA)
values (76, 7)
insert [DBPMAS2015].[dbo].[TB_USUARIO_TIPO_SERVICOxSITUACAO_ESPECIFICA] (ID_USUARIO_TIPO_SERVICO, ID_SITUACAO_ESPECIFICA)
values (76, 8)
insert [DBPMAS2015].[dbo].[TB_USUARIO_TIPO_SERVICOxSITUACAO_ESPECIFICA] (ID_USUARIO_TIPO_SERVICO, ID_SITUACAO_ESPECIFICA)
values (76, 26)
insert [DBPMAS2015].[dbo].[TB_USUARIO_TIPO_SERVICOxSITUACAO_ESPECIFICA] (ID_USUARIO_TIPO_SERVICO, ID_SITUACAO_ESPECIFICA)
values (76, 27)
insert [DBPMAS2015].[dbo].[TB_USUARIO_TIPO_SERVICOxSITUACAO_ESPECIFICA] (ID_USUARIO_TIPO_SERVICO, ID_SITUACAO_ESPECIFICA)
values (76, 10)
insert [DBPMAS2015].[dbo].[TB_USUARIO_TIPO_SERVICOxSITUACAO_ESPECIFICA] (ID_USUARIO_TIPO_SERVICO, ID_SITUACAO_ESPECIFICA)
values (76, 13)
insert [DBPMAS2015].[dbo].[TB_USUARIO_TIPO_SERVICOxSITUACAO_ESPECIFICA] (ID_USUARIO_TIPO_SERVICO, ID_SITUACAO_ESPECIFICA)
values (76, 23)
insert [DBPMAS2015].[dbo].[TB_USUARIO_TIPO_SERVICOxSITUACAO_ESPECIFICA] (ID_USUARIO_TIPO_SERVICO, ID_SITUACAO_ESPECIFICA)
values (76, 24)
insert [DBPMAS2015].[dbo].[TB_USUARIO_TIPO_SERVICOxSITUACAO_ESPECIFICA] (ID_USUARIO_TIPO_SERVICO, ID_SITUACAO_ESPECIFICA)
values (76, 35)
insert [DBPMAS2015].[dbo].[TB_USUARIO_TIPO_SERVICOxSITUACAO_ESPECIFICA] (ID_USUARIO_TIPO_SERVICO, ID_SITUACAO_ESPECIFICA)
values (76, 36)
insert [DBPMAS2015].[dbo].[TB_USUARIO_TIPO_SERVICOxSITUACAO_ESPECIFICA] (ID_USUARIO_TIPO_SERVICO, ID_SITUACAO_ESPECIFICA)
values (76, 37)
insert [DBPMAS2015].[dbo].[TB_USUARIO_TIPO_SERVICOxSITUACAO_ESPECIFICA] (ID_USUARIO_TIPO_SERVICO, ID_SITUACAO_ESPECIFICA)
values (76, 42)


insert [DBPMAS2015].[dbo].[TB_USUARIO_TIPO_SERVICOxSITUACAO_ESPECIFICA] (ID_USUARIO_TIPO_SERVICO, ID_SITUACAO_ESPECIFICA)
values (77, 14)
insert [DBPMAS2015].[dbo].[TB_USUARIO_TIPO_SERVICOxSITUACAO_ESPECIFICA] (ID_USUARIO_TIPO_SERVICO, ID_SITUACAO_ESPECIFICA)
values (77, 15)
insert [DBPMAS2015].[dbo].[TB_USUARIO_TIPO_SERVICOxSITUACAO_ESPECIFICA] (ID_USUARIO_TIPO_SERVICO, ID_SITUACAO_ESPECIFICA)
values (77, 16)
insert [DBPMAS2015].[dbo].[TB_USUARIO_TIPO_SERVICOxSITUACAO_ESPECIFICA] (ID_USUARIO_TIPO_SERVICO, ID_SITUACAO_ESPECIFICA)
values (77, 17)
insert [DBPMAS2015].[dbo].[TB_USUARIO_TIPO_SERVICOxSITUACAO_ESPECIFICA] (ID_USUARIO_TIPO_SERVICO, ID_SITUACAO_ESPECIFICA)
values (77, 18)
insert [DBPMAS2015].[dbo].[TB_USUARIO_TIPO_SERVICOxSITUACAO_ESPECIFICA] (ID_USUARIO_TIPO_SERVICO, ID_SITUACAO_ESPECIFICA)
values (77, 19)
insert [DBPMAS2015].[dbo].[TB_USUARIO_TIPO_SERVICOxSITUACAO_ESPECIFICA] (ID_USUARIO_TIPO_SERVICO, ID_SITUACAO_ESPECIFICA)
values (77, 20)
insert [DBPMAS2015].[dbo].[TB_USUARIO_TIPO_SERVICOxSITUACAO_ESPECIFICA] (ID_USUARIO_TIPO_SERVICO, ID_SITUACAO_ESPECIFICA)
values (77, 6)
insert [DBPMAS2015].[dbo].[TB_USUARIO_TIPO_SERVICOxSITUACAO_ESPECIFICA] (ID_USUARIO_TIPO_SERVICO, ID_SITUACAO_ESPECIFICA)
values (77, 7)
insert [DBPMAS2015].[dbo].[TB_USUARIO_TIPO_SERVICOxSITUACAO_ESPECIFICA] (ID_USUARIO_TIPO_SERVICO, ID_SITUACAO_ESPECIFICA)
values (77, 8)
insert [DBPMAS2015].[dbo].[TB_USUARIO_TIPO_SERVICOxSITUACAO_ESPECIFICA] (ID_USUARIO_TIPO_SERVICO, ID_SITUACAO_ESPECIFICA)
values (77, 26)
insert [DBPMAS2015].[dbo].[TB_USUARIO_TIPO_SERVICOxSITUACAO_ESPECIFICA] (ID_USUARIO_TIPO_SERVICO, ID_SITUACAO_ESPECIFICA)
values (77, 27)
insert [DBPMAS2015].[dbo].[TB_USUARIO_TIPO_SERVICOxSITUACAO_ESPECIFICA] (ID_USUARIO_TIPO_SERVICO, ID_SITUACAO_ESPECIFICA)
values (77, 10)
insert [DBPMAS2015].[dbo].[TB_USUARIO_TIPO_SERVICOxSITUACAO_ESPECIFICA] (ID_USUARIO_TIPO_SERVICO, ID_SITUACAO_ESPECIFICA)
values (77, 13)
insert [DBPMAS2015].[dbo].[TB_USUARIO_TIPO_SERVICOxSITUACAO_ESPECIFICA] (ID_USUARIO_TIPO_SERVICO, ID_SITUACAO_ESPECIFICA)
values (77, 23)
insert [DBPMAS2015].[dbo].[TB_USUARIO_TIPO_SERVICOxSITUACAO_ESPECIFICA] (ID_USUARIO_TIPO_SERVICO, ID_SITUACAO_ESPECIFICA)
values (77, 24)
insert [DBPMAS2015].[dbo].[TB_USUARIO_TIPO_SERVICOxSITUACAO_ESPECIFICA] (ID_USUARIO_TIPO_SERVICO, ID_SITUACAO_ESPECIFICA)
values (77, 35)
insert [DBPMAS2015].[dbo].[TB_USUARIO_TIPO_SERVICOxSITUACAO_ESPECIFICA] (ID_USUARIO_TIPO_SERVICO, ID_SITUACAO_ESPECIFICA)
values (77, 36)
insert [DBPMAS2015].[dbo].[TB_USUARIO_TIPO_SERVICOxSITUACAO_ESPECIFICA] (ID_USUARIO_TIPO_SERVICO, ID_SITUACAO_ESPECIFICA)
values (77, 37)
insert [DBPMAS2015].[dbo].[TB_USUARIO_TIPO_SERVICOxSITUACAO_ESPECIFICA] (ID_USUARIO_TIPO_SERVICO, ID_SITUACAO_ESPECIFICA)
values (77, 42)


insert [DBPMAS2015].[dbo].[TB_USUARIO_TIPO_SERVICOxSITUACAO_ESPECIFICA] (ID_USUARIO_TIPO_SERVICO, ID_SITUACAO_ESPECIFICA)
values (78, 14)
insert [DBPMAS2015].[dbo].[TB_USUARIO_TIPO_SERVICOxSITUACAO_ESPECIFICA] (ID_USUARIO_TIPO_SERVICO, ID_SITUACAO_ESPECIFICA)
values (78, 15)
insert [DBPMAS2015].[dbo].[TB_USUARIO_TIPO_SERVICOxSITUACAO_ESPECIFICA] (ID_USUARIO_TIPO_SERVICO, ID_SITUACAO_ESPECIFICA)
values (78, 16)
insert [DBPMAS2015].[dbo].[TB_USUARIO_TIPO_SERVICOxSITUACAO_ESPECIFICA] (ID_USUARIO_TIPO_SERVICO, ID_SITUACAO_ESPECIFICA)
values (78, 17)
insert [DBPMAS2015].[dbo].[TB_USUARIO_TIPO_SERVICOxSITUACAO_ESPECIFICA] (ID_USUARIO_TIPO_SERVICO, ID_SITUACAO_ESPECIFICA)
values (78, 18)
insert [DBPMAS2015].[dbo].[TB_USUARIO_TIPO_SERVICOxSITUACAO_ESPECIFICA] (ID_USUARIO_TIPO_SERVICO, ID_SITUACAO_ESPECIFICA)
values (78, 19)
insert [DBPMAS2015].[dbo].[TB_USUARIO_TIPO_SERVICOxSITUACAO_ESPECIFICA] (ID_USUARIO_TIPO_SERVICO, ID_SITUACAO_ESPECIFICA)
values (78, 20)
insert [DBPMAS2015].[dbo].[TB_USUARIO_TIPO_SERVICOxSITUACAO_ESPECIFICA] (ID_USUARIO_TIPO_SERVICO, ID_SITUACAO_ESPECIFICA)
values (78, 6)
insert [DBPMAS2015].[dbo].[TB_USUARIO_TIPO_SERVICOxSITUACAO_ESPECIFICA] (ID_USUARIO_TIPO_SERVICO, ID_SITUACAO_ESPECIFICA)
values (78, 7)
insert [DBPMAS2015].[dbo].[TB_USUARIO_TIPO_SERVICOxSITUACAO_ESPECIFICA] (ID_USUARIO_TIPO_SERVICO, ID_SITUACAO_ESPECIFICA)
values (78, 8)
insert [DBPMAS2015].[dbo].[TB_USUARIO_TIPO_SERVICOxSITUACAO_ESPECIFICA] (ID_USUARIO_TIPO_SERVICO, ID_SITUACAO_ESPECIFICA)
values (78, 26)
insert [DBPMAS2015].[dbo].[TB_USUARIO_TIPO_SERVICOxSITUACAO_ESPECIFICA] (ID_USUARIO_TIPO_SERVICO, ID_SITUACAO_ESPECIFICA)
values (78, 27)
insert [DBPMAS2015].[dbo].[TB_USUARIO_TIPO_SERVICOxSITUACAO_ESPECIFICA] (ID_USUARIO_TIPO_SERVICO, ID_SITUACAO_ESPECIFICA)
values (78, 10)
insert [DBPMAS2015].[dbo].[TB_USUARIO_TIPO_SERVICOxSITUACAO_ESPECIFICA] (ID_USUARIO_TIPO_SERVICO, ID_SITUACAO_ESPECIFICA)
values (78, 13)
insert [DBPMAS2015].[dbo].[TB_USUARIO_TIPO_SERVICOxSITUACAO_ESPECIFICA] (ID_USUARIO_TIPO_SERVICO, ID_SITUACAO_ESPECIFICA)
values (78, 23)
insert [DBPMAS2015].[dbo].[TB_USUARIO_TIPO_SERVICOxSITUACAO_ESPECIFICA] (ID_USUARIO_TIPO_SERVICO, ID_SITUACAO_ESPECIFICA)
values (78, 24)
insert [DBPMAS2015].[dbo].[TB_USUARIO_TIPO_SERVICOxSITUACAO_ESPECIFICA] (ID_USUARIO_TIPO_SERVICO, ID_SITUACAO_ESPECIFICA)
values (78, 35)
insert [DBPMAS2015].[dbo].[TB_USUARIO_TIPO_SERVICOxSITUACAO_ESPECIFICA] (ID_USUARIO_TIPO_SERVICO, ID_SITUACAO_ESPECIFICA)
values (78, 36)
insert [DBPMAS2015].[dbo].[TB_USUARIO_TIPO_SERVICOxSITUACAO_ESPECIFICA] (ID_USUARIO_TIPO_SERVICO, ID_SITUACAO_ESPECIFICA)
values (78, 37)
insert [DBPMAS2015].[dbo].[TB_USUARIO_TIPO_SERVICOxSITUACAO_ESPECIFICA] (ID_USUARIO_TIPO_SERVICO, ID_SITUACAO_ESPECIFICA)
values (78, 42)


SELECT [ID_USUARIO_TIPO_SERVICO]
      ,[ID_SITUACAO_ESPECIFICA]
into #temp
FROM [DBPMAS2015].[dbo].[TB_USUARIO_TIPO_SERVICOxSITUACAO_ESPECIFICA] where id_usuario_tipo_servico in (11,12,13,14,15,16,17,62)

update #temp set id_usuario_tipo_servico = 79 where id_usuario_tipo_servico = 11
update #temp set id_usuario_tipo_servico = 80 where id_usuario_tipo_servico = 12
update #temp set id_usuario_tipo_servico = 81 where id_usuario_tipo_servico = 13
update #temp set id_usuario_tipo_servico = 82 where id_usuario_tipo_servico = 14
update #temp set id_usuario_tipo_servico = 83 where id_usuario_tipo_servico = 15
update #temp set id_usuario_tipo_servico = 84 where id_usuario_tipo_servico = 16
update #temp set id_usuario_tipo_servico = 85 where id_usuario_tipo_servico = 17
update #temp set id_usuario_tipo_servico = 86 where id_usuario_tipo_servico = 62

declare @cur cursor
declare @usu int
declare @sit int
set @cur = cursor for select id_usuario_tipo_servico, id_situacao_especifica from #temp
open @cur
fetch next from @cur into @usu, @sit;
while @@fetch_status = 0
begin
	insert [DBPMAS2015].[dbo].[TB_USUARIO_TIPO_SERVICOxSITUACAO_ESPECIFICA] (id_usuario_tipo_servico, id_situacao_especifica) values (@usu, @sit)
	fetch next from @cur into @usu, @sit;
end
close @cur
deallocate @cur

drop table #temp


SELECT [ID_USUARIO_TIPO_SERVICO]
      ,[ID_SITUACAO_ESPECIFICA]
into #temp
FROM [DBPMAS2015].[dbo].[TB_USUARIO_TIPO_SERVICOxSITUACAO_ESPECIFICA] where id_usuario_tipo_servico in (30,31,32,33,34,35,36,63)

update #temp set id_usuario_tipo_servico = 87 where id_usuario_tipo_servico = 30
update #temp set id_usuario_tipo_servico = 88 where id_usuario_tipo_servico = 31
update #temp set id_usuario_tipo_servico = 89 where id_usuario_tipo_servico = 32
update #temp set id_usuario_tipo_servico = 90 where id_usuario_tipo_servico = 33
update #temp set id_usuario_tipo_servico = 91 where id_usuario_tipo_servico = 34
update #temp set id_usuario_tipo_servico = 92 where id_usuario_tipo_servico = 35
update #temp set id_usuario_tipo_servico = 93 where id_usuario_tipo_servico = 36
update #temp set id_usuario_tipo_servico = 94 where id_usuario_tipo_servico = 63

declare @cur cursor
declare @usu int
declare @sit int
set @cur = cursor for select id_usuario_tipo_servico, id_situacao_especifica from #temp
open @cur
fetch next from @cur into @usu, @sit;
while @@fetch_status = 0
begin
	insert [DBPMAS2015].[dbo].[TB_USUARIO_TIPO_SERVICOxSITUACAO_ESPECIFICA] (id_usuario_tipo_servico, id_situacao_especifica) values (@usu, @sit)
	fetch next from @cur into @usu, @sit;
end
close @cur
deallocate @cur

drop table #temp





insert [DBPMAS2015].[dbo].[TB_ATIVIDADE_SOCIOASSISTENCIAL] (ID, NOME)
values (43, 'Atividades intergeracionais')

insert [DBPMAS2015].[dbo].[TB_ATIVIDADE_SOCIOASSISTENCIAL] (ID, NOME)
values (44, 'Cursos profissionalizantes')

insert [DBPMAS2015].[dbo].[TB_ATIVIDADE_SOCIOASSISTENCIAL] (ID, NOME)
values (45, 'Iniciação profissional conforme Lei 10.097/2000')

insert [DBPMAS2015].[dbo].[TB_ATIVIDADE_SOCIOASSISTENCIAL] (ID, NOME)
values (46, 'Qualificação e/ou requalificação profissional')

insert [DBPMAS2015].[dbo].[TB_ATIVIDADE_SOCIOASSISTENCIAL] (ID, NOME)
values (47, 'Inserção no mercado de trabalho')

insert [DBPMAS2015].[dbo].[TB_ATIVIDADE_SOCIOASSISTENCIAL] (ID, NOME)
values (48, 'Inserção em projetos ou programas de inclusão produtiva')


insert [DBPMAS2015].[dbo].[TB_ATIVIDADE_SOCIOASSISTENCIALxTIPO_SERVICO] (ID_ATIVIDADE_SOCIOASSISTENCIAL, ID_TIPO_SERVICO)
values(20, 136)
insert [DBPMAS2015].[dbo].[TB_ATIVIDADE_SOCIOASSISTENCIALxTIPO_SERVICO] (ID_ATIVIDADE_SOCIOASSISTENCIAL, ID_TIPO_SERVICO)
values(43, 136)
insert [DBPMAS2015].[dbo].[TB_ATIVIDADE_SOCIOASSISTENCIALxTIPO_SERVICO] (ID_ATIVIDADE_SOCIOASSISTENCIAL, ID_TIPO_SERVICO)
values(44, 136)
insert [DBPMAS2015].[dbo].[TB_ATIVIDADE_SOCIOASSISTENCIALxTIPO_SERVICO] (ID_ATIVIDADE_SOCIOASSISTENCIAL, ID_TIPO_SERVICO)
values(46, 136)

insert [DBPMAS2015].[dbo].[TB_ATIVIDADE_SOCIOASSISTENCIALxTIPO_SERVICO] (ID_ATIVIDADE_SOCIOASSISTENCIAL, ID_TIPO_SERVICO)
values(43, 145)
insert [DBPMAS2015].[dbo].[TB_ATIVIDADE_SOCIOASSISTENCIALxTIPO_SERVICO] (ID_ATIVIDADE_SOCIOASSISTENCIAL, ID_TIPO_SERVICO)
values(44, 145)
insert [DBPMAS2015].[dbo].[TB_ATIVIDADE_SOCIOASSISTENCIALxTIPO_SERVICO] (ID_ATIVIDADE_SOCIOASSISTENCIAL, ID_TIPO_SERVICO)
values(45, 145)
insert [DBPMAS2015].[dbo].[TB_ATIVIDADE_SOCIOASSISTENCIALxTIPO_SERVICO] (ID_ATIVIDADE_SOCIOASSISTENCIAL, ID_TIPO_SERVICO)
values(46, 145)
insert [DBPMAS2015].[dbo].[TB_ATIVIDADE_SOCIOASSISTENCIALxTIPO_SERVICO] (ID_ATIVIDADE_SOCIOASSISTENCIAL, ID_TIPO_SERVICO)
values(47, 145)
insert [DBPMAS2015].[dbo].[TB_ATIVIDADE_SOCIOASSISTENCIALxTIPO_SERVICO] (ID_ATIVIDADE_SOCIOASSISTENCIAL, ID_TIPO_SERVICO)
values(48, 145)

insert [DBPMAS2015].[dbo].[TB_ATIVIDADE_SOCIOASSISTENCIALxTIPO_SERVICO] (ID_ATIVIDADE_SOCIOASSISTENCIAL, ID_TIPO_SERVICO)
values(1, 154)
insert [DBPMAS2015].[dbo].[TB_ATIVIDADE_SOCIOASSISTENCIALxTIPO_SERVICO] (ID_ATIVIDADE_SOCIOASSISTENCIAL, ID_TIPO_SERVICO)
values(2, 154)
insert [DBPMAS2015].[dbo].[TB_ATIVIDADE_SOCIOASSISTENCIALxTIPO_SERVICO] (ID_ATIVIDADE_SOCIOASSISTENCIAL, ID_TIPO_SERVICO)
values(3, 154)
insert [DBPMAS2015].[dbo].[TB_ATIVIDADE_SOCIOASSISTENCIALxTIPO_SERVICO] (ID_ATIVIDADE_SOCIOASSISTENCIAL, ID_TIPO_SERVICO)
values(4, 154)
insert [DBPMAS2015].[dbo].[TB_ATIVIDADE_SOCIOASSISTENCIALxTIPO_SERVICO] (ID_ATIVIDADE_SOCIOASSISTENCIAL, ID_TIPO_SERVICO)
values(5, 154)
insert [DBPMAS2015].[dbo].[TB_ATIVIDADE_SOCIOASSISTENCIALxTIPO_SERVICO] (ID_ATIVIDADE_SOCIOASSISTENCIAL, ID_TIPO_SERVICO)
values(7, 154)
insert [DBPMAS2015].[dbo].[TB_ATIVIDADE_SOCIOASSISTENCIALxTIPO_SERVICO] (ID_ATIVIDADE_SOCIOASSISTENCIAL, ID_TIPO_SERVICO)
values(8, 154)
insert [DBPMAS2015].[dbo].[TB_ATIVIDADE_SOCIOASSISTENCIALxTIPO_SERVICO] (ID_ATIVIDADE_SOCIOASSISTENCIAL, ID_TIPO_SERVICO)
values(11, 154)
insert [DBPMAS2015].[dbo].[TB_ATIVIDADE_SOCIOASSISTENCIALxTIPO_SERVICO] (ID_ATIVIDADE_SOCIOASSISTENCIAL, ID_TIPO_SERVICO)
values(12, 154)
insert [DBPMAS2015].[dbo].[TB_ATIVIDADE_SOCIOASSISTENCIALxTIPO_SERVICO] (ID_ATIVIDADE_SOCIOASSISTENCIAL, ID_TIPO_SERVICO)
values(13, 154)
insert [DBPMAS2015].[dbo].[TB_ATIVIDADE_SOCIOASSISTENCIALxTIPO_SERVICO] (ID_ATIVIDADE_SOCIOASSISTENCIAL, ID_TIPO_SERVICO)
values(14, 154)
insert [DBPMAS2015].[dbo].[TB_ATIVIDADE_SOCIOASSISTENCIALxTIPO_SERVICO] (ID_ATIVIDADE_SOCIOASSISTENCIAL, ID_TIPO_SERVICO)
values(15, 154)
insert [DBPMAS2015].[dbo].[TB_ATIVIDADE_SOCIOASSISTENCIALxTIPO_SERVICO] (ID_ATIVIDADE_SOCIOASSISTENCIAL, ID_TIPO_SERVICO)
values(16, 154)
insert [DBPMAS2015].[dbo].[TB_ATIVIDADE_SOCIOASSISTENCIALxTIPO_SERVICO] (ID_ATIVIDADE_SOCIOASSISTENCIAL, ID_TIPO_SERVICO)
values(17, 154)
insert [DBPMAS2015].[dbo].[TB_ATIVIDADE_SOCIOASSISTENCIALxTIPO_SERVICO] (ID_ATIVIDADE_SOCIOASSISTENCIAL, ID_TIPO_SERVICO)
values(19, 154)
insert [DBPMAS2015].[dbo].[TB_ATIVIDADE_SOCIOASSISTENCIALxTIPO_SERVICO] (ID_ATIVIDADE_SOCIOASSISTENCIAL, ID_TIPO_SERVICO)
values(21, 154)
insert [DBPMAS2015].[dbo].[TB_ATIVIDADE_SOCIOASSISTENCIALxTIPO_SERVICO] (ID_ATIVIDADE_SOCIOASSISTENCIAL, ID_TIPO_SERVICO)
values(22, 154)
insert [DBPMAS2015].[dbo].[TB_ATIVIDADE_SOCIOASSISTENCIALxTIPO_SERVICO] (ID_ATIVIDADE_SOCIOASSISTENCIAL, ID_TIPO_SERVICO)
values(23, 154)
insert [DBPMAS2015].[dbo].[TB_ATIVIDADE_SOCIOASSISTENCIALxTIPO_SERVICO] (ID_ATIVIDADE_SOCIOASSISTENCIAL, ID_TIPO_SERVICO)
values(26, 154)
insert [DBPMAS2015].[dbo].[TB_ATIVIDADE_SOCIOASSISTENCIALxTIPO_SERVICO] (ID_ATIVIDADE_SOCIOASSISTENCIAL, ID_TIPO_SERVICO)
values(27, 154)
insert [DBPMAS2015].[dbo].[TB_ATIVIDADE_SOCIOASSISTENCIALxTIPO_SERVICO] (ID_ATIVIDADE_SOCIOASSISTENCIAL, ID_TIPO_SERVICO)
values(28, 154)
insert [DBPMAS2015].[dbo].[TB_ATIVIDADE_SOCIOASSISTENCIALxTIPO_SERVICO] (ID_ATIVIDADE_SOCIOASSISTENCIAL, ID_TIPO_SERVICO)
values(29, 154)
insert [DBPMAS2015].[dbo].[TB_ATIVIDADE_SOCIOASSISTENCIALxTIPO_SERVICO] (ID_ATIVIDADE_SOCIOASSISTENCIAL, ID_TIPO_SERVICO)
values(30, 154)
insert [DBPMAS2015].[dbo].[TB_ATIVIDADE_SOCIOASSISTENCIALxTIPO_SERVICO] (ID_ATIVIDADE_SOCIOASSISTENCIAL, ID_TIPO_SERVICO)
values(31, 154)
insert [DBPMAS2015].[dbo].[TB_ATIVIDADE_SOCIOASSISTENCIALxTIPO_SERVICO] (ID_ATIVIDADE_SOCIOASSISTENCIAL, ID_TIPO_SERVICO)
values(32, 154)
insert [DBPMAS2015].[dbo].[TB_ATIVIDADE_SOCIOASSISTENCIALxTIPO_SERVICO] (ID_ATIVIDADE_SOCIOASSISTENCIAL, ID_TIPO_SERVICO)
values(33, 154)
insert [DBPMAS2015].[dbo].[TB_ATIVIDADE_SOCIOASSISTENCIALxTIPO_SERVICO] (ID_ATIVIDADE_SOCIOASSISTENCIAL, ID_TIPO_SERVICO)
values(34, 154)
insert [DBPMAS2015].[dbo].[TB_ATIVIDADE_SOCIOASSISTENCIALxTIPO_SERVICO] (ID_ATIVIDADE_SOCIOASSISTENCIAL, ID_TIPO_SERVICO)
values(35, 154)
insert [DBPMAS2015].[dbo].[TB_ATIVIDADE_SOCIOASSISTENCIALxTIPO_SERVICO] (ID_ATIVIDADE_SOCIOASSISTENCIAL, ID_TIPO_SERVICO)
values(36, 154)
insert [DBPMAS2015].[dbo].[TB_ATIVIDADE_SOCIOASSISTENCIALxTIPO_SERVICO] (ID_ATIVIDADE_SOCIOASSISTENCIAL, ID_TIPO_SERVICO)
values(38, 154)
insert [DBPMAS2015].[dbo].[TB_ATIVIDADE_SOCIOASSISTENCIALxTIPO_SERVICO] (ID_ATIVIDADE_SOCIOASSISTENCIAL, ID_TIPO_SERVICO)
values(39, 154)
insert [DBPMAS2015].[dbo].[TB_ATIVIDADE_SOCIOASSISTENCIALxTIPO_SERVICO] (ID_ATIVIDADE_SOCIOASSISTENCIAL, ID_TIPO_SERVICO)
values(40, 154)

insert [DBPMAS2015].[dbo].[TB_ATIVIDADE_SOCIOASSISTENCIALxTIPO_SERVICO] (ID_ATIVIDADE_SOCIOASSISTENCIAL, ID_TIPO_SERVICO)
values(1, 155)
insert [DBPMAS2015].[dbo].[TB_ATIVIDADE_SOCIOASSISTENCIALxTIPO_SERVICO] (ID_ATIVIDADE_SOCIOASSISTENCIAL, ID_TIPO_SERVICO)
values(8, 155)
insert [DBPMAS2015].[dbo].[TB_ATIVIDADE_SOCIOASSISTENCIALxTIPO_SERVICO] (ID_ATIVIDADE_SOCIOASSISTENCIAL, ID_TIPO_SERVICO)
values(9, 155)
insert [DBPMAS2015].[dbo].[TB_ATIVIDADE_SOCIOASSISTENCIALxTIPO_SERVICO] (ID_ATIVIDADE_SOCIOASSISTENCIAL, ID_TIPO_SERVICO)
values(11, 155)
insert [DBPMAS2015].[dbo].[TB_ATIVIDADE_SOCIOASSISTENCIALxTIPO_SERVICO] (ID_ATIVIDADE_SOCIOASSISTENCIAL, ID_TIPO_SERVICO)
values(28, 155)
insert [DBPMAS2015].[dbo].[TB_ATIVIDADE_SOCIOASSISTENCIALxTIPO_SERVICO] (ID_ATIVIDADE_SOCIOASSISTENCIAL, ID_TIPO_SERVICO)
values(35, 155)
insert [DBPMAS2015].[dbo].[TB_ATIVIDADE_SOCIOASSISTENCIALxTIPO_SERVICO] (ID_ATIVIDADE_SOCIOASSISTENCIAL, ID_TIPO_SERVICO)
values(36, 155)
insert [DBPMAS2015].[dbo].[TB_ATIVIDADE_SOCIOASSISTENCIALxTIPO_SERVICO] (ID_ATIVIDADE_SOCIOASSISTENCIAL, ID_TIPO_SERVICO)
values(38, 155)
insert [DBPMAS2015].[dbo].[TB_ATIVIDADE_SOCIOASSISTENCIALxTIPO_SERVICO] (ID_ATIVIDADE_SOCIOASSISTENCIAL, ID_TIPO_SERVICO)
values(40, 155)
insert [DBPMAS2015].[dbo].[TB_ATIVIDADE_SOCIOASSISTENCIALxTIPO_SERVICO] (ID_ATIVIDADE_SOCIOASSISTENCIAL, ID_TIPO_SERVICO)
values(41, 155)
insert [DBPMAS2015].[dbo].[TB_ATIVIDADE_SOCIOASSISTENCIALxTIPO_SERVICO] (ID_ATIVIDADE_SOCIOASSISTENCIAL, ID_TIPO_SERVICO)
values(44, 155)
insert [DBPMAS2015].[dbo].[TB_ATIVIDADE_SOCIOASSISTENCIALxTIPO_SERVICO] (ID_ATIVIDADE_SOCIOASSISTENCIAL, ID_TIPO_SERVICO)
values(45, 155)
insert [DBPMAS2015].[dbo].[TB_ATIVIDADE_SOCIOASSISTENCIALxTIPO_SERVICO] (ID_ATIVIDADE_SOCIOASSISTENCIAL, ID_TIPO_SERVICO)
values(46, 155)
insert [DBPMAS2015].[dbo].[TB_ATIVIDADE_SOCIOASSISTENCIALxTIPO_SERVICO] (ID_ATIVIDADE_SOCIOASSISTENCIAL, ID_TIPO_SERVICO)
values(47, 155)
insert [DBPMAS2015].[dbo].[TB_ATIVIDADE_SOCIOASSISTENCIALxTIPO_SERVICO] (ID_ATIVIDADE_SOCIOASSISTENCIAL, ID_TIPO_SERVICO)
values(48, 155)

insert [DBPMAS2015].[dbo].[TB_ATIVIDADE_SOCIOASSISTENCIALxTIPO_SERVICO] (ID_ATIVIDADE_SOCIOASSISTENCIAL, ID_TIPO_SERVICO)
values(1, 156)
insert [DBPMAS2015].[dbo].[TB_ATIVIDADE_SOCIOASSISTENCIALxTIPO_SERVICO] (ID_ATIVIDADE_SOCIOASSISTENCIAL, ID_TIPO_SERVICO)
values(2, 156)
insert [DBPMAS2015].[dbo].[TB_ATIVIDADE_SOCIOASSISTENCIALxTIPO_SERVICO] (ID_ATIVIDADE_SOCIOASSISTENCIAL, ID_TIPO_SERVICO)
values(3, 156)
insert [DBPMAS2015].[dbo].[TB_ATIVIDADE_SOCIOASSISTENCIALxTIPO_SERVICO] (ID_ATIVIDADE_SOCIOASSISTENCIAL, ID_TIPO_SERVICO)
values(4, 156)
insert [DBPMAS2015].[dbo].[TB_ATIVIDADE_SOCIOASSISTENCIALxTIPO_SERVICO] (ID_ATIVIDADE_SOCIOASSISTENCIAL, ID_TIPO_SERVICO)
values(5, 156)
insert [DBPMAS2015].[dbo].[TB_ATIVIDADE_SOCIOASSISTENCIALxTIPO_SERVICO] (ID_ATIVIDADE_SOCIOASSISTENCIAL, ID_TIPO_SERVICO)
values(6, 156)
insert [DBPMAS2015].[dbo].[TB_ATIVIDADE_SOCIOASSISTENCIALxTIPO_SERVICO] (ID_ATIVIDADE_SOCIOASSISTENCIAL, ID_TIPO_SERVICO)
values(7, 156)
insert [DBPMAS2015].[dbo].[TB_ATIVIDADE_SOCIOASSISTENCIALxTIPO_SERVICO] (ID_ATIVIDADE_SOCIOASSISTENCIAL, ID_TIPO_SERVICO)
values(8, 156)
insert [DBPMAS2015].[dbo].[TB_ATIVIDADE_SOCIOASSISTENCIALxTIPO_SERVICO] (ID_ATIVIDADE_SOCIOASSISTENCIAL, ID_TIPO_SERVICO)
values(11, 156)
insert [DBPMAS2015].[dbo].[TB_ATIVIDADE_SOCIOASSISTENCIALxTIPO_SERVICO] (ID_ATIVIDADE_SOCIOASSISTENCIAL, ID_TIPO_SERVICO)
values(12, 156)
insert [DBPMAS2015].[dbo].[TB_ATIVIDADE_SOCIOASSISTENCIALxTIPO_SERVICO] (ID_ATIVIDADE_SOCIOASSISTENCIAL, ID_TIPO_SERVICO)
values(13, 156)
insert [DBPMAS2015].[dbo].[TB_ATIVIDADE_SOCIOASSISTENCIALxTIPO_SERVICO] (ID_ATIVIDADE_SOCIOASSISTENCIAL, ID_TIPO_SERVICO)
values(14, 156)
insert [DBPMAS2015].[dbo].[TB_ATIVIDADE_SOCIOASSISTENCIALxTIPO_SERVICO] (ID_ATIVIDADE_SOCIOASSISTENCIAL, ID_TIPO_SERVICO)
values(15, 156)
insert [DBPMAS2015].[dbo].[TB_ATIVIDADE_SOCIOASSISTENCIALxTIPO_SERVICO] (ID_ATIVIDADE_SOCIOASSISTENCIAL, ID_TIPO_SERVICO)
values(16, 156)
insert [DBPMAS2015].[dbo].[TB_ATIVIDADE_SOCIOASSISTENCIALxTIPO_SERVICO] (ID_ATIVIDADE_SOCIOASSISTENCIAL, ID_TIPO_SERVICO)
values(17, 156)
insert [DBPMAS2015].[dbo].[TB_ATIVIDADE_SOCIOASSISTENCIALxTIPO_SERVICO] (ID_ATIVIDADE_SOCIOASSISTENCIAL, ID_TIPO_SERVICO)
values(19, 156)
insert [DBPMAS2015].[dbo].[TB_ATIVIDADE_SOCIOASSISTENCIALxTIPO_SERVICO] (ID_ATIVIDADE_SOCIOASSISTENCIAL, ID_TIPO_SERVICO)
values(20, 156)
insert [DBPMAS2015].[dbo].[TB_ATIVIDADE_SOCIOASSISTENCIALxTIPO_SERVICO] (ID_ATIVIDADE_SOCIOASSISTENCIAL, ID_TIPO_SERVICO)
values(21, 156)
insert [DBPMAS2015].[dbo].[TB_ATIVIDADE_SOCIOASSISTENCIALxTIPO_SERVICO] (ID_ATIVIDADE_SOCIOASSISTENCIAL, ID_TIPO_SERVICO)
values(22, 156)
insert [DBPMAS2015].[dbo].[TB_ATIVIDADE_SOCIOASSISTENCIALxTIPO_SERVICO] (ID_ATIVIDADE_SOCIOASSISTENCIAL, ID_TIPO_SERVICO)
values(23, 156)
insert [DBPMAS2015].[dbo].[TB_ATIVIDADE_SOCIOASSISTENCIALxTIPO_SERVICO] (ID_ATIVIDADE_SOCIOASSISTENCIAL, ID_TIPO_SERVICO)
values(26, 156)
insert [DBPMAS2015].[dbo].[TB_ATIVIDADE_SOCIOASSISTENCIALxTIPO_SERVICO] (ID_ATIVIDADE_SOCIOASSISTENCIAL, ID_TIPO_SERVICO)
values(27, 156)
insert [DBPMAS2015].[dbo].[TB_ATIVIDADE_SOCIOASSISTENCIALxTIPO_SERVICO] (ID_ATIVIDADE_SOCIOASSISTENCIAL, ID_TIPO_SERVICO)
values(28, 156)
insert [DBPMAS2015].[dbo].[TB_ATIVIDADE_SOCIOASSISTENCIALxTIPO_SERVICO] (ID_ATIVIDADE_SOCIOASSISTENCIAL, ID_TIPO_SERVICO)
values(29, 156)
insert [DBPMAS2015].[dbo].[TB_ATIVIDADE_SOCIOASSISTENCIALxTIPO_SERVICO] (ID_ATIVIDADE_SOCIOASSISTENCIAL, ID_TIPO_SERVICO)
values(30, 156)
insert [DBPMAS2015].[dbo].[TB_ATIVIDADE_SOCIOASSISTENCIALxTIPO_SERVICO] (ID_ATIVIDADE_SOCIOASSISTENCIAL, ID_TIPO_SERVICO)
values(31, 156)
insert [DBPMAS2015].[dbo].[TB_ATIVIDADE_SOCIOASSISTENCIALxTIPO_SERVICO] (ID_ATIVIDADE_SOCIOASSISTENCIAL, ID_TIPO_SERVICO)
values(32, 156)
insert [DBPMAS2015].[dbo].[TB_ATIVIDADE_SOCIOASSISTENCIALxTIPO_SERVICO] (ID_ATIVIDADE_SOCIOASSISTENCIAL, ID_TIPO_SERVICO)
values(33, 156)
insert [DBPMAS2015].[dbo].[TB_ATIVIDADE_SOCIOASSISTENCIALxTIPO_SERVICO] (ID_ATIVIDADE_SOCIOASSISTENCIAL, ID_TIPO_SERVICO)
values(34, 156)
insert [DBPMAS2015].[dbo].[TB_ATIVIDADE_SOCIOASSISTENCIALxTIPO_SERVICO] (ID_ATIVIDADE_SOCIOASSISTENCIAL, ID_TIPO_SERVICO)
values(35, 156)
insert [DBPMAS2015].[dbo].[TB_ATIVIDADE_SOCIOASSISTENCIALxTIPO_SERVICO] (ID_ATIVIDADE_SOCIOASSISTENCIAL, ID_TIPO_SERVICO)
values(36, 156)
insert [DBPMAS2015].[dbo].[TB_ATIVIDADE_SOCIOASSISTENCIALxTIPO_SERVICO] (ID_ATIVIDADE_SOCIOASSISTENCIAL, ID_TIPO_SERVICO)
values(37, 156)
insert [DBPMAS2015].[dbo].[TB_ATIVIDADE_SOCIOASSISTENCIALxTIPO_SERVICO] (ID_ATIVIDADE_SOCIOASSISTENCIAL, ID_TIPO_SERVICO)
values(38, 156)
insert [DBPMAS2015].[dbo].[TB_ATIVIDADE_SOCIOASSISTENCIALxTIPO_SERVICO] (ID_ATIVIDADE_SOCIOASSISTENCIAL, ID_TIPO_SERVICO)
values(39, 156)
insert [DBPMAS2015].[dbo].[TB_ATIVIDADE_SOCIOASSISTENCIALxTIPO_SERVICO] (ID_ATIVIDADE_SOCIOASSISTENCIAL, ID_TIPO_SERVICO)
values(40, 156)
insert [DBPMAS2015].[dbo].[TB_ATIVIDADE_SOCIOASSISTENCIALxTIPO_SERVICO] (ID_ATIVIDADE_SOCIOASSISTENCIAL, ID_TIPO_SERVICO)
values(41, 156)
insert [DBPMAS2015].[dbo].[TB_ATIVIDADE_SOCIOASSISTENCIALxTIPO_SERVICO] (ID_ATIVIDADE_SOCIOASSISTENCIAL, ID_TIPO_SERVICO)
values(42, 156)
insert [DBPMAS2015].[dbo].[TB_ATIVIDADE_SOCIOASSISTENCIALxTIPO_SERVICO] (ID_ATIVIDADE_SOCIOASSISTENCIAL, ID_TIPO_SERVICO)
values(43, 156)
insert [DBPMAS2015].[dbo].[TB_ATIVIDADE_SOCIOASSISTENCIALxTIPO_SERVICO] (ID_ATIVIDADE_SOCIOASSISTENCIAL, ID_TIPO_SERVICO)
values(44, 156)
insert [DBPMAS2015].[dbo].[TB_ATIVIDADE_SOCIOASSISTENCIALxTIPO_SERVICO] (ID_ATIVIDADE_SOCIOASSISTENCIAL, ID_TIPO_SERVICO)
values(46, 156)
insert [DBPMAS2015].[dbo].[TB_ATIVIDADE_SOCIOASSISTENCIALxTIPO_SERVICO] (ID_ATIVIDADE_SOCIOASSISTENCIAL, ID_TIPO_SERVICO)
values(47, 156)
insert [DBPMAS2015].[dbo].[TB_ATIVIDADE_SOCIOASSISTENCIALxTIPO_SERVICO] (ID_ATIVIDADE_SOCIOASSISTENCIAL, ID_TIPO_SERVICO)
values(48, 156)

insert [DBPMAS2015].[dbo].[TB_ATIVIDADE_SOCIOASSISTENCIALxTIPO_SERVICO] (ID_ATIVIDADE_SOCIOASSISTENCIAL, ID_TIPO_SERVICO)
values(1, 157)
insert [DBPMAS2015].[dbo].[TB_ATIVIDADE_SOCIOASSISTENCIALxTIPO_SERVICO] (ID_ATIVIDADE_SOCIOASSISTENCIAL, ID_TIPO_SERVICO)
values(2, 157)
insert [DBPMAS2015].[dbo].[TB_ATIVIDADE_SOCIOASSISTENCIALxTIPO_SERVICO] (ID_ATIVIDADE_SOCIOASSISTENCIAL, ID_TIPO_SERVICO)
values(3, 157)
insert [DBPMAS2015].[dbo].[TB_ATIVIDADE_SOCIOASSISTENCIALxTIPO_SERVICO] (ID_ATIVIDADE_SOCIOASSISTENCIAL, ID_TIPO_SERVICO)
values(4, 157)
insert [DBPMAS2015].[dbo].[TB_ATIVIDADE_SOCIOASSISTENCIALxTIPO_SERVICO] (ID_ATIVIDADE_SOCIOASSISTENCIAL, ID_TIPO_SERVICO)
values(5, 157)
insert [DBPMAS2015].[dbo].[TB_ATIVIDADE_SOCIOASSISTENCIALxTIPO_SERVICO] (ID_ATIVIDADE_SOCIOASSISTENCIAL, ID_TIPO_SERVICO)
values(6, 157)
insert [DBPMAS2015].[dbo].[TB_ATIVIDADE_SOCIOASSISTENCIALxTIPO_SERVICO] (ID_ATIVIDADE_SOCIOASSISTENCIAL, ID_TIPO_SERVICO)
values(7, 157)
insert [DBPMAS2015].[dbo].[TB_ATIVIDADE_SOCIOASSISTENCIALxTIPO_SERVICO] (ID_ATIVIDADE_SOCIOASSISTENCIAL, ID_TIPO_SERVICO)
values(8, 157)
insert [DBPMAS2015].[dbo].[TB_ATIVIDADE_SOCIOASSISTENCIALxTIPO_SERVICO] (ID_ATIVIDADE_SOCIOASSISTENCIAL, ID_TIPO_SERVICO)
values(9, 157)
insert [DBPMAS2015].[dbo].[TB_ATIVIDADE_SOCIOASSISTENCIALxTIPO_SERVICO] (ID_ATIVIDADE_SOCIOASSISTENCIAL, ID_TIPO_SERVICO)
values(10, 157)
insert [DBPMAS2015].[dbo].[TB_ATIVIDADE_SOCIOASSISTENCIALxTIPO_SERVICO] (ID_ATIVIDADE_SOCIOASSISTENCIAL, ID_TIPO_SERVICO)
values(11, 157)
insert [DBPMAS2015].[dbo].[TB_ATIVIDADE_SOCIOASSISTENCIALxTIPO_SERVICO] (ID_ATIVIDADE_SOCIOASSISTENCIAL, ID_TIPO_SERVICO)
values(12, 157)
insert [DBPMAS2015].[dbo].[TB_ATIVIDADE_SOCIOASSISTENCIALxTIPO_SERVICO] (ID_ATIVIDADE_SOCIOASSISTENCIAL, ID_TIPO_SERVICO)
values(14, 157)
insert [DBPMAS2015].[dbo].[TB_ATIVIDADE_SOCIOASSISTENCIALxTIPO_SERVICO] (ID_ATIVIDADE_SOCIOASSISTENCIAL, ID_TIPO_SERVICO)
values(15, 157)
insert [DBPMAS2015].[dbo].[TB_ATIVIDADE_SOCIOASSISTENCIALxTIPO_SERVICO] (ID_ATIVIDADE_SOCIOASSISTENCIAL, ID_TIPO_SERVICO)
values(16, 157)
insert [DBPMAS2015].[dbo].[TB_ATIVIDADE_SOCIOASSISTENCIALxTIPO_SERVICO] (ID_ATIVIDADE_SOCIOASSISTENCIAL, ID_TIPO_SERVICO)
values(17, 157)
insert [DBPMAS2015].[dbo].[TB_ATIVIDADE_SOCIOASSISTENCIALxTIPO_SERVICO] (ID_ATIVIDADE_SOCIOASSISTENCIAL, ID_TIPO_SERVICO)
values(18, 157)
insert [DBPMAS2015].[dbo].[TB_ATIVIDADE_SOCIOASSISTENCIALxTIPO_SERVICO] (ID_ATIVIDADE_SOCIOASSISTENCIAL, ID_TIPO_SERVICO)
values(19, 157)
insert [DBPMAS2015].[dbo].[TB_ATIVIDADE_SOCIOASSISTENCIALxTIPO_SERVICO] (ID_ATIVIDADE_SOCIOASSISTENCIAL, ID_TIPO_SERVICO)
values(21, 157)
insert [DBPMAS2015].[dbo].[TB_ATIVIDADE_SOCIOASSISTENCIALxTIPO_SERVICO] (ID_ATIVIDADE_SOCIOASSISTENCIAL, ID_TIPO_SERVICO)
values(22, 157)
insert [DBPMAS2015].[dbo].[TB_ATIVIDADE_SOCIOASSISTENCIALxTIPO_SERVICO] (ID_ATIVIDADE_SOCIOASSISTENCIAL, ID_TIPO_SERVICO)
values(23, 157)
insert [DBPMAS2015].[dbo].[TB_ATIVIDADE_SOCIOASSISTENCIALxTIPO_SERVICO] (ID_ATIVIDADE_SOCIOASSISTENCIAL, ID_TIPO_SERVICO)
values(26, 157)
insert [DBPMAS2015].[dbo].[TB_ATIVIDADE_SOCIOASSISTENCIALxTIPO_SERVICO] (ID_ATIVIDADE_SOCIOASSISTENCIAL, ID_TIPO_SERVICO)
values(27, 157)
insert [DBPMAS2015].[dbo].[TB_ATIVIDADE_SOCIOASSISTENCIALxTIPO_SERVICO] (ID_ATIVIDADE_SOCIOASSISTENCIAL, ID_TIPO_SERVICO)
values(29, 157)
insert [DBPMAS2015].[dbo].[TB_ATIVIDADE_SOCIOASSISTENCIALxTIPO_SERVICO] (ID_ATIVIDADE_SOCIOASSISTENCIAL, ID_TIPO_SERVICO)
values(30, 157)
insert [DBPMAS2015].[dbo].[TB_ATIVIDADE_SOCIOASSISTENCIALxTIPO_SERVICO] (ID_ATIVIDADE_SOCIOASSISTENCIAL, ID_TIPO_SERVICO)
values(31, 157)
insert [DBPMAS2015].[dbo].[TB_ATIVIDADE_SOCIOASSISTENCIALxTIPO_SERVICO] (ID_ATIVIDADE_SOCIOASSISTENCIAL, ID_TIPO_SERVICO)
values(33, 157)
insert [DBPMAS2015].[dbo].[TB_ATIVIDADE_SOCIOASSISTENCIALxTIPO_SERVICO] (ID_ATIVIDADE_SOCIOASSISTENCIAL, ID_TIPO_SERVICO)
values(34, 157)
insert [DBPMAS2015].[dbo].[TB_ATIVIDADE_SOCIOASSISTENCIALxTIPO_SERVICO] (ID_ATIVIDADE_SOCIOASSISTENCIAL, ID_TIPO_SERVICO)
values(35, 157)
insert [DBPMAS2015].[dbo].[TB_ATIVIDADE_SOCIOASSISTENCIALxTIPO_SERVICO] (ID_ATIVIDADE_SOCIOASSISTENCIAL, ID_TIPO_SERVICO)
values(36, 157)
insert [DBPMAS2015].[dbo].[TB_ATIVIDADE_SOCIOASSISTENCIALxTIPO_SERVICO] (ID_ATIVIDADE_SOCIOASSISTENCIAL, ID_TIPO_SERVICO)
values(38, 157)

insert [DBPMAS2015].[dbo].[TB_ATIVIDADE_SOCIOASSISTENCIALxTIPO_SERVICO] (ID_ATIVIDADE_SOCIOASSISTENCIAL, ID_TIPO_SERVICO)
values(1, 158)
insert [DBPMAS2015].[dbo].[TB_ATIVIDADE_SOCIOASSISTENCIALxTIPO_SERVICO] (ID_ATIVIDADE_SOCIOASSISTENCIAL, ID_TIPO_SERVICO)
values(2, 158)
insert [DBPMAS2015].[dbo].[TB_ATIVIDADE_SOCIOASSISTENCIALxTIPO_SERVICO] (ID_ATIVIDADE_SOCIOASSISTENCIAL, ID_TIPO_SERVICO)
values(3, 158)
insert [DBPMAS2015].[dbo].[TB_ATIVIDADE_SOCIOASSISTENCIALxTIPO_SERVICO] (ID_ATIVIDADE_SOCIOASSISTENCIAL, ID_TIPO_SERVICO)
values(4, 158)
insert [DBPMAS2015].[dbo].[TB_ATIVIDADE_SOCIOASSISTENCIALxTIPO_SERVICO] (ID_ATIVIDADE_SOCIOASSISTENCIAL, ID_TIPO_SERVICO)
values(5, 158)
insert [DBPMAS2015].[dbo].[TB_ATIVIDADE_SOCIOASSISTENCIALxTIPO_SERVICO] (ID_ATIVIDADE_SOCIOASSISTENCIAL, ID_TIPO_SERVICO)
values(6, 158)
insert [DBPMAS2015].[dbo].[TB_ATIVIDADE_SOCIOASSISTENCIALxTIPO_SERVICO] (ID_ATIVIDADE_SOCIOASSISTENCIAL, ID_TIPO_SERVICO)
values(7, 158)
insert [DBPMAS2015].[dbo].[TB_ATIVIDADE_SOCIOASSISTENCIALxTIPO_SERVICO] (ID_ATIVIDADE_SOCIOASSISTENCIAL, ID_TIPO_SERVICO)
values(8, 158)
insert [DBPMAS2015].[dbo].[TB_ATIVIDADE_SOCIOASSISTENCIALxTIPO_SERVICO] (ID_ATIVIDADE_SOCIOASSISTENCIAL, ID_TIPO_SERVICO)
values(9, 158)
insert [DBPMAS2015].[dbo].[TB_ATIVIDADE_SOCIOASSISTENCIALxTIPO_SERVICO] (ID_ATIVIDADE_SOCIOASSISTENCIAL, ID_TIPO_SERVICO)
values(10, 158)
insert [DBPMAS2015].[dbo].[TB_ATIVIDADE_SOCIOASSISTENCIALxTIPO_SERVICO] (ID_ATIVIDADE_SOCIOASSISTENCIAL, ID_TIPO_SERVICO)
values(11, 158)
insert [DBPMAS2015].[dbo].[TB_ATIVIDADE_SOCIOASSISTENCIALxTIPO_SERVICO] (ID_ATIVIDADE_SOCIOASSISTENCIAL, ID_TIPO_SERVICO)
values(12, 158)
insert [DBPMAS2015].[dbo].[TB_ATIVIDADE_SOCIOASSISTENCIALxTIPO_SERVICO] (ID_ATIVIDADE_SOCIOASSISTENCIAL, ID_TIPO_SERVICO)
values(14, 158)
insert [DBPMAS2015].[dbo].[TB_ATIVIDADE_SOCIOASSISTENCIALxTIPO_SERVICO] (ID_ATIVIDADE_SOCIOASSISTENCIAL, ID_TIPO_SERVICO)
values(15, 158)
insert [DBPMAS2015].[dbo].[TB_ATIVIDADE_SOCIOASSISTENCIALxTIPO_SERVICO] (ID_ATIVIDADE_SOCIOASSISTENCIAL, ID_TIPO_SERVICO)
values(16, 158)
insert [DBPMAS2015].[dbo].[TB_ATIVIDADE_SOCIOASSISTENCIALxTIPO_SERVICO] (ID_ATIVIDADE_SOCIOASSISTENCIAL, ID_TIPO_SERVICO)
values(17, 158)
insert [DBPMAS2015].[dbo].[TB_ATIVIDADE_SOCIOASSISTENCIALxTIPO_SERVICO] (ID_ATIVIDADE_SOCIOASSISTENCIAL, ID_TIPO_SERVICO)
values(18, 158)
insert [DBPMAS2015].[dbo].[TB_ATIVIDADE_SOCIOASSISTENCIALxTIPO_SERVICO] (ID_ATIVIDADE_SOCIOASSISTENCIAL, ID_TIPO_SERVICO)
values(19, 158)
insert [DBPMAS2015].[dbo].[TB_ATIVIDADE_SOCIOASSISTENCIALxTIPO_SERVICO] (ID_ATIVIDADE_SOCIOASSISTENCIAL, ID_TIPO_SERVICO)
values(21, 158)
insert [DBPMAS2015].[dbo].[TB_ATIVIDADE_SOCIOASSISTENCIALxTIPO_SERVICO] (ID_ATIVIDADE_SOCIOASSISTENCIAL, ID_TIPO_SERVICO)
values(22, 158)
insert [DBPMAS2015].[dbo].[TB_ATIVIDADE_SOCIOASSISTENCIALxTIPO_SERVICO] (ID_ATIVIDADE_SOCIOASSISTENCIAL, ID_TIPO_SERVICO)
values(23, 158)
insert [DBPMAS2015].[dbo].[TB_ATIVIDADE_SOCIOASSISTENCIALxTIPO_SERVICO] (ID_ATIVIDADE_SOCIOASSISTENCIAL, ID_TIPO_SERVICO)
values(26, 158)
insert [DBPMAS2015].[dbo].[TB_ATIVIDADE_SOCIOASSISTENCIALxTIPO_SERVICO] (ID_ATIVIDADE_SOCIOASSISTENCIAL, ID_TIPO_SERVICO)
values(27, 158)
insert [DBPMAS2015].[dbo].[TB_ATIVIDADE_SOCIOASSISTENCIALxTIPO_SERVICO] (ID_ATIVIDADE_SOCIOASSISTENCIAL, ID_TIPO_SERVICO)
values(29, 158)
insert [DBPMAS2015].[dbo].[TB_ATIVIDADE_SOCIOASSISTENCIALxTIPO_SERVICO] (ID_ATIVIDADE_SOCIOASSISTENCIAL, ID_TIPO_SERVICO)
values(30, 158)
insert [DBPMAS2015].[dbo].[TB_ATIVIDADE_SOCIOASSISTENCIALxTIPO_SERVICO] (ID_ATIVIDADE_SOCIOASSISTENCIAL, ID_TIPO_SERVICO)
values(31, 158)
insert [DBPMAS2015].[dbo].[TB_ATIVIDADE_SOCIOASSISTENCIALxTIPO_SERVICO] (ID_ATIVIDADE_SOCIOASSISTENCIAL, ID_TIPO_SERVICO)
values(33, 158)
insert [DBPMAS2015].[dbo].[TB_ATIVIDADE_SOCIOASSISTENCIALxTIPO_SERVICO] (ID_ATIVIDADE_SOCIOASSISTENCIAL, ID_TIPO_SERVICO)
values(34, 158)
insert [DBPMAS2015].[dbo].[TB_ATIVIDADE_SOCIOASSISTENCIALxTIPO_SERVICO] (ID_ATIVIDADE_SOCIOASSISTENCIAL, ID_TIPO_SERVICO)
values(35, 158)
insert [DBPMAS2015].[dbo].[TB_ATIVIDADE_SOCIOASSISTENCIALxTIPO_SERVICO] (ID_ATIVIDADE_SOCIOASSISTENCIAL, ID_TIPO_SERVICO)
values(36, 158)
insert [DBPMAS2015].[dbo].[TB_ATIVIDADE_SOCIOASSISTENCIALxTIPO_SERVICO] (ID_ATIVIDADE_SOCIOASSISTENCIAL, ID_TIPO_SERVICO)
values(38, 158)

insert [DBPMAS2015].[dbo].[TB_ATIVIDADE_SOCIOASSISTENCIALxTIPO_SERVICO] (ID_ATIVIDADE_SOCIOASSISTENCIAL, ID_TIPO_SERVICO)
values(1, 159)
insert [DBPMAS2015].[dbo].[TB_ATIVIDADE_SOCIOASSISTENCIALxTIPO_SERVICO] (ID_ATIVIDADE_SOCIOASSISTENCIAL, ID_TIPO_SERVICO)
values(2, 159)
insert [DBPMAS2015].[dbo].[TB_ATIVIDADE_SOCIOASSISTENCIALxTIPO_SERVICO] (ID_ATIVIDADE_SOCIOASSISTENCIAL, ID_TIPO_SERVICO)
values(3, 159)
insert [DBPMAS2015].[dbo].[TB_ATIVIDADE_SOCIOASSISTENCIALxTIPO_SERVICO] (ID_ATIVIDADE_SOCIOASSISTENCIAL, ID_TIPO_SERVICO)
values(4, 159)
insert [DBPMAS2015].[dbo].[TB_ATIVIDADE_SOCIOASSISTENCIALxTIPO_SERVICO] (ID_ATIVIDADE_SOCIOASSISTENCIAL, ID_TIPO_SERVICO)
values(5, 159)
insert [DBPMAS2015].[dbo].[TB_ATIVIDADE_SOCIOASSISTENCIALxTIPO_SERVICO] (ID_ATIVIDADE_SOCIOASSISTENCIAL, ID_TIPO_SERVICO)
values(6, 159)
insert [DBPMAS2015].[dbo].[TB_ATIVIDADE_SOCIOASSISTENCIALxTIPO_SERVICO] (ID_ATIVIDADE_SOCIOASSISTENCIAL, ID_TIPO_SERVICO)
values(7, 159)
insert [DBPMAS2015].[dbo].[TB_ATIVIDADE_SOCIOASSISTENCIALxTIPO_SERVICO] (ID_ATIVIDADE_SOCIOASSISTENCIAL, ID_TIPO_SERVICO)
values(8, 159)
insert [DBPMAS2015].[dbo].[TB_ATIVIDADE_SOCIOASSISTENCIALxTIPO_SERVICO] (ID_ATIVIDADE_SOCIOASSISTENCIAL, ID_TIPO_SERVICO)
values(9, 159)
insert [DBPMAS2015].[dbo].[TB_ATIVIDADE_SOCIOASSISTENCIALxTIPO_SERVICO] (ID_ATIVIDADE_SOCIOASSISTENCIAL, ID_TIPO_SERVICO)
values(10, 159)
insert [DBPMAS2015].[dbo].[TB_ATIVIDADE_SOCIOASSISTENCIALxTIPO_SERVICO] (ID_ATIVIDADE_SOCIOASSISTENCIAL, ID_TIPO_SERVICO)
values(11, 159)
insert [DBPMAS2015].[dbo].[TB_ATIVIDADE_SOCIOASSISTENCIALxTIPO_SERVICO] (ID_ATIVIDADE_SOCIOASSISTENCIAL, ID_TIPO_SERVICO)
values(12, 159)
insert [DBPMAS2015].[dbo].[TB_ATIVIDADE_SOCIOASSISTENCIALxTIPO_SERVICO] (ID_ATIVIDADE_SOCIOASSISTENCIAL, ID_TIPO_SERVICO)
values(13, 159)
insert [DBPMAS2015].[dbo].[TB_ATIVIDADE_SOCIOASSISTENCIALxTIPO_SERVICO] (ID_ATIVIDADE_SOCIOASSISTENCIAL, ID_TIPO_SERVICO)
values(14, 159)
insert [DBPMAS2015].[dbo].[TB_ATIVIDADE_SOCIOASSISTENCIALxTIPO_SERVICO] (ID_ATIVIDADE_SOCIOASSISTENCIAL, ID_TIPO_SERVICO)
values(15, 159)
insert [DBPMAS2015].[dbo].[TB_ATIVIDADE_SOCIOASSISTENCIALxTIPO_SERVICO] (ID_ATIVIDADE_SOCIOASSISTENCIAL, ID_TIPO_SERVICO)
values(16, 159)
insert [DBPMAS2015].[dbo].[TB_ATIVIDADE_SOCIOASSISTENCIALxTIPO_SERVICO] (ID_ATIVIDADE_SOCIOASSISTENCIAL, ID_TIPO_SERVICO)
values(17, 159)
insert [DBPMAS2015].[dbo].[TB_ATIVIDADE_SOCIOASSISTENCIALxTIPO_SERVICO] (ID_ATIVIDADE_SOCIOASSISTENCIAL, ID_TIPO_SERVICO)
values(18, 159)
insert [DBPMAS2015].[dbo].[TB_ATIVIDADE_SOCIOASSISTENCIALxTIPO_SERVICO] (ID_ATIVIDADE_SOCIOASSISTENCIAL, ID_TIPO_SERVICO)
values(19, 159)
insert [DBPMAS2015].[dbo].[TB_ATIVIDADE_SOCIOASSISTENCIALxTIPO_SERVICO] (ID_ATIVIDADE_SOCIOASSISTENCIAL, ID_TIPO_SERVICO)
values(20, 159)
insert [DBPMAS2015].[dbo].[TB_ATIVIDADE_SOCIOASSISTENCIALxTIPO_SERVICO] (ID_ATIVIDADE_SOCIOASSISTENCIAL, ID_TIPO_SERVICO)
values(21, 159)
insert [DBPMAS2015].[dbo].[TB_ATIVIDADE_SOCIOASSISTENCIALxTIPO_SERVICO] (ID_ATIVIDADE_SOCIOASSISTENCIAL, ID_TIPO_SERVICO)
values(22, 159)
insert [DBPMAS2015].[dbo].[TB_ATIVIDADE_SOCIOASSISTENCIALxTIPO_SERVICO] (ID_ATIVIDADE_SOCIOASSISTENCIAL, ID_TIPO_SERVICO)
values(23, 159)
insert [DBPMAS2015].[dbo].[TB_ATIVIDADE_SOCIOASSISTENCIALxTIPO_SERVICO] (ID_ATIVIDADE_SOCIOASSISTENCIAL, ID_TIPO_SERVICO)
values(26, 159)
insert [DBPMAS2015].[dbo].[TB_ATIVIDADE_SOCIOASSISTENCIALxTIPO_SERVICO] (ID_ATIVIDADE_SOCIOASSISTENCIAL, ID_TIPO_SERVICO)
values(27, 159)
insert [DBPMAS2015].[dbo].[TB_ATIVIDADE_SOCIOASSISTENCIALxTIPO_SERVICO] (ID_ATIVIDADE_SOCIOASSISTENCIAL, ID_TIPO_SERVICO)
values(28, 159)
insert [DBPMAS2015].[dbo].[TB_ATIVIDADE_SOCIOASSISTENCIALxTIPO_SERVICO] (ID_ATIVIDADE_SOCIOASSISTENCIAL, ID_TIPO_SERVICO)
values(29, 159)
insert [DBPMAS2015].[dbo].[TB_ATIVIDADE_SOCIOASSISTENCIALxTIPO_SERVICO] (ID_ATIVIDADE_SOCIOASSISTENCIAL, ID_TIPO_SERVICO)
values(30, 159)
insert [DBPMAS2015].[dbo].[TB_ATIVIDADE_SOCIOASSISTENCIALxTIPO_SERVICO] (ID_ATIVIDADE_SOCIOASSISTENCIAL, ID_TIPO_SERVICO)
values(31, 159)
insert [DBPMAS2015].[dbo].[TB_ATIVIDADE_SOCIOASSISTENCIALxTIPO_SERVICO] (ID_ATIVIDADE_SOCIOASSISTENCIAL, ID_TIPO_SERVICO)
values(32, 159)
insert [DBPMAS2015].[dbo].[TB_ATIVIDADE_SOCIOASSISTENCIALxTIPO_SERVICO] (ID_ATIVIDADE_SOCIOASSISTENCIAL, ID_TIPO_SERVICO)
values(33, 159)
insert [DBPMAS2015].[dbo].[TB_ATIVIDADE_SOCIOASSISTENCIALxTIPO_SERVICO] (ID_ATIVIDADE_SOCIOASSISTENCIAL, ID_TIPO_SERVICO)
values(34, 159)
insert [DBPMAS2015].[dbo].[TB_ATIVIDADE_SOCIOASSISTENCIALxTIPO_SERVICO] (ID_ATIVIDADE_SOCIOASSISTENCIAL, ID_TIPO_SERVICO)
values(35, 159)
insert [DBPMAS2015].[dbo].[TB_ATIVIDADE_SOCIOASSISTENCIALxTIPO_SERVICO] (ID_ATIVIDADE_SOCIOASSISTENCIAL, ID_TIPO_SERVICO)
values(36, 159)
insert [DBPMAS2015].[dbo].[TB_ATIVIDADE_SOCIOASSISTENCIALxTIPO_SERVICO] (ID_ATIVIDADE_SOCIOASSISTENCIAL, ID_TIPO_SERVICO)
values(37, 159)
insert [DBPMAS2015].[dbo].[TB_ATIVIDADE_SOCIOASSISTENCIALxTIPO_SERVICO] (ID_ATIVIDADE_SOCIOASSISTENCIAL, ID_TIPO_SERVICO)
values(38, 159)
insert [DBPMAS2015].[dbo].[TB_ATIVIDADE_SOCIOASSISTENCIALxTIPO_SERVICO] (ID_ATIVIDADE_SOCIOASSISTENCIAL, ID_TIPO_SERVICO)
values(39, 159)
insert [DBPMAS2015].[dbo].[TB_ATIVIDADE_SOCIOASSISTENCIALxTIPO_SERVICO] (ID_ATIVIDADE_SOCIOASSISTENCIAL, ID_TIPO_SERVICO)
values(40, 159)
insert [DBPMAS2015].[dbo].[TB_ATIVIDADE_SOCIOASSISTENCIALxTIPO_SERVICO] (ID_ATIVIDADE_SOCIOASSISTENCIAL, ID_TIPO_SERVICO)
values(41, 159)
insert [DBPMAS2015].[dbo].[TB_ATIVIDADE_SOCIOASSISTENCIALxTIPO_SERVICO] (ID_ATIVIDADE_SOCIOASSISTENCIAL, ID_TIPO_SERVICO)
values(42, 159)


USE [DBPMAS2015]
GO

SET ANSI_NULLS ON
GO

SET QUOTED_IDENTIFIER ON
GO

ALTER VIEW [dbo].[VW_UNIDADE_PRIVADA]
AS    
SELECT   T.ID
		 ,RAZAO_SOCIAL
		 ,CNPJ
		 ,ID_PREFEITURA
		 ,COUNT(L.ID) AS TOTAL_LOCAIS
		,CASE (SELECT  COUNT(A.ID)  
			 FROM TB_LOCAL_EXECUCAO_PRIVADO A
			 INNER JOIN TB_SERVICOS_RECURSOS_FINANCEIROS_PRIVADO B ON(A.ID = B.ID_LOCAL_EXECUCAO_PRIVADO)			             
			WHERE (B.VALOR_ESTADUAL_ASSISTENCIA > 0)
              AND A.ID_UNIDADE_PRIVADA = T.ID)   
   WHEN 0   
   THEN 'Não'   
   ELSE 'Sim'   
   END 'COFINANCIAMENTO'		
		,CASE (SELECT COUNT(B.SERVICO_ESTADUALIZADO)
				 FROM TB_LOCAL_EXECUCAO_PRIVADO A
			    INNER JOIN TB_SERVICOS_RECURSOS_FINANCEIROS_PRIVADO B
				   ON A.ID = B.ID_LOCAL_EXECUCAO_PRIVADO
				WHERE A.ID_UNIDADE_PRIVADA = T.ID
				  and B.SERVICO_ESTADUALIZADO = 1)
		WHEN 0
		  THEN 'Não'
		  ELSE 'Sim'   
    END 'ESTADUALIZADO'  
	,(SELECT COALESCE(SUM(COALESCE(S.VALOR_ESTADUAL_ASSISTENCIA ,0) ),0) FROM TB_SERVICOS_RECURSOS_FINANCEIROS_PRIVADO S
		INNER JOIN TB_LOCAL_EXECUCAO_PRIVADO L ON(L.ID = S.ID_LOCAL_EXECUCAO_PRIVADO AND L.ID_UNIDADE_PRIVADA = T.ID)) AS VALOR_COFINANCIAMENTO_ESTADUAL		
	,(SELECT COALESCE(SUM(S.NUMERO_ATENDIDOS),0) FROM TB_SERVICOS_RECURSOS_FINANCEIROS_PRIVADO S
	INNER JOIN TB_LOCAL_EXECUCAO_PRIVADO L ON(L.ID = S.ID_LOCAL_EXECUCAO_PRIVADO AND L.ID_UNIDADE_PRIVADA = T.ID)) AS NUMERO_ATENDIDOS		
	,(SELECT COALESCE(SUM(R.VALOR_MUNICIPAL_ASSISTENCIA + R.VALOR_MUNICIPAL_FMDCA + R.VALOR_ESTADUAL_ASSISTENCIA + R.VALOR_ESTADUAL_FEDCA + R.VALOR_FEDERAL_ASSISTENCIA + R.VALOR_FEDERAL_FNDCA + ISNULL(R.VALOR_MUNICIPAL_FMI, 0.0) + ISNULL(R.VALOR_ESTADUAL_FEI, 0.0) + ISNULL(R.VALOR_FEDERAL_FNI, 0.0) + COALESCE(R.VALOR_ESTADUALIZADO,0) + R.VALOR_PRIVADO_EMPRESAS + R.VALOR_PRIVADO_PESSOAS_FISICAS + R.VALOR_PRIVADO_ORGANIZACOES + R.VALOR_PRIVADO_PROPRIOS),0) 
	FROM TB_SERVICOS_RECURSOS_FINANCEIROS_PRIVADO R
	INNER JOIN TB_LOCAL_EXECUCAO_PRIVADO L ON(L.ID = R.ID_LOCAL_EXECUCAO_PRIVADO AND L.ID_UNIDADE_PRIVADA = T.ID)) AS PREVISAO_ORCAMENTARIA
	,case (select isnull(T.ID_FORMA_ATUACAO, 0))
	 when 0 then '' else (select FA.NOME from TB_FORMA_ATUACAO FA where FA.ID = T.ID_FORMA_ATUACAO)
	 end 'FORMA_ATUACAO'

 FROM TB_UNIDADE_PRIVADA AS T
 LEFT JOIN TB_LOCAL_EXECUCAO_PRIVADO L ON(L.ID_UNIDADE_PRIVADA = T.ID)
 GROUP BY T.ID,T.RAZAO_SOCIAL,T.CNPJ,T.ID_PREFEITURA, T.ID_FORMA_ATUACAO

GO


USE [DBPMAS2015]
GO

SET ANSI_NULLS ON
GO

SET QUOTED_IDENTIFIER ON
GO

ALTER VIEW [dbo].[VW_UNIDADE_PRIVADA]
AS    
SELECT   T.ID
		 ,RAZAO_SOCIAL
		 ,CNPJ
		 ,ID_PREFEITURA
		 ,COUNT(L.ID) AS TOTAL_LOCAIS
		,CASE (SELECT  COUNT(A.ID)  
			 FROM TB_LOCAL_EXECUCAO_PRIVADO A
			 INNER JOIN TB_SERVICOS_RECURSOS_FINANCEIROS_PRIVADO B ON(A.ID = B.ID_LOCAL_EXECUCAO_PRIVADO)			             
			WHERE (B.VALOR_ESTADUAL_ASSISTENCIA > 0)
              AND A.ID_UNIDADE_PRIVADA = T.ID)   
   WHEN 0   
   THEN 'Não'   
   ELSE 'Sim'   
   END 'COFINANCIAMENTO'		
		,CASE (SELECT COUNT(B.SERVICO_ESTADUALIZADO)
				 FROM TB_LOCAL_EXECUCAO_PRIVADO A
			    INNER JOIN TB_SERVICOS_RECURSOS_FINANCEIROS_PRIVADO B
				   ON A.ID = B.ID_LOCAL_EXECUCAO_PRIVADO
				WHERE A.ID_UNIDADE_PRIVADA = T.ID
				  and B.SERVICO_ESTADUALIZADO = 1)
		WHEN 0
		  THEN 'Não'
		  ELSE 'Sim'   
    END 'ESTADUALIZADO'  
	,(SELECT COALESCE(SUM(COALESCE(S.VALOR_ESTADUAL_ASSISTENCIA ,0) ),0) FROM TB_SERVICOS_RECURSOS_FINANCEIROS_PRIVADO S
		INNER JOIN TB_LOCAL_EXECUCAO_PRIVADO L ON(L.ID = S.ID_LOCAL_EXECUCAO_PRIVADO AND L.ID_UNIDADE_PRIVADA = T.ID)) AS VALOR_COFINANCIAMENTO_ESTADUAL		
	,(SELECT COALESCE(SUM(S.NUMERO_ATENDIDOS),0) FROM TB_SERVICOS_RECURSOS_FINANCEIROS_PRIVADO S
	INNER JOIN TB_LOCAL_EXECUCAO_PRIVADO L ON(L.ID = S.ID_LOCAL_EXECUCAO_PRIVADO AND L.ID_UNIDADE_PRIVADA = T.ID)) AS NUMERO_ATENDIDOS		
	,(SELECT COALESCE(SUM(R.VALOR_MUNICIPAL_ASSISTENCIA + R.VALOR_MUNICIPAL_FMDCA + R.VALOR_ESTADUAL_ASSISTENCIA + R.VALOR_ESTADUAL_FEDCA + R.VALOR_FEDERAL_ASSISTENCIA + R.VALOR_FEDERAL_FNDCA + ISNULL(R.VALOR_MUNICIPAL_FMI, 0.0) + ISNULL(R.VALOR_ESTADUAL_FEI, 0.0) + ISNULL(R.VALOR_FEDERAL_FNI, 0.0) + COALESCE(R.VALOR_ESTADUALIZADO,0) + R.VALOR_PRIVADO_EMPRESAS + R.VALOR_PRIVADO_PESSOAS_FISICAS + R.VALOR_PRIVADO_ORGANIZACOES + R.VALOR_PRIVADO_PROPRIOS),0) 
	FROM TB_SERVICOS_RECURSOS_FINANCEIROS_PRIVADO R
	INNER JOIN TB_LOCAL_EXECUCAO_PRIVADO L ON(L.ID = R.ID_LOCAL_EXECUCAO_PRIVADO AND L.ID_UNIDADE_PRIVADA = T.ID)) AS PREVISAO_ORCAMENTARIA
	,isnull(T.ID_FORMA_ATUACAO, 0) ID_FORMA_ATUACAO
	,case (select isnull(T.ID_FORMA_ATUACAO, 0))
	 when 0 then '' else (select FA.NOME from TB_FORMA_ATUACAO FA where FA.ID = T.ID_FORMA_ATUACAO)
	 end 'FORMA_ATUACAO'

 FROM TB_UNIDADE_PRIVADA AS T
 LEFT JOIN TB_LOCAL_EXECUCAO_PRIVADO L ON(L.ID_UNIDADE_PRIVADA = T.ID)
 GROUP BY T.ID,T.RAZAO_SOCIAL,T.CNPJ,T.ID_PREFEITURA, T.ID_FORMA_ATUACAO

GO



SET ANSI_NULLS ON
GO

SET QUOTED_IDENTIFIER ON
GO

GO
EXEC sp_rename '[dbo].[PR_BENEFICIO_EVENTUAL_2013]', 'PR_BENEFICIO_EVENTUAL_2014';
GO

GO
EXEC sp_rename '[dbo].[PR_INDICE_GESTAO_DESCENTRALIZADA_2013]', 'PR_INDICE_GESTAO_DESCENTRALIZADA_2014';
GO

GO
EXEC sp_rename '[dbo].[PR_LEI_ORCAMENTARIA_2013]', 'PR_LEI_ORCAMENTARIA_2014';
GO

GO
EXEC sp_rename '[dbo].[PR_PREVISAO_ORCAMENTARIA_2013]', 'PR_PREVISAO_ORCAMENTARIA_2014';
GO

GO
EXEC sp_rename '[dbo].[PR_SAO_PAULO_SOLIDARIO_2013]', 'PR_SAO_PAULO_SOLIDARIO_2014'
GO

GO
EXEC sp_rename '[dbo].[PR_TRANSFERENCIA_RENDA_ANUAL_2013]', 'PR_TRANSFERENCIA_RENDA_ANUAL_2014' 
GO


GO




ALTER VIEW [dbo].[VW_REDE_SERVICOS_SOCIOASSISTENCIAIS_SIMPLES]
AS


SELECT 
P.ID AS ID_PREFEITURA,
MUN.ID AS ID_MUNICIPIO,
MUN.ID_DRADS,
MUN.NOME AS MUNICIPIO,
DRA.NOME AS DRADS,
COALESCE(MUN.ID_REGIAO_METROPOLITANA,-1) AS ID_REGIAO_METROPOLITANA,
DRA.ID_MACRO_REGIAO,
P.ID_NIVEL_GESTAO,
(CASE WHEN P.POPULACAO <= 20000 THEN 1
	WHEN   P.POPULACAO <= 50000 THEN 2
	WHEN   P.POPULACAO <= 100000 THEN 3
	WHEN   P.POPULACAO <= 900000 THEN 4
	ELSE 5
END) AS ID_PORTE,
'Pública' AS TIPO_UNIDADE,
1 AS ID_TIPO_UNIDADE,
UN.ID AS CODIGO_UNIDADE,
NULL AS ID_DISTRITOS_SAO_PAULO,
NULL AS DISTRITO_SAO_PAULO,
UN.CNPJ AS CNPJ,
UN.RAZAO_SOCIAL AS UNIDADE_RESPONSAVEL,
CAST(L.ID AS VARCHAR) AS ID_LOCAL,
L.NOME AS LOCAL_EXECUCAO,
L.CIDADE AS CIDADE,
U.NOME AS USUARIOS,
U.ID AS ID_USUARIO_TIPO_SERVICO,
S.NOME + (CASE WHEN R.DESCRICAO_NAO_TIPIFICADO IS NOT NULL AND  R.DESCRICAO_NAO_TIPIFICADO <> '' THEN ' - ' + R.DESCRICAO_NAO_TIPIFICADO ELSE '' END)  AS TIPO_SERVICO,
S.ID AS ID_TIPO_SERVICO,
TP.NOME AS PROTECAO_SOCIAL,
TP.ID AS ID_TIPO_PROTECAO,
SX.ID AS ID_SEXO,
SX.NOME AS SEXO,
RM.ID AS ID_REGIAO_MORADIA,
(CASE WHEN RM.ID = 3 THEN 'Zona Urbana e Rural' ELSE RM.NOME END) AS REGIAO_MORADIA,
CT.ID AS ID_CARACTERISTICAS_TERRITORIO,
CT.NOME AS CARACTERISTICAS_TERRITORIO,
R.VALOR_MUNICIPAL_ASSISTENCIA AS VALOR_FMAS,
R.VALOR_MUNICIPAL_FMDCA AS VALOR_FMDCA,
R.VALOR_ESTADUAL_ASSISTENCIA AS VALOR_FEAS,
R.VALOR_ESTADUAL_FEDCA AS VALOR_FEDCA,
R.VALOR_FEDERAL_ASSISTENCIA AS VALOR_FNAS,
R.VALOR_FEDERAL_FNDCA AS VALOR_FNDCA,
0 AS VALOR_PRIVADO,
COALESCE(R.VALOR_ESTADUALIZADO,0) AS VALOR_ESTADUALIZADO,
A.ABREVIACAO AS ABRANGENCIA,
A.ID AS ID_ABRANGENCIA,
R.NUMERO_ATENDIDOS_MENSAL,
R.NUMERO_ATENDIDOS AS NUMERO_ATENDIDOS_ANUAL,
R.TOTAL_FUNCIONARIOS AS TOTAL_TRABALHADORES_SERVICO,
COALESCE((L.TOTAL_NIVEL_FUNDAMENTAL + L.NIVEL_MEDIO + L.TOTAL_SUPERIOR + L.TOTAL_SEM_ESCOLARIDADE),0) AS TOTAL_TRABALHADORES,
isnull(R.VALOR_MUNICIPAL_FMI, 0.0) AS VALOR_FMI,
isnull(R.VALOR_ESTADUAL_FEI, 0.0) AS VALOR_FEI,
isnull(R.VALOR_FEDERAL_FNI, 0.0) AS VALOR_FNI
FROM TB_PREFEITURA P
JOIN DBSEDS.DBO.TB_MUNICIPIOS MUN (NOLOCK) ON P.ID_MUNICIPIO = MUN.ID
JOIN DBSEDS.DBO.TB_DRADS DRA (NOLOCK) ON MUN.ID_DRADS = DRA.ID
INNER JOIN TB_UNIDADE_PUBLICA UN ON(UN.ID_PREFEITURA = P.ID)
INNER JOIN TB_LOCAL_EXECUCAO_PUBLICO L ON(L.ID_UNIDADE_PUBLICA = UN.ID)
INNER JOIN TB_SERVICOS_RECURSOS_FINANCEIROS_PUBLICO R ON(R.ID_LOCAL_EXECUCAO_PUBLICO = L.ID)
INNER JOIN TB_ABRANGENCIA_SERVICO A ON(R.ID_ABRANGENCIA_SERVICO = A.ID)
INNER JOIN TB_USUARIO_TIPO_SERVICO U ON (R.ID_USUARIO_TIPO_SERVICO = U.ID)
INNER JOIN TB_TIPO_SERVICO S ON (U.ID_TIPO_SERVICO = S.ID)
INNER JOIN TB_TIPO_PROTECAO TP ON(TP.ID = S.ID_TIPO_PROTECAO)
INNER JOIN TB_SEXO SX ON(SX.ID = R.ID_SEXO)
INNER JOIN TB_REGIAO_MORADIA RM ON(RM.ID = R.ID_REGIAO_MORADIA)
INNER JOIN TB_CARACTERISTICAS_TERRITORIO CT ON(CT.ID = R.ID_CARACTERISTICAS_TERRITORIO)

UNION ALL

SELECT 
P.ID AS ID_PREFEITURA,
MUN.ID AS ID_MUNICIPIO,
MUN.ID_DRADS,
MUN.NOME AS MUNICIPIO,
DRA.NOME AS DRADS,
COALESCE(MUN.ID_REGIAO_METROPOLITANA,-1) AS ID_REGIAO_METROPOLITANA,
DRA.ID_MACRO_REGIAO,
P.ID_NIVEL_GESTAO,
(CASE WHEN P.POPULACAO <= 20000 THEN 1
	WHEN   P.POPULACAO <= 50000 THEN 2
	WHEN   P.POPULACAO <= 100000 THEN 3
	WHEN   P.POPULACAO <= 900000 THEN 4
	ELSE 5
END) AS ID_PORTE,
'Privada' AS TIPO_UNIDADE,
2 AS ID_TIPO_UNIDADE,
UN.ID AS CODIGO_UNIDADE,
NULL AS ID_DISTRITOS_SAO_PAULO,
NULL AS DISTRITOS_SAO_PAULO,
UN.CNPJ AS CNPJ,
UN.RAZAO_SOCIAL AS UNIDADE_RESPONSAVEL,
CAST(L.ID AS VARCHAR) AS ID_LOCAL,
L.NOME AS LOCAL_EXECUCAO,
L.CIDADE AS CIDADE,
U.NOME AS USUARIOS,
U.ID AS ID_USUARIO_TIPO_SERVICO,
S.NOME + (CASE WHEN R.DESCRICAO_NAO_TIPIFICADO IS NOT NULL AND  R.DESCRICAO_NAO_TIPIFICADO <> '' THEN ' - ' + R.DESCRICAO_NAO_TIPIFICADO ELSE '' END)  AS TIPO_SERVICO,
S.ID AS ID_TIPO_SERVICO,
TP.NOME AS PROTECAO_SOCIAL,
TP.ID AS ID_TIPO_PROTECAO,
SX.ID AS ID_SEXO,
SX.NOME AS SEXO,
RM.ID AS ID_REGIAO_MORADIA,
(CASE WHEN RM.ID = 3 THEN 'Zona Urbana e Rural' ELSE RM.NOME END) AS REGIAO_MORADIA,
CT.ID AS ID_CARACTERISTICAS_TERRITORIO,
CT.NOME AS CARACTERISTICAS_TERRITORIO,
R.VALOR_MUNICIPAL_ASSISTENCIA AS VALOR_FMAS,
R.VALOR_MUNICIPAL_FMDCA AS VALOR_FMDCA,
R.VALOR_ESTADUAL_ASSISTENCIA AS VALOR_FEAS,
R.VALOR_ESTADUAL_FEDCA AS VALOR_FEDCA,
R.VALOR_FEDERAL_ASSISTENCIA AS VALOR_FNAS,
R.VALOR_FEDERAL_FNDCA AS VALOR_FNDCA,
(R.VALOR_PRIVADO_EMPRESAS + R.VALOR_PRIVADO_ORGANIZACOES + R.VALOR_PRIVADO_PESSOAS_FISICAS + R.VALOR_PRIVADO_PROPRIOS) AS VALOR_PRIVADO,
COALESCE(R.VALOR_ESTADUALIZADO,0) AS VALOR_ESTADUALIZADO,
A.ABREVIACAO AS ABRANGENCIA,
A.ID AS ID_ABRANGENCIA,
R.NUMERO_ATENDIDOS_MENSAL,
R.NUMERO_ATENDIDOS AS NUMERO_ATENDIDOS_ANUAL,
R.TOTAL_FUNCIONARIOS AS TOTAL_TRABALHADORES_SERVICO,
COALESCE((L.TOTAL_NIVEL_FUNDAMENTAL + L.NIVEL_MEDIO + L.TOTAL_SUPERIOR + L.TOTAL_SEM_ESCOLARIDADE),0) AS TOTAL_TRABALHADORES,
isnull(R.VALOR_MUNICIPAL_FMI, 0.0) AS VALOR_FMI,
isnull(R.VALOR_ESTADUAL_FEI, 0.0) AS VALOR_FEI,
isnull(R.VALOR_FEDERAL_FNI, 0.0) AS VALOR_FNI
FROM TB_PREFEITURA P
JOIN DBSEDS.DBO.TB_MUNICIPIOS MUN (NOLOCK) ON P.ID_MUNICIPIO = MUN.ID
JOIN DBSEDS.DBO.TB_DRADS DRA (NOLOCK) ON MUN.ID_DRADS = DRA.ID
INNER JOIN TB_UNIDADE_PRIVADA UN ON(UN.ID_PREFEITURA = P.ID)
INNER JOIN TB_LOCAL_EXECUCAO_PRIVADO L ON(L.ID_UNIDADE_PRIVADA = UN.ID)
INNER JOIN TB_SERVICOS_RECURSOS_FINANCEIROS_PRIVADO R ON(R.ID_LOCAL_EXECUCAO_PRIVADO = L.ID)
INNER JOIN TB_ABRANGENCIA_SERVICO A ON(R.ID_ABRANGENCIA_SERVICO = A.ID)
INNER JOIN TB_USUARIO_TIPO_SERVICO U ON (R.ID_USUARIO_TIPO_SERVICO = U.ID)
INNER JOIN TB_TIPO_SERVICO S ON (U.ID_TIPO_SERVICO = S.ID)
INNER JOIN TB_TIPO_PROTECAO TP ON(TP.ID = S.ID_TIPO_PROTECAO)
INNER JOIN TB_SEXO SX ON(SX.ID = R.ID_SEXO)
INNER JOIN TB_REGIAO_MORADIA RM ON(RM.ID = R.ID_REGIAO_MORADIA)
INNER JOIN TB_CARACTERISTICAS_TERRITORIO CT ON(CT.ID = R.ID_CARACTERISTICAS_TERRITORIO)

UNION ALL

SELECT 
P.ID AS ID_PREFEITURA,
MUN.ID AS ID_MUNICIPIO,
MUN.ID_DRADS,
MUN.NOME AS MUNICIPIO,
DRA.NOME AS DRADS,
COALESCE(MUN.ID_REGIAO_METROPOLITANA,-1) AS ID_REGIAO_METROPOLITANA,
DRA.ID_MACRO_REGIAO,
P.ID_NIVEL_GESTAO,
(CASE WHEN P.POPULACAO <= 20000 THEN 1
	WHEN   P.POPULACAO <= 50000 THEN 2
	WHEN   P.POPULACAO <= 100000 THEN 3
	WHEN   P.POPULACAO <= 900000 THEN 4
	ELSE 5
END) AS ID_PORTE,
'Pública' AS TIPO_UNIDADE,
3 AS ID_TIPO_UNIDADE,
C.ID AS CODIGO_UNIDADE,
C.ID_DISTRITOS_SAO_PAULO AS ID_DISTRITOS_SAO_PAULO,
DS.NOME AS DISTRITO_SAO_PAULO,
UP.CNPJ AS CNPJ,
UP.RAZAO_SOCIAL AS UNIDADE_RESPONSAVEL,
C.IDCRAS AS ID_LOCAL,
C.NOME AS LOCAL_EXECUCAO,
C.CIDADE AS CIDADE,
U.NOME AS USUARIOS,
U.ID AS ID_USUARIO_TIPO_SERVICO,
S.NOME + (CASE WHEN R.DESCRICAO_NAO_TIPIFICADO IS NOT NULL AND  R.DESCRICAO_NAO_TIPIFICADO <> '' THEN ' - ' + R.DESCRICAO_NAO_TIPIFICADO ELSE '' END)  AS TIPO_SERVICO,
S.ID AS ID_TIPO_SERVICO,
TP.NOME AS PROTECAO_SOCIAL,
TP.ID AS ID_TIPO_PROTECAO,
SX.ID AS ID_SEXO,
SX.NOME AS SEXO,
RM.ID AS ID_REGIAO_MORADIA,
(CASE WHEN RM.ID = 3 THEN 'Zona Urbana e Rural' ELSE RM.NOME END) AS REGIAO_MORADIA,
CT.ID AS ID_CARACTERISTICAS_TERRITORIO,
CT.NOME AS CARACTERISTICAS_TERRITORIO,
R.VALOR_MUNICIPAL_ASSISTENCIA AS VALOR_FMAS,
R.VALOR_MUNICIPAL_FMDCA AS VALOR_FMDCA,
R.VALOR_ESTADUAL_ASSISTENCIA AS VALOR_FEAS,
R.VALOR_ESTADUAL_FEDCA AS VALOR_FEDCA,
R.VALOR_FEDERAL_ASSISTENCIA AS VALOR_FNAS,
R.VALOR_FEDERAL_FNDCA AS VALOR_FNDCA,
0 AS VALOR_PRIVADO,
COALESCE(R.VALOR_ESTADUALIZADO,0) AS VALOR_ESTADUALIZADO,
A.ABREVIACAO AS ABRANGENCIA,
A.ID AS ID_ABRANGENCIA,
R.NUMERO_ATENDIDOS_MENSAL,
R.NUMERO_ATENDIDOS AS NUMERO_ATENDIDOS_ANUAL,
R.TOTAL_FUNCIONARIOS AS TOTAL_TRABALHADORES_SERVICO,
COALESCE((C.TOTAL_NIVEL_FUNDAMENTAL + C.TOTAL_NIVEL_MEDIO + C.TOTAL_SUPERIOR + C.TOTAL_SEM_ESCOLARIDADE),0) AS TOTAL_TRABALHADORES,
isnull(R.VALOR_MUNICIPAL_FMI, 0.0) AS VALOR_FMI,
isnull(R.VALOR_ESTADUAL_FEI, 0.0) AS VALOR_FEI,
isnull(R.VALOR_FEDERAL_FNI, 0.0) AS VALOR_FNI
FROM TB_PREFEITURA P
JOIN DBSEDS.DBO.TB_MUNICIPIOS MUN (NOLOCK) ON P.ID_MUNICIPIO = MUN.ID
JOIN DBSEDS.DBO.TB_DRADS DRA (NOLOCK) ON MUN.ID_DRADS = DRA.ID
INNER JOIN TB_UNIDADE_PUBLICA UP ON(UP.ID_PREFEITURA = P.ID)
INNER JOIN TB_CRAS C ON(C.ID_UNIDADE_PUBLICA = UP.ID)
INNER JOIN TB_SERVICOS_RECURSOS_FINANCEIROS_CRAS R ON(R.ID_CRAS = C.ID)
INNER JOIN TB_ABRANGENCIA_SERVICO A ON(R.ID_ABRANGENCIA_SERVICO = A.ID)
INNER JOIN TB_USUARIO_TIPO_SERVICO U ON (R.ID_USUARIO_TIPO_SERVICO = U.ID)
INNER JOIN TB_TIPO_SERVICO S ON (U.ID_TIPO_SERVICO = S.ID)
INNER JOIN TB_TIPO_PROTECAO TP ON(TP.ID = S.ID_TIPO_PROTECAO)
INNER JOIN TB_SEXO SX ON(SX.ID = R.ID_SEXO)
INNER JOIN TB_REGIAO_MORADIA RM ON(RM.ID = R.ID_REGIAO_MORADIA)
INNER JOIN TB_CARACTERISTICAS_TERRITORIO CT ON(CT.ID = R.ID_CARACTERISTICAS_TERRITORIO)
INNER JOIN TB_DISTRITOS_SAO_PAULO DS ON (DS.ID = C.ID_DISTRITOS_SAO_PAULO)


UNION ALL

SELECT 
P.ID AS ID_PREFEITURA,
MUN.ID AS ID_MUNICIPIO,
MUN.ID_DRADS,
MUN.NOME AS MUNICIPIO,
DRA.NOME AS DRADS,
COALESCE(MUN.ID_REGIAO_METROPOLITANA,-1) AS ID_REGIAO_METROPOLITANA,
DRA.ID_MACRO_REGIAO,
P.ID_NIVEL_GESTAO,
(CASE WHEN P.POPULACAO <= 20000 THEN 1
	WHEN   P.POPULACAO <= 50000 THEN 2
	WHEN   P.POPULACAO <= 100000 THEN 3
	WHEN   P.POPULACAO <= 900000 THEN 4
	ELSE 5
END) AS ID_PORTE,
'Pública' AS TIPO_UNIDADE,
4 AS ID_TIPO_UNIDADE,
C.ID AS CODIGO_UNIDADE,
C.ID_DISTRITOS_SAO_PAULO AS ID_DISTRITOS_SAO_PAULO,
DS.NOME AS DISTRITO_SAO_PAULO,
UP.CNPJ AS CNPJ,
UP.RAZAO_SOCIAL AS UNIDADE_RESPONSAVEL,
C.IDCREAS AS ID_LOCAL,
C.NOME AS LOCAL_EXECUCAO,
C.CIDADE AS CIDADE,
U.NOME AS USUARIOS,
U.ID AS ID_USUARIO_TIPO_SERVICO,
S.NOME + (CASE WHEN R.DESCRICAO_NAO_TIPIFICADO IS NOT NULL AND  R.DESCRICAO_NAO_TIPIFICADO <> '' THEN ' - ' + R.DESCRICAO_NAO_TIPIFICADO ELSE '' END)  AS TIPO_SERVICO,
S.ID AS ID_TIPO_SERVICO,
TP.NOME AS PROTECAO_SOCIAL,
TP.ID AS ID_TIPO_PROTECAO,
SX.ID AS ID_SEXO,
SX.NOME AS SEXO,
RM.ID AS ID_REGIAO_MORADIA,
(CASE WHEN RM.ID = 3 THEN 'Zona Urbana e Rural' ELSE RM.NOME END) AS REGIAO_MORADIA,
CT.ID AS ID_CARACTERISTICAS_TERRITORIO,
CT.NOME AS CARACTERISTICAS_TERRITORIO,
R.VALOR_MUNICIPAL_ASSISTENCIA AS VALOR_FMAS,
R.VALOR_MUNICIPAL_FMDCA AS VALOR_FMDCA,
R.VALOR_ESTADUAL_ASSISTENCIA AS VALOR_FEAS,
R.VALOR_ESTADUAL_FEDCA AS VALOR_FEDCA,
R.VALOR_FEDERAL_ASSISTENCIA AS VALOR_FNAS,
R.VALOR_FEDERAL_FNDCA AS VALOR_FNDCA,
0 AS VALOR_PRIVADO,
COALESCE(R.VALOR_ESTADUALIZADO,0) AS VALOR_ESTADUALIZADO,
A.ABREVIACAO AS ABRANGENCIA,
A.ID AS ID_ABRANGENCIA,
R.NUMERO_ATENDIDOS_MENSAL,
R.NUMERO_ATENDIDOS AS NUMERO_ATENDIDOS_ANUAL,
R.TOTAL_FUNCIONARIOS AS TOTAL_TRABALHADORES_SERVICO,
COALESCE((C.TOTAL_NIVEL_FUNDAMENTAL + C.TOTAL_NIVEL_MEDIO + C.TOTAL_SUPERIOR + C.TOTAL_SEM_ESCOLARIDADE),0) AS TOTAL_TRABALHADORES,
isnull(R.VALOR_MUNICIPAL_FMI, 0.0) AS VALOR_FMI,
isnull(R.VALOR_ESTADUAL_FEI, 0.0) AS VALOR_FEI,
isnull(R.VALOR_FEDERAL_FNI, 0.0) AS VALOR_FNI
FROM TB_PREFEITURA P
JOIN DBSEDS.DBO.TB_MUNICIPIOS MUN (NOLOCK) ON P.ID_MUNICIPIO = MUN.ID
JOIN DBSEDS.DBO.TB_DRADS DRA (NOLOCK) ON MUN.ID_DRADS = DRA.ID
INNER JOIN TB_UNIDADE_PUBLICA UP ON(UP.ID_PREFEITURA = P.ID)
INNER JOIN TB_CREAS C ON(C.ID_UNIDADE_PUBLICA = UP.ID)
INNER JOIN TB_SERVICOS_RECURSOS_FINANCEIROS_CREAS R ON(R.ID_CREAS = C.ID)
INNER JOIN TB_ABRANGENCIA_SERVICO A ON(R.ID_ABRANGENCIA_SERVICO = A.ID)
INNER JOIN TB_USUARIO_TIPO_SERVICO U ON (R.ID_USUARIO_TIPO_SERVICO = U.ID)
INNER JOIN TB_TIPO_SERVICO S ON (U.ID_TIPO_SERVICO = S.ID)
INNER JOIN TB_TIPO_PROTECAO TP ON(TP.ID = S.ID_TIPO_PROTECAO)
INNER JOIN TB_SEXO SX ON(SX.ID = R.ID_SEXO)
INNER JOIN TB_REGIAO_MORADIA RM ON(RM.ID = R.ID_REGIAO_MORADIA)
INNER JOIN TB_CARACTERISTICAS_TERRITORIO CT ON(CT.ID = R.ID_CARACTERISTICAS_TERRITORIO)
INNER JOIN TB_DISTRITOS_SAO_PAULO DS ON (DS.ID = C.ID_DISTRITOS_SAO_PAULO)


UNION ALL

SELECT 
P.ID AS ID_PREFEITURA,
MUN.ID AS ID_MUNICIPIO,
MUN.ID_DRADS,
MUN.NOME AS MUNICIPIO,
DRA.NOME AS DRADS,
COALESCE(MUN.ID_REGIAO_METROPOLITANA,-1) AS ID_REGIAO_METROPOLITANA,
DRA.ID_MACRO_REGIAO,
P.ID_NIVEL_GESTAO,
(CASE WHEN P.POPULACAO <= 20000 THEN 1
	WHEN   P.POPULACAO <= 50000 THEN 2
	WHEN   P.POPULACAO <= 100000 THEN 3
	WHEN   P.POPULACAO <= 900000 THEN 4
	ELSE 5
END) AS ID_PORTE,
'Pública' AS TIPO_UNIDADE,
5 AS ID_TIPO_UNIDADE,
C.ID AS CODIGO_UNIDADE,
C.ID_DISTRITOS_SAO_PAULO AS ID_DISTRITOS_SAO_PAULO,
DS.NOME AS DISTRITO_SAO_PAULO,
UP.CNPJ AS CNPJ,
UP.RAZAO_SOCIAL AS UNIDADE_RESPONSAVEL,
C.IDCREAS AS ID_LOCAL,
C.NOME AS LOCAL_EXECUCAO,
C.CIDADE AS CIDADE,
U.NOME AS USUARIOS,
U.ID AS ID_USUARIO_TIPO_SERVICO,
S.NOME + (CASE WHEN R.DESCRICAO_NAO_TIPIFICADO IS NOT NULL AND  R.DESCRICAO_NAO_TIPIFICADO <> '' THEN ' - ' + R.DESCRICAO_NAO_TIPIFICADO ELSE '' END)  AS TIPO_SERVICO,
S.ID AS ID_TIPO_SERVICO,
TP.NOME AS PROTECAO_SOCIAL,
TP.ID AS ID_TIPO_PROTECAO,
SX.ID AS ID_SEXO,
SX.NOME AS SEXO,
RM.ID AS ID_REGIAO_MORADIA,
(CASE WHEN RM.ID = 3 THEN 'Zona Urbana e Rural' ELSE RM.NOME END) AS REGIAO_MORADIA,
CT.ID AS ID_CARACTERISTICAS_TERRITORIO,
CT.NOME AS CARACTERISTICAS_TERRITORIO,
R.VALOR_MUNICIPAL_ASSISTENCIA AS VALOR_FMAS,
R.VALOR_MUNICIPAL_FMDCA AS VALOR_FMDCA,
R.VALOR_ESTADUAL_ASSISTENCIA AS VALOR_FEAS,
R.VALOR_ESTADUAL_FEDCA AS VALOR_FEDCA,
R.VALOR_FEDERAL_ASSISTENCIA AS VALOR_FNAS,
R.VALOR_FEDERAL_FNDCA AS VALOR_FNDCA,
0 AS VALOR_PRIVADO,
COALESCE(R.VALOR_ESTADUALIZADO,0) AS VALOR_ESTADUALIZADO,
A.ABREVIACAO AS ABRANGENCIA,
A.ID AS ID_ABRANGENCIA,
R.NUMERO_ATENDIDOS_MENSAL,
R.NUMERO_ATENDIDOS AS NUMERO_ATENDIDOS_ANUAL,
R.TOTAL_FUNCIONARIOS AS TOTAL_TRABALHADORES_SERVICO,
COALESCE((C.TOTAL_NIVEL_FUNDAMENTAL + C.TOTAL_NIVEL_MEDIO + C.TOTAL_SUPERIOR + C.TOTAL_SEM_ESCOLARIDADE),0) AS TOTAL_TRABALHADORES,
isnull(R.VALOR_MUNICIPAL_FMI, 0.0) AS VALOR_FMI,
isnull(R.VALOR_ESTADUAL_FEI, 0.0) AS VALOR_FEI,
isnull(R.VALOR_FEDERAL_FNI, 0.0) AS VALOR_FNI
FROM TB_PREFEITURA P
JOIN DBSEDS.DBO.TB_MUNICIPIOS MUN (NOLOCK) ON P.ID_MUNICIPIO = MUN.ID
JOIN DBSEDS.DBO.TB_DRADS DRA (NOLOCK) ON MUN.ID_DRADS = DRA.ID
INNER JOIN TB_UNIDADE_PUBLICA UP ON(UP.ID_PREFEITURA = P.ID)
INNER JOIN TB_CENTRO_POP C ON(C.ID_UNIDADE_PUBLICA = UP.ID)
INNER JOIN TB_SERVICOS_RECURSOS_FINANCEIROS_CENTRO_POP R ON(R.ID_CENTRO_POP = C.ID)
INNER JOIN TB_ABRANGENCIA_SERVICO A ON(R.ID_ABRANGENCIA_SERVICO = A.ID)
INNER JOIN TB_USUARIO_TIPO_SERVICO U ON (R.ID_USUARIO_TIPO_SERVICO = U.ID)
INNER JOIN TB_TIPO_SERVICO S ON (U.ID_TIPO_SERVICO = S.ID)
INNER JOIN TB_TIPO_PROTECAO TP ON(TP.ID = S.ID_TIPO_PROTECAO)
INNER JOIN TB_SEXO SX ON(SX.ID = R.ID_SEXO)
INNER JOIN TB_REGIAO_MORADIA RM ON(RM.ID = R.ID_REGIAO_MORADIA)
INNER JOIN TB_CARACTERISTICAS_TERRITORIO CT ON(CT.ID = R.ID_CARACTERISTICAS_TERRITORIO)
INNER JOIN TB_DISTRITOS_SAO_PAULO DS ON (DS.ID = C.ID_DISTRITOS_SAO_PAULO)



GO



GO



ALTER VIEW [dbo].[VW_REDE_SERVICOS_SOCIOASSISTENCIAIS]
AS
SELECT 
P.ID AS ID_PREFEITURA,
MUN.ID AS ID_MUNICIPIO,
MUN.ID_DRADS,
MUN.NOME AS MUNICIPIO,
DRA.NOME AS DRADS,
COALESCE(MUN.ID_REGIAO_METROPOLITANA,-1) AS ID_REGIAO_METROPOLITANA,
DRA.ID_MACRO_REGIAO,
P.ID_NIVEL_GESTAO,
(CASE WHEN P.POPULACAO <= 20000 THEN 1
	WHEN   P.POPULACAO <= 50000 THEN 2
	WHEN   P.POPULACAO <= 100000 THEN 3
	WHEN   P.POPULACAO <= 900000 THEN 4
	ELSE 5
END) AS ID_PORTE,
'Pública' AS TIPO_UNIDADE,
1 AS ID_TIPO_UNIDADE,
UN.ID AS CODIGO_UNIDADE,
0 AS ID_DISTRITOS_SAO_PAULO,
NULL AS DISTRITOS_SAO_PAULO,
UN.CNPJ AS CNPJ,
UN.RAZAO_SOCIAL AS UNIDADE_RESPONSAVEL,
CAST(L.ID AS VARCHAR) AS ID_LOCAL,
L.NOME AS LOCAL_EXECUCAO,
L.CIDADE AS CIDADE,
U.NOME AS USUARIOS,
U.ID AS ID_USUARIO_TIPO_SERVICO,
S.NOME + (CASE WHEN R.DESCRICAO_NAO_TIPIFICADO IS NOT NULL AND  R.DESCRICAO_NAO_TIPIFICADO <> '' THEN ' - ' + R.DESCRICAO_NAO_TIPIFICADO ELSE '' END)  AS TIPO_SERVICO,
S.ID AS ID_TIPO_SERVICO,
TP.NOME AS PROTECAO_SOCIAL,
TP.ID AS ID_TIPO_PROTECAO,
SX.ID AS ID_SEXO,
SX.NOME AS SEXO,
RM.ID AS ID_REGIAO_MORADIA,
(CASE WHEN RM.ID = 3 THEN 'Zona Urbana e Rural' ELSE RM.NOME END) AS REGIAO_MORADIA,
CT.ID AS ID_CARACTERISTICAS_TERRITORIO,
CT.NOME AS CARACTERISTICAS_TERRITORIO,
SE.ID_SITUACAO_ESPECIFICA,
STE.NOME AS SITUACAO_ESPECIFICA,
STE.ID_SITUACAO_VULNERABILIDADE,
SV.NOME AS SITUACAO_VULNERABILIDADE,
R.VALOR_MUNICIPAL_ASSISTENCIA AS VALOR_FMAS,
R.VALOR_MUNICIPAL_FMDCA AS VALOR_FMDCA,
R.VALOR_ESTADUAL_ASSISTENCIA AS VALOR_FEAS,
R.VALOR_ESTADUAL_FEDCA AS VALOR_FEDCA,
R.VALOR_FEDERAL_ASSISTENCIA AS VALOR_FNAS,
R.VALOR_FEDERAL_FNDCA AS VALOR_FNDCA,
0 AS VALOR_PRIVADO,
COALESCE(R.VALOR_ESTADUALIZADO,0) AS VALOR_ESTADUALIZADO,
A.ABREVIACAO AS ABRANGENCIA,
A.ID AS ID_ABRANGENCIA,
R.NUMERO_ATENDIDOS_MENSAL,
R.NUMERO_ATENDIDOS AS NUMERO_ATENDIDOS_ANUAL,
R.TOTAL_FUNCIONARIOS AS TOTAL_TRABALHADORES_SERVICO,
COALESCE((L.TOTAL_NIVEL_FUNDAMENTAL + L.NIVEL_MEDIO + L.TOTAL_SUPERIOR + L.TOTAL_SEM_ESCOLARIDADE),0) AS TOTAL_TRABALHADORES,
isnull(R.VALOR_MUNICIPAL_FMI, 0.0) AS VALOR_FMI,
isnull(R.VALOR_ESTADUAL_FEI, 0.0) AS VALOR_FEI,
isnull(R.VALOR_FEDERAL_FNI, 0.0) AS VALOR_FNI,
AT.ID_ATIVIDADE_SOCIOASSISTENCIAL,
ATS.NOME AS ATIVIDADE_SOCIOASSISTENCIAL
FROM TB_PREFEITURA P
JOIN DBSEDS.DBO.TB_MUNICIPIOS MUN (NOLOCK) ON P.ID_MUNICIPIO = MUN.ID
JOIN DBSEDS.DBO.TB_DRADS DRA (NOLOCK) ON MUN.ID_DRADS = DRA.ID
INNER JOIN TB_UNIDADE_PUBLICA UN ON(UN.ID_PREFEITURA = P.ID)
INNER JOIN TB_LOCAL_EXECUCAO_PUBLICO L ON(L.ID_UNIDADE_PUBLICA = UN.ID)
INNER JOIN TB_SERVICOS_RECURSOS_FINANCEIROS_PUBLICO R ON(R.ID_LOCAL_EXECUCAO_PUBLICO = L.ID)
INNER JOIN TB_ABRANGENCIA_SERVICO A ON(R.ID_ABRANGENCIA_SERVICO = A.ID)
INNER JOIN TB_SERVICOS_RECURSOS_FINANCEIROS_PUBLICOxSITUACAO_ESPECIFICA SE ON(SE.ID_SERVICOS_RECURSOS_FINANCEIROS_PUBLICO = R.ID)
INNER JOIN TB_SITUACAO_ESPECIFICA STE ON(STE.ID = SE.ID_SITUACAO_ESPECIFICA)
INNER JOIN TB_SITUACAO_VULNERABILIDADE SV ON(STE.ID_SITUACAO_VULNERABILIDADE = SV.ID)
INNER JOIN TB_USUARIO_TIPO_SERVICO U ON (R.ID_USUARIO_TIPO_SERVICO = U.ID)
INNER JOIN TB_TIPO_SERVICO S ON (U.ID_TIPO_SERVICO = S.ID)
INNER JOIN TB_TIPO_PROTECAO TP ON(TP.ID = S.ID_TIPO_PROTECAO)
INNER JOIN TB_SEXO SX ON(SX.ID = R.ID_SEXO)
INNER JOIN TB_REGIAO_MORADIA RM ON(RM.ID = R.ID_REGIAO_MORADIA)
INNER JOIN TB_CARACTERISTICAS_TERRITORIO CT ON(CT.ID = R.ID_CARACTERISTICAS_TERRITORIO)
INNER JOIN TB_SERVICOS_RECURSOS_FINANCEIROS_PUBLICOxATIVIDADE_SOCIOASSISTENCIAL AT ON (AT.ID_SERVICOS_RECURSOS_FINANCEIROS_PUBLICO = R.ID)
INNER JOIN TB_ATIVIDADE_SOCIOASSISTENCIAL ATS ON (ATS.ID = AT.ID_ATIVIDADE_SOCIOASSISTENCIAL)

UNION ALL

SELECT 
P.ID AS ID_PREFEITURA,
MUN.ID AS ID_MUNICIPIO,
MUN.ID_DRADS,
MUN.NOME AS MUNICIPIO,
DRA.NOME AS DRADS,
COALESCE(MUN.ID_REGIAO_METROPOLITANA,-1) AS ID_REGIAO_METROPOLITANA,
DRA.ID_MACRO_REGIAO,
P.ID_NIVEL_GESTAO,
(CASE WHEN P.POPULACAO <= 20000 THEN 1
	WHEN   P.POPULACAO <= 50000 THEN 2
	WHEN   P.POPULACAO <= 100000 THEN 3
	WHEN   P.POPULACAO <= 900000 THEN 4
	ELSE 5
END) AS ID_PORTE,
'Privada' AS TIPO_UNIDADE,
2 AS ID_TIPO_UNIDADE,
UN.ID AS CODIGO_UNIDADE,
0 AS ID_DISTRITOS_SAO_PAULO,
NULL AS DISTRITO_SAO_PAULO,
UN.CNPJ AS CNPJ,
UN.RAZAO_SOCIAL AS UNIDADE_RESPONSAVEL,
CAST(L.ID AS VARCHAR) AS ID_LOCAL,
L.NOME AS LOCAL_EXECUCAO,
L.CIDADE AS CIDADE,
U.NOME AS USUARIOS,
U.ID AS ID_USUARIO_TIPO_SERVICO,
S.NOME + (CASE WHEN R.DESCRICAO_NAO_TIPIFICADO IS NOT NULL AND  R.DESCRICAO_NAO_TIPIFICADO <> '' THEN ' - ' + R.DESCRICAO_NAO_TIPIFICADO ELSE '' END)  AS TIPO_SERVICO,
S.ID AS ID_TIPO_SERVICO,
TP.NOME AS PROTECAO_SOCIAL,
TP.ID AS ID_TIPO_PROTECAO,
SX.ID AS ID_SEXO,
SX.NOME AS SEXO,
RM.ID AS ID_REGIAO_MORADIA,
(CASE WHEN RM.ID = 3 THEN 'Zona Urbana e Rural' ELSE RM.NOME END) AS REGIAO_MORADIA,
CT.ID AS ID_CARACTERISTICAS_TERRITORIO,
CT.NOME AS CARACTERISTICAS_TERRITORIO,
SE.ID_SITUACAO_ESPECIFICA,
STE.NOME AS SITUACAO_ESPECIFICA,
STE.ID_SITUACAO_VULNERABILIDADE,
SV.NOME AS SITUACAO_VULNERABILIDADE,
R.VALOR_MUNICIPAL_ASSISTENCIA AS VALOR_FMAS,
R.VALOR_MUNICIPAL_FMDCA AS VALOR_FMDCA,
R.VALOR_ESTADUAL_ASSISTENCIA AS VALOR_FEAS,
R.VALOR_ESTADUAL_FEDCA AS VALOR_FEDCA,
R.VALOR_FEDERAL_ASSISTENCIA AS VALOR_FNAS,
R.VALOR_FEDERAL_FNDCA AS VALOR_FNDCA,
(R.VALOR_PRIVADO_EMPRESAS + R.VALOR_PRIVADO_ORGANIZACOES + R.VALOR_PRIVADO_PESSOAS_FISICAS + R.VALOR_PRIVADO_PROPRIOS) AS VALOR_PRIVADO,
COALESCE(R.VALOR_ESTADUALIZADO,0) AS VALOR_ESTADUALIZADO,
A.ABREVIACAO AS ABRANGENCIA,
A.ID AS ID_ABRANGENCIA,
R.NUMERO_ATENDIDOS_MENSAL,
R.NUMERO_ATENDIDOS AS NUMERO_ATENDIDOS_ANUAL,
R.TOTAL_FUNCIONARIOS AS TOTAL_TRABALHADORES_SERVICO,
COALESCE((L.TOTAL_NIVEL_FUNDAMENTAL + L.NIVEL_MEDIO + L.TOTAL_SUPERIOR + L.TOTAL_SEM_ESCOLARIDADE),0) AS TOTAL_TRABALHADORES,
isnull(R.VALOR_MUNICIPAL_FMI, 0.0) AS VALOR_FMI,
isnull(R.VALOR_ESTADUAL_FEI, 0.0) AS VALOR_FEI,
isnull(R.VALOR_FEDERAL_FNI, 0.0) AS VALOR_FNI,
AT.ID_ATIVIDADE_SOCIOASSISTENCIAL,
ATS.NOME AS ATIVIDADE_SOCIOASSISTENCIAL
FROM TB_PREFEITURA P
JOIN DBSEDS.DBO.TB_MUNICIPIOS MUN (NOLOCK) ON P.ID_MUNICIPIO = MUN.ID
JOIN DBSEDS.DBO.TB_DRADS DRA (NOLOCK) ON MUN.ID_DRADS = DRA.ID
INNER JOIN TB_UNIDADE_PRIVADA UN ON(UN.ID_PREFEITURA = P.ID)
INNER JOIN TB_LOCAL_EXECUCAO_PRIVADO L ON(L.ID_UNIDADE_PRIVADA = UN.ID)
INNER JOIN TB_SERVICOS_RECURSOS_FINANCEIROS_PRIVADO R ON(R.ID_LOCAL_EXECUCAO_PRIVADO = L.ID)
INNER JOIN TB_ABRANGENCIA_SERVICO A ON(R.ID_ABRANGENCIA_SERVICO = A.ID)
INNER JOIN TB_SERVICOS_RECURSOS_FINANCEIROS_PRIVADOxSITUACAO_ESPECIFICA SE ON(SE.ID_SERVICOS_RECURSOS_FINANCEIROS_PRIVADO = R.ID)
INNER JOIN TB_SITUACAO_ESPECIFICA STE ON(STE.ID = SE.ID_SITUACAO_ESPECIFICA)
INNER JOIN TB_SITUACAO_VULNERABILIDADE SV ON(STE.ID_SITUACAO_VULNERABILIDADE = SV.ID)
INNER JOIN TB_USUARIO_TIPO_SERVICO U ON (R.ID_USUARIO_TIPO_SERVICO = U.ID)
INNER JOIN TB_TIPO_SERVICO S ON (U.ID_TIPO_SERVICO = S.ID)
INNER JOIN TB_TIPO_PROTECAO TP ON(TP.ID = S.ID_TIPO_PROTECAO)
INNER JOIN TB_SEXO SX ON(SX.ID = R.ID_SEXO)
INNER JOIN TB_REGIAO_MORADIA RM ON(RM.ID = R.ID_REGIAO_MORADIA)
INNER JOIN TB_CARACTERISTICAS_TERRITORIO CT ON(CT.ID = R.ID_CARACTERISTICAS_TERRITORIO)
INNER JOIN TB_SERVICOS_RECURSOS_FINANCEIROS_PRIVADOxATIVIDADE_SOCIOASSISTENCIAL AT ON (AT.ID_SERVICOS_RECURSOS_FINANCEIROS_PRIVADO = R.ID)
INNER JOIN TB_ATIVIDADE_SOCIOASSISTENCIAL ATS ON (ATS.ID = AT.ID_ATIVIDADE_SOCIOASSISTENCIAL)

UNION ALL

SELECT 
P.ID AS ID_PREFEITURA,
MUN.ID AS ID_MUNICIPIO,
MUN.ID_DRADS,
MUN.NOME AS MUNICIPIO,
DRA.NOME AS DRADS,
COALESCE(MUN.ID_REGIAO_METROPOLITANA,-1) AS ID_REGIAO_METROPOLITANA,
DRA.ID_MACRO_REGIAO,
P.ID_NIVEL_GESTAO,
(CASE WHEN P.POPULACAO <= 20000 THEN 1
	WHEN   P.POPULACAO <= 50000 THEN 2
	WHEN   P.POPULACAO <= 100000 THEN 3
	WHEN   P.POPULACAO <= 900000 THEN 4
	ELSE 5
END) AS ID_PORTE,
'Pública' AS TIPO_UNIDADE,
3 AS ID_TIPO_UNIDADE,
C.ID AS CODIGO_UNIDADE,
C.ID_DISTRITOS_SAO_PAULO AS ID_DISTRITOS_SAO_PAULO,
DS.NOME AS DISTRITO_SAO_PAULO,
UP.CNPJ AS CNPJ,
UP.RAZAO_SOCIAL AS UNIDADE_RESPONSAVEL,
C.IDCRAS AS ID_LOCAL,
C.NOME AS LOCAL_EXECUCAO,
C.CIDADE AS CIDADE,
U.NOME AS USUARIOS,
U.ID AS ID_USUARIO_TIPO_SERVICO,
S.NOME + (CASE WHEN R.DESCRICAO_NAO_TIPIFICADO IS NOT NULL AND  R.DESCRICAO_NAO_TIPIFICADO <> '' THEN ' - ' + R.DESCRICAO_NAO_TIPIFICADO ELSE '' END)  AS TIPO_SERVICO,
S.ID AS ID_TIPO_SERVICO,
TP.NOME AS PROTECAO_SOCIAL,
TP.ID AS ID_TIPO_PROTECAO,
SX.ID AS ID_SEXO,
SX.NOME AS SEXO,
RM.ID AS ID_REGIAO_MORADIA,
(CASE WHEN RM.ID = 3 THEN 'Zona Urbana e Rural' ELSE RM.NOME END) AS REGIAO_MORADIA,
CT.ID AS ID_CARACTERISTICAS_TERRITORIO,
CT.NOME AS CARACTERISTICAS_TERRITORIO,
SE.ID_SITUACAO_ESPECIFICA,
STE.NOME AS SITUACAO_ESPECIFICA,
STE.ID_SITUACAO_VULNERABILIDADE,
SV.NOME AS SITUACAO_VULNERABILIDADE,
R.VALOR_MUNICIPAL_ASSISTENCIA AS VALOR_FMAS,
R.VALOR_MUNICIPAL_FMDCA AS VALOR_FMDCA,
R.VALOR_ESTADUAL_ASSISTENCIA AS VALOR_FEAS,
R.VALOR_ESTADUAL_FEDCA AS VALOR_FEDCA,
R.VALOR_FEDERAL_ASSISTENCIA AS VALOR_FNAS,
R.VALOR_FEDERAL_FNDCA AS VALOR_FNDCA,
0 AS VALOR_PRIVADO,
COALESCE(R.VALOR_ESTADUALIZADO,0) AS VALOR_ESTADUALIZADO,
A.ABREVIACAO AS ABRANGENCIA,
A.ID AS ID_ABRANGENCIA,
R.NUMERO_ATENDIDOS_MENSAL,
R.NUMERO_ATENDIDOS AS NUMERO_ATENDIDOS_ANUAL,
R.TOTAL_FUNCIONARIOS AS TOTAL_TRABALHADORES_SERVICO,
COALESCE((C.TOTAL_NIVEL_FUNDAMENTAL + C.TOTAL_NIVEL_MEDIO + C.TOTAL_SUPERIOR + C.TOTAL_SEM_ESCOLARIDADE),0) AS TOTAL_TRABALHADORES,
isnull(R.VALOR_MUNICIPAL_FMI, 0.0) AS VALOR_FMI,
isnull(R.VALOR_ESTADUAL_FEI, 0.0) AS VALOR_FEI,
isnull(R.VALOR_FEDERAL_FNI, 0.0) AS VALOR_FNI,
AT.ID_ATIVIDADE_SOCIOASSISTENCIAL,
ATS.NOME AS ATIVIDADE_SOCIOASSISTENCIAL
FROM TB_PREFEITURA P
JOIN DBSEDS.DBO.TB_MUNICIPIOS MUN (NOLOCK) ON P.ID_MUNICIPIO = MUN.ID
JOIN DBSEDS.DBO.TB_DRADS DRA (NOLOCK) ON MUN.ID_DRADS = DRA.ID
INNER JOIN TB_UNIDADE_PUBLICA UP ON(UP.ID_PREFEITURA = P.ID)
INNER JOIN TB_CRAS C ON(C.ID_UNIDADE_PUBLICA = UP.ID)
INNER JOIN TB_SERVICOS_RECURSOS_FINANCEIROS_CRAS R ON(R.ID_CRAS = C.ID)
INNER JOIN TB_ABRANGENCIA_SERVICO A ON(R.ID_ABRANGENCIA_SERVICO = A.ID)
INNER JOIN TB_SERVICOS_RECURSOS_FINANCEIROS_CRASxSITUACAO_ESPECIFICA SE ON(SE.ID_SERVICOS_RECURSOS_FINANCEIROS_CRAS = R.ID)
INNER JOIN TB_SITUACAO_ESPECIFICA STE ON(STE.ID = SE.ID_SITUACAO_ESPECIFICA)
INNER JOIN TB_SITUACAO_VULNERABILIDADE SV ON(STE.ID_SITUACAO_VULNERABILIDADE = SV.ID)
INNER JOIN TB_USUARIO_TIPO_SERVICO U ON (R.ID_USUARIO_TIPO_SERVICO = U.ID)
INNER JOIN TB_TIPO_SERVICO S ON (U.ID_TIPO_SERVICO = S.ID)
INNER JOIN TB_TIPO_PROTECAO TP ON(TP.ID = S.ID_TIPO_PROTECAO)
INNER JOIN TB_SEXO SX ON(SX.ID = R.ID_SEXO)
INNER JOIN TB_REGIAO_MORADIA RM ON(RM.ID = R.ID_REGIAO_MORADIA)
INNER JOIN TB_CARACTERISTICAS_TERRITORIO CT ON(CT.ID = R.ID_CARACTERISTICAS_TERRITORIO)
INNER JOIN TB_SERVICOS_RECURSOS_FINANCEIROS_CRASxATIVIDADE_SOCIOASSISTENCIAL AT ON (AT.ID_SERVICOS_RECURSOS_FINANCEIROS_CRAS = R.ID)
INNER JOIN TB_ATIVIDADE_SOCIOASSISTENCIAL ATS ON (ATS.ID = AT.ID_ATIVIDADE_SOCIOASSISTENCIAL)
INNER JOIN TB_DISTRITOS_SAO_PAULO DS ON (DS.ID = C.ID_DISTRITOS_SAO_PAULO)

UNION ALL

SELECT 
P.ID AS ID_PREFEITURA,
MUN.ID AS ID_MUNICIPIO,
MUN.ID_DRADS,
MUN.NOME AS MUNICIPIO,
DRA.NOME AS DRADS,
COALESCE(MUN.ID_REGIAO_METROPOLITANA,-1) AS ID_REGIAO_METROPOLITANA,
DRA.ID_MACRO_REGIAO,
P.ID_NIVEL_GESTAO,
(CASE WHEN P.POPULACAO <= 20000 THEN 1
	WHEN   P.POPULACAO <= 50000 THEN 2
	WHEN   P.POPULACAO <= 100000 THEN 3
	WHEN   P.POPULACAO <= 900000 THEN 4
	ELSE 5
END) AS ID_PORTE,
'Pública' AS TIPO_UNIDADE,
4 AS ID_TIPO_UNIDADE,
C.ID AS CODIGO_UNIDADE,
C.ID_DISTRITOS_SAO_PAULO AS ID_DISTRITOS_SAO_PAULO,
DS.NOME AS DISTRITO_SAO_PAULO,
UP.CNPJ AS CNPJ,
UP.RAZAO_SOCIAL AS UNIDADE_RESPONSAVEL,
C.IDCREAS AS ID_LOCAL,
C.NOME AS LOCAL_EXECUCAO,
C.CIDADE AS CIDADE,
U.NOME AS USUARIOS,
U.ID AS ID_USUARIO_TIPO_SERVICO,
S.NOME + (CASE WHEN R.DESCRICAO_NAO_TIPIFICADO IS NOT NULL AND  R.DESCRICAO_NAO_TIPIFICADO <> '' THEN ' - ' + R.DESCRICAO_NAO_TIPIFICADO ELSE '' END)  AS TIPO_SERVICO,
S.ID AS ID_TIPO_SERVICO,
TP.NOME AS PROTECAO_SOCIAL,
TP.ID AS ID_TIPO_PROTECAO,
SX.ID AS ID_SEXO,
SX.NOME AS SEXO,
RM.ID AS ID_REGIAO_MORADIA,
(CASE WHEN RM.ID = 3 THEN 'Zona Urbana e Rural' ELSE RM.NOME END) AS REGIAO_MORADIA,
CT.ID AS ID_CARACTERISTICAS_TERRITORIO,
CT.NOME AS CARACTERISTICAS_TERRITORIO,
SE.ID_SITUACAO_ESPECIFICA,
STE.NOME AS SITUACAO_ESPECIFICA,
STE.ID_SITUACAO_VULNERABILIDADE,
SV.NOME AS SITUACAO_VULNERABILIDADE,
R.VALOR_MUNICIPAL_ASSISTENCIA AS VALOR_FMAS,
R.VALOR_MUNICIPAL_FMDCA AS VALOR_FMDCA,
R.VALOR_ESTADUAL_ASSISTENCIA AS VALOR_FEAS,
R.VALOR_ESTADUAL_FEDCA AS VALOR_FEDCA,
R.VALOR_FEDERAL_ASSISTENCIA AS VALOR_FNAS,
R.VALOR_FEDERAL_FNDCA AS VALOR_FNDCA,
0 AS VALOR_PRIVADO,
COALESCE(R.VALOR_ESTADUALIZADO,0) AS VALOR_ESTADUALIZADO,
A.ABREVIACAO AS ABRANGENCIA,
A.ID AS ID_ABRANGENCIA,
R.NUMERO_ATENDIDOS_MENSAL,
R.NUMERO_ATENDIDOS AS NUMERO_ATENDIDOS_ANUAL,
R.TOTAL_FUNCIONARIOS AS TOTAL_TRABALHADORES_SERVICO,
COALESCE((C.TOTAL_NIVEL_FUNDAMENTAL + C.TOTAL_NIVEL_MEDIO + C.TOTAL_SUPERIOR + C.TOTAL_SEM_ESCOLARIDADE),0) AS TOTAL_TRABALHADORES,
isnull(R.VALOR_MUNICIPAL_FMI, 0.0) AS VALOR_FMI,
isnull(R.VALOR_ESTADUAL_FEI, 0.0) AS VALOR_FEI,
isnull(R.VALOR_FEDERAL_FNI, 0.0) AS VALOR_FNI,
AT.ID_ATIVIDADE_SOCIOASSISTENCIAL,
ATS.NOME AS ATIVIDADE_SOCIOASSISTENCIAL
FROM TB_PREFEITURA P
JOIN DBSEDS.DBO.TB_MUNICIPIOS MUN (NOLOCK) ON P.ID_MUNICIPIO = MUN.ID
JOIN DBSEDS.DBO.TB_DRADS DRA (NOLOCK) ON MUN.ID_DRADS = DRA.ID
INNER JOIN TB_UNIDADE_PUBLICA UP ON(UP.ID_PREFEITURA = P.ID)
INNER JOIN TB_CREAS C ON(C.ID_UNIDADE_PUBLICA = UP.ID)
INNER JOIN TB_SERVICOS_RECURSOS_FINANCEIROS_CREAS R ON(R.ID_CREAS = C.ID)
INNER JOIN TB_ABRANGENCIA_SERVICO A ON(R.ID_ABRANGENCIA_SERVICO = A.ID)
INNER JOIN TB_SERVICOS_RECURSOS_FINANCEIROS_CREASxSITUACAO_ESPECIFICA SE ON(SE.ID_SERVICOS_RECURSOS_FINANCEIROS_CREAS = R.ID)
INNER JOIN TB_SITUACAO_ESPECIFICA STE ON(STE.ID = SE.ID_SITUACAO_ESPECIFICA)
INNER JOIN TB_SITUACAO_VULNERABILIDADE SV ON(STE.ID_SITUACAO_VULNERABILIDADE = SV.ID)
INNER JOIN TB_USUARIO_TIPO_SERVICO U ON (R.ID_USUARIO_TIPO_SERVICO = U.ID)
INNER JOIN TB_TIPO_SERVICO S ON (U.ID_TIPO_SERVICO = S.ID)
INNER JOIN TB_TIPO_PROTECAO TP ON(TP.ID = S.ID_TIPO_PROTECAO)
INNER JOIN TB_SEXO SX ON(SX.ID = R.ID_SEXO)
INNER JOIN TB_REGIAO_MORADIA RM ON(RM.ID = R.ID_REGIAO_MORADIA)
INNER JOIN TB_CARACTERISTICAS_TERRITORIO CT ON(CT.ID = R.ID_CARACTERISTICAS_TERRITORIO)
INNER JOIN TB_SERVICOS_RECURSOS_FINANCEIROS_CREASxATIVIDADE_SOCIOASSISTENCIAL AT ON (AT.ID_SERVICOS_RECURSOS_FINANCEIROS_CREAS = R.ID)
INNER JOIN TB_ATIVIDADE_SOCIOASSISTENCIAL ATS ON (ATS.ID = AT.ID_ATIVIDADE_SOCIOASSISTENCIAL)
INNER JOIN TB_DISTRITOS_SAO_PAULO DS  ON (DS.ID = C.ID_DISTRITOS_SAO_PAULO)


UNION ALL

SELECT 
P.ID AS ID_PREFEITURA,
MUN.ID AS ID_MUNICIPIO,
MUN.ID_DRADS,
MUN.NOME AS MUNICIPIO,
DRA.NOME AS DRADS,
COALESCE(MUN.ID_REGIAO_METROPOLITANA,-1) AS ID_REGIAO_METROPOLITANA,
DRA.ID_MACRO_REGIAO,
P.ID_NIVEL_GESTAO,
(CASE WHEN P.POPULACAO <= 20000 THEN 1
	WHEN   P.POPULACAO <= 50000 THEN 2
	WHEN   P.POPULACAO <= 100000 THEN 3
	WHEN   P.POPULACAO <= 900000 THEN 4
	ELSE 5
END) AS ID_PORTE,
'Pública' AS TIPO_UNIDADE,
5 AS ID_TIPO_UNIDADE,
C.ID AS CODIGO_UNIDADE,
C.ID_DISTRITOS_SAO_PAULO AS ID_DISTRITOS_SAO_PAULO,
DS.NOME AS DISTRITO_SAO_PAULO,
UP.CNPJ AS CNPJ,
UP.RAZAO_SOCIAL AS UNIDADE_RESPONSAVEL,
C.IDCREAS AS ID_LOCAL,
C.NOME AS LOCAL_EXECUCAO,
C.CIDADE AS CIDADE,
U.NOME AS USUARIOS,
U.ID AS ID_USUARIO_TIPO_SERVICO,
S.NOME + (CASE WHEN R.DESCRICAO_NAO_TIPIFICADO IS NOT NULL AND  R.DESCRICAO_NAO_TIPIFICADO <> '' THEN ' - ' + R.DESCRICAO_NAO_TIPIFICADO ELSE '' END)  AS TIPO_SERVICO,
S.ID AS ID_TIPO_SERVICO,
TP.NOME AS PROTECAO_SOCIAL,
TP.ID AS ID_TIPO_PROTECAO,
SX.ID AS ID_SEXO,
SX.NOME AS SEXO,
RM.ID AS ID_REGIAO_MORADIA,
(CASE WHEN RM.ID = 3 THEN 'Zona Urbana e Rural' ELSE RM.NOME END) AS REGIAO_MORADIA,
CT.ID AS ID_CARACTERISTICAS_TERRITORIO,
CT.NOME AS CARACTERISTICAS_TERRITORIO,
SE.ID_SITUACAO_ESPECIFICA,
STE.NOME AS SITUACAO_ESPECIFICA,
STE.ID_SITUACAO_VULNERABILIDADE,
SV.NOME AS SITUACAO_VULNERABILIDADE,
R.VALOR_MUNICIPAL_ASSISTENCIA AS VALOR_FMAS,
R.VALOR_MUNICIPAL_FMDCA AS VALOR_FMDCA,
R.VALOR_ESTADUAL_ASSISTENCIA AS VALOR_FEAS,
R.VALOR_ESTADUAL_FEDCA AS VALOR_FEDCA,
R.VALOR_FEDERAL_ASSISTENCIA AS VALOR_FNAS,
R.VALOR_FEDERAL_FNDCA AS VALOR_FNDCA,
0 AS VALOR_PRIVADO,
COALESCE(R.VALOR_ESTADUALIZADO,0) AS VALOR_ESTADUALIZADO,
A.ABREVIACAO AS ABRANGENCIA,
A.ID AS ID_ABRANGENCIA,
R.NUMERO_ATENDIDOS_MENSAL,
R.NUMERO_ATENDIDOS AS NUMERO_ATENDIDOS_ANUAL,
R.TOTAL_FUNCIONARIOS AS TOTAL_TRABALHADORES_SERVICO,
COALESCE((C.TOTAL_NIVEL_FUNDAMENTAL + C.TOTAL_NIVEL_MEDIO + C.TOTAL_SUPERIOR + C.TOTAL_SEM_ESCOLARIDADE),0) AS TOTAL_TRABALHADORES,
isnull(R.VALOR_MUNICIPAL_FMI, 0.0) AS VALOR_FMI,
isnull(R.VALOR_ESTADUAL_FEI, 0.0) AS VALOR_FEI,
isnull(R.VALOR_FEDERAL_FNI, 0.0) AS VALOR_FNI,
AT.ID_ATIVIDADE_SOCIOASSISTENCIAL,
ATS.NOME AS ATIVIDADE_SOCIOASSISTENCIAL
FROM TB_PREFEITURA P
JOIN DBSEDS.DBO.TB_MUNICIPIOS MUN (NOLOCK) ON P.ID_MUNICIPIO = MUN.ID
JOIN DBSEDS.DBO.TB_DRADS DRA (NOLOCK) ON MUN.ID_DRADS = DRA.ID
INNER JOIN TB_UNIDADE_PUBLICA UP ON(UP.ID_PREFEITURA = P.ID)
INNER JOIN TB_CENTRO_POP C ON(C.ID_UNIDADE_PUBLICA = UP.ID)
INNER JOIN TB_SERVICOS_RECURSOS_FINANCEIROS_CENTRO_POP R ON(R.ID_CENTRO_POP = C.ID)
INNER JOIN TB_ABRANGENCIA_SERVICO A ON(R.ID_ABRANGENCIA_SERVICO = A.ID)
INNER JOIN TB_SERVICOS_RECURSOS_FINANCEIROS_CENTRO_POPxSITUACAO_ESPECIFICA SE ON(SE.ID_SERVICOS_RECURSOS_FINANCEIROS_CENTRO_POP = R.ID)
INNER JOIN TB_SITUACAO_ESPECIFICA STE ON(STE.ID = SE.ID_SITUACAO_ESPECIFICA)
INNER JOIN TB_SITUACAO_VULNERABILIDADE SV ON(STE.ID_SITUACAO_VULNERABILIDADE = SV.ID)
INNER JOIN TB_USUARIO_TIPO_SERVICO U ON (R.ID_USUARIO_TIPO_SERVICO = U.ID)
INNER JOIN TB_TIPO_SERVICO S ON (U.ID_TIPO_SERVICO = S.ID)
INNER JOIN TB_TIPO_PROTECAO TP ON(TP.ID = S.ID_TIPO_PROTECAO)
INNER JOIN TB_SEXO SX ON(SX.ID = R.ID_SEXO)
INNER JOIN TB_REGIAO_MORADIA RM ON(RM.ID = R.ID_REGIAO_MORADIA)
INNER JOIN TB_CARACTERISTICAS_TERRITORIO CT ON(CT.ID = R.ID_CARACTERISTICAS_TERRITORIO)
INNER JOIN TB_SERVICOS_RECURSOS_FINANCEIROS_CENTRO_POPxATIVIDADE_SOCIOASSISTENCIAL AT ON (AT.ID_SERVICOS_RECURSOS_FINANCEIROS_CENTRO_POP = R.ID)
INNER JOIN TB_ATIVIDADE_SOCIOASSISTENCIAL ATS ON (ATS.ID = AT.ID_ATIVIDADE_SOCIOASSISTENCIAL)
INNER JOIN TB_DISTRITOS_SAO_PAULO DS ON (DS.ID = C.ID_DISTRITOS_SAO_PAULO)


GO


-----------------------------------------------------------------------------------------------------------------------------
-----------------------------------------------------------------------------------------------------------------------------
-----------1. Retirar a situação específica Pessoas com deficiência intelectual acima de 30 anos egressas.... -------------
-----------------------------------------------------------------------------------------------------------------------------
-----------------------------------------------------------------------------------------------------------------------------

 DELETE FROM [TB_USUARIO_TIPO_SERVICOxSITUACAO_ESPECIFICA]
 WHERE ID_SITUACAO_ESPECIFICA IN (SELECT ID FROM TB_SITUACAO_ESPECIFICA WHERE NOME = 'Pessoas com deficiência intelectual acima de 30 anos egressas dos convênios com a Secretaria de Educação')
 
 
DELETE from [TB_SITUACAO_ESPECIFICA] 
  WHERE NOME = 'Pessoas com deficiência intelectual acima de 30 anos egressas dos convênios com a Secretaria de Educação'


---------------------------------------------------------------------------------------------------------------------------
---------------------------------------------------------------------------------------------------------------------------
----------------------------Atualizando a Ordenação do TIPO Serviço--------------------------------------------------------
---------------------------------------------------------------------------------------------------------------------------
UPDATE [TB_TIPO_SERVICO] SET ORDEM = 103 
WHERE NOME = 'Outro'


--------------------------------------------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------------------------------------------
------------Incluir como opção de serviço não tipificado da Proteção Social Básica com o título --------------------------------------------
------------SCFV para pessoas com deficiência intelectual acima de 30 anos egressas dos convênios com a Secretaria de Educação.-----------
--------------------------------------------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------------------------------------------


INSERT INTO [TB_TIPO_SERVICO] (ID, NOME, ID_TIPO_PROTECAO, ORDEM, NAO_TIPIFICADO) VALUES
  (160, 'SCFV para pessoas com deficiência intelectual acima de 30 anos egressas dos convênios com a Secretaria de Educação',
  1, 102, 1) 


INSERT INTO [TB_USUARIO_TIPO_SERVICO] (NOME, ID_TIPO_SERVICO) VALUES ('pessoas com deficiencia', 160)


--------------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------------
----------2.	Acrescentar a situação específica Egressos de medidas de proteção previstas no ECA ---------
-------------   como opção para os serviços de Acolhimento em República.  ------------------------------------
--------------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------------

INSERT INTO [TB_ATIVIDADE_SOCIOASSISTENCIALxTIPO_SERVICO]
(ID_ATIVIDADE_SOCIOASSISTENCIAL, ID_TIPO_SERVICO) values (45, 150)

INSERT INTO TB_USUARIO_TIPO_SERVICOxSITUACAO_ESPECIFICA
  (ID_USUARIO_TIPO_SERVICO, ID_SITUACAO_ESPECIFICA) Values (45, 45)

  INSERT INTO TB_USUARIO_TIPO_SERVICOxSITUACAO_ESPECIFICA
  (ID_USUARIO_TIPO_SERVICO, ID_SITUACAO_ESPECIFICA) Values (46, 45)
   
   INSERT INTO TB_USUARIO_TIPO_SERVICOxSITUACAO_ESPECIFICA
  (ID_USUARIO_TIPO_SERVICO, ID_SITUACAO_ESPECIFICA) Values (47, 45)

  INSERT INTO TB_USUARIO_TIPO_SERVICOxSITUACAO_ESPECIFICA
  (ID_USUARIO_TIPO_SERVICO, ID_SITUACAO_ESPECIFICA) Values (48, 45)

  INSERT INTO TB_USUARIO_TIPO_SERVICOxSITUACAO_ESPECIFICA
  (ID_USUARIO_TIPO_SERVICO, ID_SITUACAO_ESPECIFICA) Values (49, 45)


-----------------------------------------------------------------------------------------------------------------------------------------
-----------------------------------------------------------------------------------------------------------------------------------------
------------- 3. No Serviço de atendimento especializado complementar ao PAEFI ofertado fora do CREAS, --------------------------------
-------------    da Proteção Especial de Média Complexidade, incluir a opção de usuários: mulheres em situação de violência. ----------
-----------------------------------------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------------------------------------------
 
INSERT INTO [TB_USUARIO_TIPO_SERVICOxSITUACAO_ESPECIFICA]
  (ID_USUARIO_TIPO_SERVICO, ID_SITUACAO_ESPECIFICA) VALUES (95, 3)

  
INSERT INTO [TB_USUARIO_TIPO_SERVICOxSITUACAO_ESPECIFICA]
  (ID_USUARIO_TIPO_SERVICO, ID_SITUACAO_ESPECIFICA) VALUES (95, 4)

  
INSERT INTO [TB_USUARIO_TIPO_SERVICOxSITUACAO_ESPECIFICA]
  (ID_USUARIO_TIPO_SERVICO, ID_SITUACAO_ESPECIFICA) VALUES (95, 33)

  
INSERT INTO [TB_USUARIO_TIPO_SERVICOxSITUACAO_ESPECIFICA]
  (ID_USUARIO_TIPO_SERVICO, ID_SITUACAO_ESPECIFICA) VALUES (95, 34)

  
INSERT INTO [TB_USUARIO_TIPO_SERVICOxSITUACAO_ESPECIFICA]
  (ID_USUARIO_TIPO_SERVICO, ID_SITUACAO_ESPECIFICA) VALUES (95, 38)

  
INSERT INTO [TB_USUARIO_TIPO_SERVICOxSITUACAO_ESPECIFICA]
  (ID_USUARIO_TIPO_SERVICO, ID_SITUACAO_ESPECIFICA) VALUES (95, 40)





INSERT INTO [TB_ATIVIDADE_SOCIOASSISTENCIALxTIPO_SERVICO]
 (ID_ATIVIDADE_SOCIOASSISTENCIAL, [ID_TIPO_SERVICO])
  VALUES ( 1 , 160)

INSERT INTO [TB_ATIVIDADE_SOCIOASSISTENCIALxTIPO_SERVICO]
 (ID_ATIVIDADE_SOCIOASSISTENCIAL, [ID_TIPO_SERVICO])
  VALUES ( 7 , 160)

INSERT INTO [TB_ATIVIDADE_SOCIOASSISTENCIALxTIPO_SERVICO]
 (ID_ATIVIDADE_SOCIOASSISTENCIAL, [ID_TIPO_SERVICO])
  VALUES ( 11 , 160)

INSERT INTO [TB_ATIVIDADE_SOCIOASSISTENCIALxTIPO_SERVICO]
 (ID_ATIVIDADE_SOCIOASSISTENCIAL, [ID_TIPO_SERVICO])
  VALUES ( 12 , 160)

INSERT INTO [TB_ATIVIDADE_SOCIOASSISTENCIALxTIPO_SERVICO]
 (ID_ATIVIDADE_SOCIOASSISTENCIAL, [ID_TIPO_SERVICO])
  VALUES ( 13 , 160)

INSERT INTO [TB_ATIVIDADE_SOCIOASSISTENCIALxTIPO_SERVICO]
 (ID_ATIVIDADE_SOCIOASSISTENCIAL, [ID_TIPO_SERVICO])
  VALUES ( 14 , 160)

INSERT INTO [TB_ATIVIDADE_SOCIOASSISTENCIALxTIPO_SERVICO]
 (ID_ATIVIDADE_SOCIOASSISTENCIAL, [ID_TIPO_SERVICO])
  VALUES ( 16 , 160)

INSERT INTO [TB_ATIVIDADE_SOCIOASSISTENCIALxTIPO_SERVICO]
 (ID_ATIVIDADE_SOCIOASSISTENCIAL, [ID_TIPO_SERVICO])
  VALUES ( 17 , 160)

INSERT INTO [TB_ATIVIDADE_SOCIOASSISTENCIALxTIPO_SERVICO]
 (ID_ATIVIDADE_SOCIOASSISTENCIAL, [ID_TIPO_SERVICO])
  VALUES ( 18 , 160)

INSERT INTO [TB_ATIVIDADE_SOCIOASSISTENCIALxTIPO_SERVICO]
 (ID_ATIVIDADE_SOCIOASSISTENCIAL, [ID_TIPO_SERVICO])
  VALUES ( 19 , 160)







INSERT INTO [TB_ATIVIDADE_SOCIOASSISTENCIALxTIPO_SERVICO]
 (ID_ATIVIDADE_SOCIOASSISTENCIAL, [ID_TIPO_SERVICO])
  VALUES ( 20 , 160)

INSERT INTO [TB_ATIVIDADE_SOCIOASSISTENCIALxTIPO_SERVICO]
 (ID_ATIVIDADE_SOCIOASSISTENCIAL, [ID_TIPO_SERVICO])
  VALUES ( 21 , 160)

INSERT INTO [TB_ATIVIDADE_SOCIOASSISTENCIALxTIPO_SERVICO]
 (ID_ATIVIDADE_SOCIOASSISTENCIAL, [ID_TIPO_SERVICO])
  VALUES ( 22 , 160)

INSERT INTO [TB_ATIVIDADE_SOCIOASSISTENCIALxTIPO_SERVICO]
 (ID_ATIVIDADE_SOCIOASSISTENCIAL, [ID_TIPO_SERVICO])
  VALUES ( 23 , 160)

INSERT INTO [TB_ATIVIDADE_SOCIOASSISTENCIALxTIPO_SERVICO]
 (ID_ATIVIDADE_SOCIOASSISTENCIAL, [ID_TIPO_SERVICO])
  VALUES ( 28 , 160)

INSERT INTO [TB_ATIVIDADE_SOCIOASSISTENCIALxTIPO_SERVICO]
 (ID_ATIVIDADE_SOCIOASSISTENCIAL, [ID_TIPO_SERVICO])
  VALUES ( 38 , 160)

INSERT INTO [TB_ATIVIDADE_SOCIOASSISTENCIALxTIPO_SERVICO]
 (ID_ATIVIDADE_SOCIOASSISTENCIAL, [ID_TIPO_SERVICO])
  VALUES ( 39 , 160)

INSERT INTO [TB_ATIVIDADE_SOCIOASSISTENCIALxTIPO_SERVICO]
 (ID_ATIVIDADE_SOCIOASSISTENCIAL, [ID_TIPO_SERVICO])
  VALUES ( 40 , 160)
  
INSERT INTO [TB_ATIVIDADE_SOCIOASSISTENCIALxTIPO_SERVICO]
 (ID_ATIVIDADE_SOCIOASSISTENCIAL, [ID_TIPO_SERVICO])
  VALUES ( 41 , 160)

INSERT INTO [TB_ATIVIDADE_SOCIOASSISTENCIALxTIPO_SERVICO]
 (ID_ATIVIDADE_SOCIOASSISTENCIAL, [ID_TIPO_SERVICO])
  VALUES ( 42 , 160)

INSERT INTO [TB_ATIVIDADE_SOCIOASSISTENCIALxTIPO_SERVICO]
 (ID_ATIVIDADE_SOCIOASSISTENCIAL, [ID_TIPO_SERVICO])
  VALUES ( 43 , 160)



------------------------------------------------------------------------------------------------------------------------------------
------------------------------------------------------------------------------------------------------------------------------------
---------- 3.	No Serviço de atendimento especializado complementar ao PAEFI ofertado fora do CREAS, ----------------------------
---------- da Proteção Especial de Média Complexidade, incluir a opção de usuários: mulheres em situação de violência ------------
------------------------------------------------------------------------------------------------------------------------------------
------------------------------------------------------------------------------------------------------------------------------------

INSERT INTO TB_USUARIO_TIPO_SERVICO (NOME , ID_TIPO_SERVICO)
 Values ('mulheres em situação de violência', 158)

INSERT INTO [TB_USUARIO_TIPO_SERVICOxSITUACAO_ESPECIFICA]
  (ID_USUARIO_TIPO_SERVICO, ID_SITUACAO_ESPECIFICA) VALUES (96, 14)

  
INSERT INTO [TB_USUARIO_TIPO_SERVICOxSITUACAO_ESPECIFICA]
  (ID_USUARIO_TIPO_SERVICO, ID_SITUACAO_ESPECIFICA) VALUES (96, 15)

  
INSERT INTO [TB_USUARIO_TIPO_SERVICOxSITUACAO_ESPECIFICA]
  (ID_USUARIO_TIPO_SERVICO, ID_SITUACAO_ESPECIFICA) VALUES (96, 16)

  
INSERT INTO [TB_USUARIO_TIPO_SERVICOxSITUACAO_ESPECIFICA]
  (ID_USUARIO_TIPO_SERVICO, ID_SITUACAO_ESPECIFICA) VALUES (96, 17)

  
INSERT INTO [TB_USUARIO_TIPO_SERVICOxSITUACAO_ESPECIFICA]
  (ID_USUARIO_TIPO_SERVICO, ID_SITUACAO_ESPECIFICA) VALUES (96, 18)

  
INSERT INTO [TB_USUARIO_TIPO_SERVICOxSITUACAO_ESPECIFICA]
  (ID_USUARIO_TIPO_SERVICO, ID_SITUACAO_ESPECIFICA) VALUES (96, 19)

  INSERT INTO [TB_USUARIO_TIPO_SERVICOxSITUACAO_ESPECIFICA]
  (ID_USUARIO_TIPO_SERVICO, ID_SITUACAO_ESPECIFICA) VALUES (96, 20)

  
INSERT INTO [TB_USUARIO_TIPO_SERVICOxSITUACAO_ESPECIFICA]
  (ID_USUARIO_TIPO_SERVICO, ID_SITUACAO_ESPECIFICA) VALUES (96, 6)

  
INSERT INTO [TB_USUARIO_TIPO_SERVICOxSITUACAO_ESPECIFICA]
  (ID_USUARIO_TIPO_SERVICO, ID_SITUACAO_ESPECIFICA) VALUES (96, 7)

  
INSERT INTO [TB_USUARIO_TIPO_SERVICOxSITUACAO_ESPECIFICA]
  (ID_USUARIO_TIPO_SERVICO, ID_SITUACAO_ESPECIFICA) VALUES (96, 8)

  
INSERT INTO [TB_USUARIO_TIPO_SERVICOxSITUACAO_ESPECIFICA]
  (ID_USUARIO_TIPO_SERVICO, ID_SITUACAO_ESPECIFICA) VALUES (96, 26)

  
INSERT INTO [TB_USUARIO_TIPO_SERVICOxSITUACAO_ESPECIFICA]
  (ID_USUARIO_TIPO_SERVICO, ID_SITUACAO_ESPECIFICA) VALUES (96, 27)

  INSERT INTO [TB_USUARIO_TIPO_SERVICOxSITUACAO_ESPECIFICA]
  (ID_USUARIO_TIPO_SERVICO, ID_SITUACAO_ESPECIFICA) VALUES (96, 9)

  
INSERT INTO [TB_USUARIO_TIPO_SERVICOxSITUACAO_ESPECIFICA]
  (ID_USUARIO_TIPO_SERVICO, ID_SITUACAO_ESPECIFICA) VALUES (96, 13)

  
INSERT INTO [TB_USUARIO_TIPO_SERVICOxSITUACAO_ESPECIFICA]
  (ID_USUARIO_TIPO_SERVICO, ID_SITUACAO_ESPECIFICA) VALUES (96, 23)

  
INSERT INTO [TB_USUARIO_TIPO_SERVICOxSITUACAO_ESPECIFICA]
  (ID_USUARIO_TIPO_SERVICO, ID_SITUACAO_ESPECIFICA) VALUES (96, 24)

  
INSERT INTO [TB_USUARIO_TIPO_SERVICOxSITUACAO_ESPECIFICA]
  (ID_USUARIO_TIPO_SERVICO, ID_SITUACAO_ESPECIFICA) VALUES (96, 35)

  
INSERT INTO [TB_USUARIO_TIPO_SERVICOxSITUACAO_ESPECIFICA]
  (ID_USUARIO_TIPO_SERVICO, ID_SITUACAO_ESPECIFICA) VALUES (96, 36)

    
INSERT INTO [TB_USUARIO_TIPO_SERVICOxSITUACAO_ESPECIFICA]
  (ID_USUARIO_TIPO_SERVICO, ID_SITUACAO_ESPECIFICA) VALUES (96, 37)

      
INSERT INTO [TB_USUARIO_TIPO_SERVICOxSITUACAO_ESPECIFICA]
  (ID_USUARIO_TIPO_SERVICO, ID_SITUACAO_ESPECIFICA) VALUES (96, 42)


----------------------------------------------------------------
----------------------------------------------------------------

ALTER TABLE [dbo].[TB_FUNDO_MUNICIPAL] 
ADD [ALTERACAO_LEI] [bit] NULL



---------------------------------------------------------------------------------------------------------------
---------------------------------------------------------------------------------------------------------------
---------------------------------------------------------------------------------------------------------------
-------- Dar opção para indicar mais de uma unidade privada como executora de Beneficio Eventual. -------------
---------------------------------------------------------------------------------------------------------------
---------------------------------------------------------------------------------------------------------------
---------------------------------------------------------------------------------------------------------------

/****** Object:  Table [dbo].[TB_PREFEITURA_BENEFICIO_EVENTUALxUNIDADE_PRIVADA]    Script Date: 11/09/2014 16:30:03 ******/
SET ANSI_NULLS ON
GO

SET QUOTED_IDENTIFIER ON
GO

CREATE TABLE [dbo].[TB_PREFEITURA_BENEFICIO_EVENTUALxUNIDADE_PRIVADA](
	[ID_PREFEITURA_BENEFICIO_EVENTUAL] [int] NOT NULL,
	[ID_UNIDADE_PRIVADA] [int] NOT NULL,
 CONSTRAINT [PK_TB_PREFEITURA_BENEFICIO_EVENTUALxUNIDADE_PRIVADA] PRIMARY KEY CLUSTERED 
(
	[ID_PREFEITURA_BENEFICIO_EVENTUAL] ASC,
	[ID_UNIDADE_PRIVADA] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY]

GO

ALTER TABLE [dbo].[TB_PREFEITURA_BENEFICIO_EVENTUALxUNIDADE_PRIVADA]  WITH CHECK ADD  CONSTRAINT [FK_TB_PREFEITURA_BENEFICIO_EVENTUALxUNIDADE_PRIVADA_TB_PREFEITURA_BENEFICIO_EVENTUAL] FOREIGN KEY([ID_UNIDADE_PRIVADA])
REFERENCES [dbo].[TB_UNIDADE_PRIVADA] ([ID])
GO

ALTER TABLE [dbo].[TB_PREFEITURA_BENEFICIO_EVENTUALxUNIDADE_PRIVADA] CHECK CONSTRAINT [FK_TB_PREFEITURA_BENEFICIO_EVENTUALxUNIDADE_PRIVADA_TB_PREFEITURA_BENEFICIO_EVENTUAL]
GO

ALTER TABLE [dbo].[TB_PREFEITURA_BENEFICIO_EVENTUALxUNIDADE_PRIVADA]  WITH CHECK ADD  CONSTRAINT [FK_TB_PREFEITURA_BENEFICIO_EVENTUALxUNIDADE_PRIVADA_TB_UNIDADE_PRIVADA] FOREIGN KEY([ID_PREFEITURA_BENEFICIO_EVENTUAL])
REFERENCES [dbo].[TB_PREFEITURA_BENEFICIO_EVENTUAL] ([ID])
GO

ALTER TABLE [dbo].[TB_PREFEITURA_BENEFICIO_EVENTUALxUNIDADE_PRIVADA] CHECK CONSTRAINT [FK_TB_PREFEITURA_BENEFICIO_EVENTUALxUNIDADE_PRIVADA_TB_UNIDADE_PRIVADA]
GO

--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
----------------------- Houve alteração na Lei de criação?, ao escolher a opção sim abrir o campo de data. ------------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

ALTER TABLE dbo.TB_FUNDO_MUNICIPAL
ADD [ALTERACAO_LEI] [bit] NULL
	
ALTER TABLE dbo.TB_FUNDO_MUNICIPAL	
ADD [LEI_ALTERADA] [varchar](20) NULL
	
ALTER TABLE dbo.TB_FUNDO_MUNICIPAL	
ADD [DATA_LEI_ALTERADA] [datetime] NULL


--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
----------------------- incluir Questão O Órgão Gestor mantém equipe específica para gestão de Benefícios e programas de transferência de renda?  ------------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

ALTER TABLE dbo.TB_ORGAO_GESTOR
ADD	[POSSUI_EQUIPE_GESTAO_BENEFICIOS] [bit] NULL

ALTER TABLE dbo.TB_ORGAO_GESTOR
ADD	[EQUIPE_GESTAO_BENEFICIO] [int] NULL


--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
----------------------- Quadro 39: retirar campo Validade e inserir campos Situação da Inscrição e Situação Atual. Detalhado abaixo.                                      ------------------------------------------------
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------




/****** Object:  Table [dbo].[TB_SITUACAO_INSCRICAO]    Script Date: 12/09/2014 16:45:09 ******/
SET ANSI_NULLS ON
GO

SET QUOTED_IDENTIFIER ON
GO

SET ANSI_PADDING ON
GO

CREATE TABLE [dbo].[TB_SITUACAO_INSCRICAO](
	[ID] [int] IDENTITY(1,1) NOT NULL,
	[NOME] [varchar](250) NOT NULL,
 CONSTRAINT [PK_TB_SITUACAO_INSCRICAO] PRIMARY KEY CLUSTERED 
(
	[ID] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY]

GO

SET ANSI_PADDING OFF
GO

INSERT INTO dbo.TB_SITUACAO_INSCRICAO (NOME) VALUES ('Deferida em:')
GO
INSERT INTO dbo.TB_SITUACAO_INSCRICAO (NOME) VALUES ('Indeferida em:')
GO
INSERT INTO dbo.TB_SITUACAO_INSCRICAO (NOME) VALUES ('Não Solicitada')
GO



/****** Object:  Table [dbo].[TB_SITUACAO_ATUAL_INSCRICAO]    Script Date: 17/09/2014 11:33:52 ******/
SET ANSI_NULLS ON
GO

SET QUOTED_IDENTIFIER ON
GO

SET ANSI_PADDING ON
GO

CREATE TABLE [dbo].[TB_SITUACAO_ATUAL_INSCRICAO](
	[ID] [int] IDENTITY(1,1) NOT NULL,
	[NOME] [varchar](250) NOT NULL,
 CONSTRAINT [PK_TB_SITUACAO_INSCRICAO_ATUAL] PRIMARY KEY CLUSTERED 
(
	[ID] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY]

GO

SET ANSI_PADDING OFF
GO



INSERT INTO TB_SITUACAO_ATUAL_INSCRICAO (NOME) Values ('Regular')

INSERT INTO TB_SITUACAO_ATUAL_INSCRICAO (NOME) Values ('Documentação desatualizada')

INSERT INTO TB_SITUACAO_ATUAL_INSCRICAO (NOME) Values ('Oferta interrompida')

INSERT INTO TB_SITUACAO_ATUAL_INSCRICAO (NOME) Values ('Cancelada')




ALTER TABLE [dbo].[TB_UNIDADE_PRIVADA] 
ADD [ID_SITUACAO_INSCRICAO] [int] NULL
GO

ALTER TABLE [dbo].[TB_UNIDADE_PRIVADA] A
DD [ID_SITUACAO_ATUAL_INSCRICAO] [int] NULL
GO

ALTER TABLE [dbo].[TB_UNIDADE_PRIVADA]  WITH CHECK ADD  CONSTRAINT [FK_TB_UNIDADE_PRIVADA_TB_SITUACAO_ATUAL_INSCRICAO] FOREIGN KEY([ID_SITUACAO_ATUAL_INSCRICAO])
REFERENCES [dbo].[TB_SITUACAO_ATUAL_INSCRICAO] ([ID])
GO

ALTER TABLE [dbo].[TB_UNIDADE_PRIVADA] CHECK CONSTRAINT [FK_TB_UNIDADE_PRIVADA_TB_SITUACAO_ATUAL_INSCRICAO]
GO

ALTER TABLE [dbo].[TB_UNIDADE_PRIVADA]  WITH CHECK ADD  CONSTRAINT [FK_TB_UNIDADE_PRIVADA_TB_SITUACAO_INSCRICAO] FOREIGN KEY([ID_SITUACAO_INSCRICAO])
REFERENCES [dbo].[TB_SITUACAO_INSCRICAO] ([ID])
GO

ALTER TABLE [dbo].[TB_UNIDADE_PRIVADA] CHECK CONSTRAINT [FK_TB_UNIDADE_PRIVADA_TB_SITUACAO_INSCRICAO]
GO


----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
---------------------------------- incluir opção 2015 no quadro 46 ---------------------------------------------------------------------------------------------------------------------------------------------
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

 ALTER TABLE TB_PROGRAMA_PROJETO
ADD SP_SOLIDARIO_AGENDA_FAMILIA_NUMERO_FAMILIAS_2015 INT NULL



----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
---------------------------------- inclusão do cronograma de programa/beneficio no menu ------------------------------------------------------------------------------------------------------------------------
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 INSERT INTO [dbo].[TB_RECURSO] (ID, NOME, PAGINA, ID_PAI, ORDEM) VALUES (69, 'Cronograma de desembolso - Programa/Benefício', 'BlocoV/FCronogramaDesembolso.aspx?idTipo=R5MlZqiAXsNujg18CeIvlQ%3d%3d', 6, 4)

----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
---------------------------------- inclusão do cronograma de programa/beneficio de acordo com perfil de usuario ------------------------------------------------------------------------------------------------
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
  INSERT INTO [dbo].[TB_RECURSOxPERFIL] (ID_RECURSO, ID_PERFIL) VALUES (69, 26)
  INSERT INTO [dbo].[TB_RECURSOxPERFIL] (ID_RECURSO, ID_PERFIL) VALUES (69, 27)
  INSERT INTO [dbo].[TB_RECURSOxPERFIL] (ID_RECURSO, ID_PERFIL) VALUES (69, 28)
  INSERT INTO [dbo].[TB_RECURSOxPERFIL] (ID_RECURSO, ID_PERFIL) VALUES (69, 29)
  INSERT INTO [dbo].[TB_RECURSOxPERFIL] (ID_RECURSO, ID_PERFIL) VALUES (69, 30)
  INSERT INTO [dbo].[TB_RECURSOxPERFIL] (ID_RECURSO, ID_PERFIL) VALUES (69, 31)
  INSERT INTO [dbo].[TB_RECURSOxPERFIL] (ID_RECURSO, ID_PERFIL) VALUES (69, 32)
  INSERT INTO [dbo].[TB_RECURSOxPERFIL] (ID_RECURSO, ID_PERFIL) VALUES (69, 33)

----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
---------------------------------- inclusão do cronograma de programa/beneficio de acordo com perfil de usuario ------------------------------------------------------------------------------------------------
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
INSERT INTO [dbo].[TB_SITUACAO_ESPECIFICA] (ID,ID_SITUACAO_VULNERABILIDADE, NOME) VALUES (49, 14, 'Pessoas e seus acompanhantes em trânsito durante o tratamento de doença grave')


INSERT [dbo].[TB_USUARIO_TIPO_SERVICOxSITUACAO_ESPECIFICA] (ID_USUARIO_TIPO_SERVICO, ID_SITUACAO_ESPECIFICA)
VALUES (43, 49)




-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
----------------------------------------------- Cronograma de programas/benefícios ------------------------------------------------------------------------------------------------------------------------------------------------------------------
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------


SET ANSI_NULLS ON
GO

SET QUOTED_IDENTIFIER ON
GO


ALTER PROCEDURE [dbo].[PR_COFINANCIAMENTO_ESTADUAL]
	@ID_TIPO_PROTECAO  INT, @ID_PREFEITURA INT
AS  
  if @ID_TIPO_PROTECAO = 4
	begin

  SELECT * FROM (
  SELECT 0 AS ID		
		,0 AS ID_UNIDADE
		,1 AS ID_TIPO_UNIDADE
		,'Publica' AS TIPO_UNIDADE
		,'Programa São Paulo Solidário - Etapa de Busca Ativa' AS UNIDADE
		,0 AS ID_USUARIO_TIPO_SERVICO
		,'' AS USUARIO
		,0 AS ID_TIPO_SERVICO
		,''  AS TIPO_SERVICO
		,CAST(1 AS SMALLINT) AS ID_TIPO_PROTECAO
		,'' AS PROTECAO_SOCIAL
		,0 AS NUMERO_ATENDIDOS
		,'' AS ABRANGENCIA
		,CAST(0 as BIT) AS SERVICO_ESTADUALIZADO
		,COALESCE((T.SP_SOLIDARIO_BUSCA_ATIVA_VALOR_FEAS),0) AS PREVISAO_ORCAMENTARIA
		,1 AS ORDEM
	 
  FROM TB_PROGRAMA_PROJETO T
  WHERE @ID_TIPO_PROTECAO = 1 AND T.ID_PREFEITURA = @ID_PREFEITURA AND T.PROGRAMA_ESTADUAL = 1 AND T.NOME like '%São Paulo Solidário%' AND T.ID_FASE_PROGRAMA_TRANSFERENCIA_RENDA_SP_SOLIDARIO >= 1
  AND T.SP_SOLIDARIO_BUSCA_ATIVA_ANO_TERMINO = 2014 AND (T.SP_SOLIDARIO_ANO_REPASSE_FEAS_BUSCA_ATIVA = 2014 OR (T.SP_SOLIDARIO_ANO_REPASSE_FEAS_BUSCA_ATIVA = 2013 AND T.SP_SOLIDARIO_VALOR_FEAS_RETIDO_FMAS_2014 = 1))
  AND T.SP_SOLIDARIO_BUSCA_ATIVA_VALOR_FEAS IS NOT NULL AND T.SP_SOLIDARIO_BUSCA_ATIVA_VALOR_FEAS > 0

  UNION ALL  

  SELECT 0 AS ID		
		,0 AS ID_UNIDADE
		,1 AS ID_TIPO_UNIDADE
		,'Publica'  AS TIPO_UNIDADE
		,'Programa São Paulo Solidário - Etapa de Além da Renda' AS UNIDADE
		,0 AS ID_USUARIO_TIPO_SERVICO
		,'' AS USUARIO
		,0 AS ID_TIPO_SERVICO
		,''  AS TIPO_SERVICO
		,CAST(1 AS SMALLINT) AS ID_TIPO_PROTECAO
		,'' AS PROTECAO_SOCIAL
		,0 AS NUMERO_ATENDIDOS
		,'' AS ABRANGENCIA
		,CAST(0 as BIT) AS SERVICO_ESTADUALIZADO
		,COALESCE((T.SP_SOLIDARIO_AGENDA_FAMILIA_VALOR_FEAS),0) AS PREVISAO_ORCAMENTARIA
		,2 AS ORDEM
	 
  FROM TB_PROGRAMA_PROJETO T
  WHERE T.ID_PREFEITURA = @ID_PREFEITURA AND T.PROGRAMA_ESTADUAL = 1 AND T.NOME like '%São Paulo Solidário%' AND T.ID_FASE_PROGRAMA_TRANSFERENCIA_RENDA_SP_SOLIDARIO = 3
  AND (T.SP_SOLIDARIO_ANO_REPASSE_FEAS_AGENDA_FAMILIA = 2014 OR (T.SP_SOLIDARIO_ANO_REPASSE_FEAS_AGENDA_FAMILIA = 2013 AND T.SP_SOLIDARIO_VALOR_FEAS_RETIDO_FMAS_2014_AGENDA_FAMILIA = 1))
  AND T.SP_SOLIDARIO_AGENDA_FAMILIA_VALOR_FEAS IS NOT NULL AND T.SP_SOLIDARIO_AGENDA_FAMILIA_VALOR_FEAS > 0

  UNION ALL  

  SELECT 0 AS ID		
		,0 AS ID_UNIDADE
		,1 AS ID_TIPO_UNIDADE
		,'Publica'  AS TIPO_UNIDADE
		,'Implantação de CRAS conforme Resolução SEDS-004, de 25/03/2014' AS UNIDADE
		,0 AS ID_USUARIO_TIPO_SERVICO
		,'' AS USUARIO
		,0 AS ID_TIPO_SERVICO
		,''  AS TIPO_SERVICO
		,CAST(1 AS SMALLINT) AS ID_TIPO_PROTECAO
		,'' AS PROTECAO_SOCIAL
		,0 AS NUMERO_ATENDIDOS
		,'' AS ABRANGENCIA
		,CAST(0 as BIT) AS SERVICO_ESTADUALIZADO
		,ISNULL(AP.VALOR_FEAS, 0.0) AS PREVISAO_ORCAMENTARIA
		,3 AS ORDEM
	 
  FROM TB_PREFEITURA_ACAO_PLANEJAMENTO AP
  WHERE AP.ID_PREFEITURA = @ID_PREFEITURA AND AP.ID_ACAO_PLANEJAMENTO = 26 AND ISNULL(AP.VALOR_FEAS, 0.0) > 0.0

  UNION ALL  

  SELECT 0 AS ID		
		,0 AS ID_UNIDADE
		,1 AS ID_TIPO_UNIDADE
		,'Publica' AS TIPO_UNIDADE
		,'Benefício Eventual - Auxílio Natalidade' AS UNIDADE
		,0 AS ID_USUARIO_TIPO_SERVICO
		,'' AS USUARIO
		,0 AS ID_TIPO_SERVICO
		,''  AS TIPO_SERVICO
		,CAST(1 AS SMALLINT) AS ID_TIPO_PROTECAO
		,'' AS PROTECAO_SOCIAL
		,0 AS NUMERO_ATENDIDOS
		,'' AS ABRANGENCIA
		,CAST(0 as BIT) AS SERVICO_ESTADUALIZADO
		,ISNULL((T.VALOR_FEAS),0.0) AS PREVISAO_ORCAMENTARIA
		,4 AS ORDEM
	 
  FROM TB_PREFEITURA_BENEFICIO_EVENTUAL T
  WHERE T.ID_PREFEITURA = @ID_PREFEITURA AND T.ID_TIPO_BENEFICIO_EVENTUAL = 1 AND ISNULL((T.VALOR_FEAS),0.0) > 0

  UNION ALL  

  SELECT 0 AS ID		
		,0 AS ID_UNIDADE
		,1 AS ID_TIPO_UNIDADE
		,'Publica'  AS TIPO_UNIDADE
		,'Benefício Eventual - Auxílio Funeral' AS UNIDADE
		,0 AS ID_USUARIO_TIPO_SERVICO
		,'' AS USUARIO
		,0 AS ID_TIPO_SERVICO
		,''  AS TIPO_SERVICO
		,CAST(1 AS SMALLINT) AS ID_TIPO_PROTECAO
		,'' AS PROTECAO_SOCIAL
		,0 AS NUMERO_ATENDIDOS
		,'' AS ABRANGENCIA
		,CAST(0 as BIT) AS SERVICO_ESTADUALIZADO
		,ISNULL((T.VALOR_FEAS),0.0) AS PREVISAO_ORCAMENTARIA
		,4 AS ORDEM
	 
  FROM TB_PREFEITURA_BENEFICIO_EVENTUAL T
  WHERE T.ID_PREFEITURA = @ID_PREFEITURA AND T.ID_TIPO_BENEFICIO_EVENTUAL = 2 AND ISNULL((T.VALOR_FEAS),0.0) > 0

  UNION ALL  

  SELECT 0 AS ID		
		,0 AS ID_UNIDADE
		,1 AS ID_TIPO_UNIDADE
		,'Publica'  AS TIPO_UNIDADE
		,'Benefício Eventual - Calamidades Públicas e Emergências' AS UNIDADE
		,0 AS ID_USUARIO_TIPO_SERVICO
		,'' AS USUARIO
		,0 AS ID_TIPO_SERVICO
		,''  AS TIPO_SERVICO
		,CAST(1 AS SMALLINT) AS ID_TIPO_PROTECAO
		,'' AS PROTECAO_SOCIAL
		,0 AS NUMERO_ATENDIDOS
		,'' AS ABRANGENCIA
		,CAST(0 as BIT) AS SERVICO_ESTADUALIZADO
		,ISNULL((T.VALOR_FEAS),0.0) AS PREVISAO_ORCAMENTARIA
		,4 AS ORDEM
	 
  FROM TB_PREFEITURA_BENEFICIO_EVENTUAL T
  WHERE T.ID_PREFEITURA = @ID_PREFEITURA AND T.ID_TIPO_BENEFICIO_EVENTUAL = 3 AND ISNULL((T.VALOR_FEAS),0.0) > 0

  UNION ALL  

  SELECT 0 AS ID		
		,0 AS ID_UNIDADE
		,1 AS ID_TIPO_UNIDADE
		,'Publica' AS TIPO_UNIDADE
		,'Benefício Eventual - Vulnerabilidade Temporária' AS UNIDADE
		,0 AS ID_USUARIO_TIPO_SERVICO
		,'' AS USUARIO
		,0 AS ID_TIPO_SERVICO
		,''  AS TIPO_SERVICO
		,CAST(1 AS SMALLINT) AS ID_TIPO_PROTECAO
		,'' AS PROTECAO_SOCIAL
		,0 AS NUMERO_ATENDIDOS
		,'' AS ABRANGENCIA
		,CAST(0 as BIT) AS SERVICO_ESTADUALIZADO
		,ISNULL((T.VALOR_FEAS),0.0) AS PREVISAO_ORCAMENTARIA
		,4 AS ORDEM
	 
  FROM TB_PREFEITURA_BENEFICIO_EVENTUAL T
  WHERE T.ID_PREFEITURA = @ID_PREFEITURA AND T.ID_TIPO_BENEFICIO_EVENTUAL = 4 AND ISNULL((T.VALOR_FEAS),0.0) > 0

  ) T
  ORDER BY T.ORDEM, T.TIPO_UNIDADE,T.UNIDADE,T.TIPO_SERVICO, T.USUARIO
  End
  Else
  Begin
    SELECT * FROM (
  SELECT S.ID		
		,L.ID AS ID_UNIDADE
		,5 AS ID_TIPO_UNIDADE
		,'Centro Pop' AS TIPO_UNIDADE
		,L.NOME AS UNIDADE
		,S.ID_USUARIO_TIPO_SERVICO
		,U.NOME AS USUARIO
		,U.ID_TIPO_SERVICO
		,(T.NOME + (CASE WHEN DESCRICAO_NAO_TIPIFICADO IS NULL THEN '' ELSE (' - ' + DESCRICAO_NAO_TIPIFICADO)END))  AS TIPO_SERVICO
		,T.ID_TIPO_PROTECAO
		,P.NOME AS PROTECAO_SOCIAL
		,S.NUMERO_ATENDIDOS_MENSAL AS NUMERO_ATENDIDOS
		,A.ABREVIACAO AS ABRANGENCIA
		,S.SERVICO_ESTADUALIZADO
		,COALESCE((S.VALOR_ESTADUAL_ASSISTENCIA),0) AS PREVISAO_ORCAMENTARIA
		,5 AS ORDEM
	 
  FROM TB_SERVICOS_RECURSOS_FINANCEIROS_CENTRO_POP S
  INNER JOIN TB_UNIDADE_PUBLICA UP (NOLOCK) ON (UP.ID_PREFEITURA = @ID_PREFEITURA) --brunov
  INNER JOIN TB_CENTRO_POP L ON(L.ID = S.ID_CENTRO_POP AND L.ID_UNIDADE_PUBLICA = UP.ID) --brunov
  --INNER JOIN TB_CENTRO_POP L ON(L.ID = S.ID_CENTRO_POP AND L.ID_PREFEITURA = @ID_PREFEITURA) --original
  INNER JOIN TB_USUARIO_TIPO_SERVICO U ON (U.ID = S.ID_USUARIO_TIPO_SERVICO)
  INNER JOIN TB_TIPO_SERVICO T ON(T.ID = U.ID_TIPO_SERVICO AND T.ID_TIPO_PROTECAO = @ID_TIPO_PROTECAO )
  INNER JOIN TB_TIPO_PROTECAO P ON(P.ID = T.ID_TIPO_PROTECAO)
  INNER JOIN TB_ABRANGENCIA_SERVICO A ON(A.ID = S.ID_ABRANGENCIA_SERVICO)
  WHERE S.VALOR_ESTADUAL_ASSISTENCIA > 0

  UNION ALL

  SELECT S.ID		
		,L.ID AS ID_UNIDADE
		,4 AS ID_TIPO_UNIDADE
		,'CREAS' AS TIPO_UNIDADE
		,L.NOME AS UNIDADE
		,S.ID_USUARIO_TIPO_SERVICO
		,U.NOME AS USUARIO
		,U.ID_TIPO_SERVICO
		,(T.NOME + (CASE WHEN DESCRICAO_NAO_TIPIFICADO IS NULL THEN '' ELSE (' - ' + DESCRICAO_NAO_TIPIFICADO)END))  AS TIPO_SERVICO
		,T.ID_TIPO_PROTECAO
		,P.NOME AS PROTECAO_SOCIAL
		,S.NUMERO_ATENDIDOS_MENSAL AS NUMERO_ATENDIDOS
		,A.ABREVIACAO AS ABRANGENCIA
		,S.SERVICO_ESTADUALIZADO
		,COALESCE((S.VALOR_ESTADUAL_ASSISTENCIA),0) AS PREVISAO_ORCAMENTARIA
		,5 AS ORDEM
	 
  FROM TB_SERVICOS_RECURSOS_FINANCEIROS_CREAS S
  INNER JOIN TB_UNIDADE_PUBLICA UP (NOLOCK) ON (UP.ID_PREFEITURA = @ID_PREFEITURA) --brunov
  INNER JOIN TB_CREAS L ON(L.ID = S.ID_CREAS AND L.ID_UNIDADE_PUBLICA = UP.ID) --brunov
  --INNER JOIN TB_CREAS L ON(L.ID = S.ID_CREAS AND L.ID_PREFEITURA = @ID_PREFEITURA) --original
  INNER JOIN TB_USUARIO_TIPO_SERVICO U ON (U.ID = S.ID_USUARIO_TIPO_SERVICO)
  INNER JOIN TB_TIPO_SERVICO T ON(T.ID = U.ID_TIPO_SERVICO AND T.ID_TIPO_PROTECAO = @ID_TIPO_PROTECAO )
  INNER JOIN TB_TIPO_PROTECAO P ON(P.ID = T.ID_TIPO_PROTECAO)
  INNER JOIN TB_ABRANGENCIA_SERVICO A ON(A.ID = S.ID_ABRANGENCIA_SERVICO)
  WHERE S.VALOR_ESTADUAL_ASSISTENCIA > 0

  UNION ALL

  SELECT S.ID		
		,L.ID AS ID_UNIDADE
		,3 AS ID_TIPO_UNIDADE
		,'CRAS' AS TIPO_UNIDADE
		,L.NOME AS UNIDADE
		,S.ID_USUARIO_TIPO_SERVICO
		,U.NOME AS USUARIO
		,U.ID_TIPO_SERVICO
		,(T.NOME + (CASE WHEN DESCRICAO_NAO_TIPIFICADO IS NULL THEN '' ELSE (' - ' + DESCRICAO_NAO_TIPIFICADO)END))  AS TIPO_SERVICO
		,T.ID_TIPO_PROTECAO
		,P.NOME AS PROTECAO_SOCIAL
		,S.NUMERO_ATENDIDOS_MENSAL AS NUMERO_ATENDIDOS
		,A.ABREVIACAO AS ABRANGENCIA
		,S.SERVICO_ESTADUALIZADO
		,COALESCE((S.VALOR_ESTADUAL_ASSISTENCIA),0) AS PREVISAO_ORCAMENTARIA
		,5 AS ORDEM
	 
  FROM TB_SERVICOS_RECURSOS_FINANCEIROS_CRAS S
  INNER JOIN TB_UNIDADE_PUBLICA UP (NOLOCK) ON (UP.ID_PREFEITURA = @ID_PREFEITURA) --brunov
  INNER JOIN TB_CRAS L ON(L.ID = S.ID_CRAS AND L.ID_UNIDADE_PUBLICA = UP.ID) --brunov
  --INNER JOIN TB_CRAS L ON(L.ID = S.ID_CRAS AND L.ID_PREFEITURA = @ID_PREFEITURA) --original
  INNER JOIN TB_USUARIO_TIPO_SERVICO U ON (U.ID = S.ID_USUARIO_TIPO_SERVICO)
  INNER JOIN TB_TIPO_SERVICO T ON(T.ID = U.ID_TIPO_SERVICO AND T.ID_TIPO_PROTECAO = @ID_TIPO_PROTECAO )
  INNER JOIN TB_TIPO_PROTECAO P ON(P.ID = T.ID_TIPO_PROTECAO)
  INNER JOIN TB_ABRANGENCIA_SERVICO A ON(A.ID = S.ID_ABRANGENCIA_SERVICO)
  WHERE S.VALOR_ESTADUAL_ASSISTENCIA > 0

  UNION ALL

  SELECT S.ID		
		,L.ID AS ID_UNIDADE
		,1 AS ID_TIPO_UNIDADE
		,'Unidade Pública' AS TIPO_UNIDADE
		,(L.RAZAO_SOCIAL + (CASE WHEN L.RAZAO_SOCIAL <> E.NOME THEN ' - ' + E.NOME ELSE '' END)) AS UNIDADE
		,S.ID_USUARIO_TIPO_SERVICO
		,U.NOME AS USUARIO
		,U.ID_TIPO_SERVICO
		,(T.NOME + (CASE WHEN DESCRICAO_NAO_TIPIFICADO IS NULL THEN '' ELSE (' - ' + DESCRICAO_NAO_TIPIFICADO)END))  AS TIPO_SERVICO
		,T.ID_TIPO_PROTECAO
		,P.NOME AS PROTECAO_SOCIAL
		,S.NUMERO_ATENDIDOS_MENSAL AS NUMERO_ATENDIDOS
		,A.ABREVIACAO AS ABRANGENCIA
		,S.SERVICO_ESTADUALIZADO
		,COALESCE((S.VALOR_ESTADUAL_ASSISTENCIA),0) AS PREVISAO_ORCAMENTARIA
		,5 AS ORDEM
	 
  FROM TB_SERVICOS_RECURSOS_FINANCEIROS_PUBLICO S
  INNER JOIN TB_LOCAL_EXECUCAO_PUBLICO E ON(E.ID = S.ID_LOCAL_EXECUCAO_PUBLICO)
  INNER JOIN TB_UNIDADE_PUBLICA L ON(L.ID = E.ID_UNIDADE_PUBLICA AND L.ID_PREFEITURA = @ID_PREFEITURA)
  INNER JOIN TB_USUARIO_TIPO_SERVICO U ON (U.ID = S.ID_USUARIO_TIPO_SERVICO)
  INNER JOIN TB_TIPO_SERVICO T ON(T.ID = U.ID_TIPO_SERVICO AND T.ID_TIPO_PROTECAO = @ID_TIPO_PROTECAO )
  INNER JOIN TB_TIPO_PROTECAO P ON(P.ID = T.ID_TIPO_PROTECAO)
  INNER JOIN TB_ABRANGENCIA_SERVICO A ON(A.ID = S.ID_ABRANGENCIA_SERVICO)
  WHERE S.VALOR_ESTADUAL_ASSISTENCIA > 0

  UNION ALL

  SELECT S.ID		
		,L.ID AS ID_UNIDADE
		,2 AS ID_TIPO_UNIDADE
		,'Unidade Privada' AS TIPO_UNIDADE
		,(L.RAZAO_SOCIAL + (CASE WHEN L.RAZAO_SOCIAL <> E.NOME THEN ' - ' + E.NOME ELSE '' END)) AS UNIDADE
		,S.ID_USUARIO_TIPO_SERVICO
		,U.NOME AS USUARIO
		,U.ID_TIPO_SERVICO
		,(T.NOME + (CASE WHEN DESCRICAO_NAO_TIPIFICADO IS NULL THEN '' ELSE (' - ' + DESCRICAO_NAO_TIPIFICADO)END))  AS TIPO_SERVICO
		,T.ID_TIPO_PROTECAO
		,P.NOME AS PROTECAO_SOCIAL
		,S.NUMERO_ATENDIDOS_MENSAL AS NUMERO_ATENDIDOS
		,A.ABREVIACAO AS ABRANGENCIA
		,S.SERVICO_ESTADUALIZADO
		,COALESCE((S.VALOR_ESTADUAL_ASSISTENCIA),0) AS PREVISAO_ORCAMENTARIA
		,5 AS ORDEM
	 
  FROM TB_SERVICOS_RECURSOS_FINANCEIROS_PRIVADO S
  INNER JOIN TB_LOCAL_EXECUCAO_PRIVADO E ON(E.ID = S.ID_LOCAL_EXECUCAO_PRIVADO)
  INNER JOIN TB_UNIDADE_PRIVADA L ON(L.ID = E.ID_UNIDADE_PRIVADA AND L.ID_PREFEITURA = @ID_PREFEITURA)
  INNER JOIN TB_USUARIO_TIPO_SERVICO U ON (U.ID = S.ID_USUARIO_TIPO_SERVICO)
  INNER JOIN TB_TIPO_SERVICO T ON(T.ID = U.ID_TIPO_SERVICO AND T.ID_TIPO_PROTECAO = @ID_TIPO_PROTECAO )
  INNER JOIN TB_TIPO_PROTECAO P ON(P.ID = T.ID_TIPO_PROTECAO)
  INNER JOIN TB_ABRANGENCIA_SERVICO A ON(A.ID = S.ID_ABRANGENCIA_SERVICO)
  WHERE S.VALOR_ESTADUAL_ASSISTENCIA > 0

  UNION ALL

  SELECT 0 AS ID		
		,0 AS ID_UNIDADE
		,1 AS ID_TIPO_UNIDADE
		,'Programa São Paulo Solidário - Etapa de Busca Ativa'  AS TIPO_UNIDADE
		,'Programa São Paulo Solidário - Etapa de Busca Ativa' AS UNIDADE
		,0 AS ID_USUARIO_TIPO_SERVICO
		,'' AS USUARIO
		,0 AS ID_TIPO_SERVICO
		,''  AS TIPO_SERVICO
		,CAST(1 AS SMALLINT) AS ID_TIPO_PROTECAO
		,'' AS PROTECAO_SOCIAL
		,0 AS NUMERO_ATENDIDOS
		,'' AS ABRANGENCIA
		,CAST(0 as BIT) AS SERVICO_ESTADUALIZADO
		,COALESCE((T.SP_SOLIDARIO_BUSCA_ATIVA_VALOR_FEAS),0) AS PREVISAO_ORCAMENTARIA
		,1 AS ORDEM
	 
  FROM TB_PROGRAMA_PROJETO T
  WHERE @ID_TIPO_PROTECAO = 1 AND T.ID_PREFEITURA = @ID_PREFEITURA AND T.PROGRAMA_ESTADUAL = 1 AND T.NOME like '%São Paulo Solidário%' AND T.ID_FASE_PROGRAMA_TRANSFERENCIA_RENDA_SP_SOLIDARIO >= 1
  AND T.SP_SOLIDARIO_BUSCA_ATIVA_ANO_TERMINO = 2014 AND (T.SP_SOLIDARIO_ANO_REPASSE_FEAS_BUSCA_ATIVA = 2014 OR (T.SP_SOLIDARIO_ANO_REPASSE_FEAS_BUSCA_ATIVA = 2013 AND T.SP_SOLIDARIO_VALOR_FEAS_RETIDO_FMAS_2014 = 1))
  AND T.SP_SOLIDARIO_BUSCA_ATIVA_VALOR_FEAS IS NOT NULL AND T.SP_SOLIDARIO_BUSCA_ATIVA_VALOR_FEAS > 0

  UNION ALL  

  SELECT 0 AS ID		
		,0 AS ID_UNIDADE
		,1 AS ID_TIPO_UNIDADE
		,'Programa São Paulo Solidário - Etapa de Além da Renda' AS TIPO_UNIDADE
		,'Programa São Paulo Solidário - Etapa de Além da Renda' AS UNIDADE
		,0 AS ID_USUARIO_TIPO_SERVICO
		,'' AS USUARIO
		,0 AS ID_TIPO_SERVICO
		,''  AS TIPO_SERVICO
		,CAST(1 AS SMALLINT) AS ID_TIPO_PROTECAO
		,'' AS PROTECAO_SOCIAL
		,0 AS NUMERO_ATENDIDOS
		,'' AS ABRANGENCIA
		,CAST(0 as BIT) AS SERVICO_ESTADUALIZADO
		,COALESCE((T.SP_SOLIDARIO_AGENDA_FAMILIA_VALOR_FEAS),0) AS PREVISAO_ORCAMENTARIA
		,2 AS ORDEM
	 
  FROM TB_PROGRAMA_PROJETO T
  WHERE @ID_TIPO_PROTECAO = 1 AND T.ID_PREFEITURA = @ID_PREFEITURA AND T.PROGRAMA_ESTADUAL = 1 AND T.NOME like '%São Paulo Solidário%' AND T.ID_FASE_PROGRAMA_TRANSFERENCIA_RENDA_SP_SOLIDARIO = 3
  AND (T.SP_SOLIDARIO_ANO_REPASSE_FEAS_AGENDA_FAMILIA = 2014 OR (T.SP_SOLIDARIO_ANO_REPASSE_FEAS_AGENDA_FAMILIA = 2013 AND T.SP_SOLIDARIO_VALOR_FEAS_RETIDO_FMAS_2014_AGENDA_FAMILIA = 1))
  AND T.SP_SOLIDARIO_AGENDA_FAMILIA_VALOR_FEAS IS NOT NULL AND T.SP_SOLIDARIO_AGENDA_FAMILIA_VALOR_FEAS > 0

  UNION ALL  

  SELECT 0 AS ID		
		,0 AS ID_UNIDADE
		,1 AS ID_TIPO_UNIDADE
		,'Implantação de CRAS conforme Resolução SEDS-004, de 25/03/2014'  AS TIPO_UNIDADE
		,'Implantação de CRAS conforme Resolução SEDS-004, de 25/03/2014' AS UNIDADE
		,0 AS ID_USUARIO_TIPO_SERVICO
		,'' AS USUARIO
		,0 AS ID_TIPO_SERVICO
		,''  AS TIPO_SERVICO
		,CAST(1 AS SMALLINT) AS ID_TIPO_PROTECAO
		,'' AS PROTECAO_SOCIAL
		,0 AS NUMERO_ATENDIDOS
		,'' AS ABRANGENCIA
		,CAST(0 as BIT) AS SERVICO_ESTADUALIZADO
		,ISNULL(AP.VALOR_FEAS, 0.0) AS PREVISAO_ORCAMENTARIA
		,3 AS ORDEM
	 
  FROM TB_PREFEITURA_ACAO_PLANEJAMENTO AP
  WHERE @ID_TIPO_PROTECAO = 1 AND AP.ID_PREFEITURA = @ID_PREFEITURA AND AP.ID_ACAO_PLANEJAMENTO = 26 AND ISNULL(AP.VALOR_FEAS, 0.0) > 0.0

  UNION ALL  

  SELECT 0 AS ID		
		,0 AS ID_UNIDADE
		,1 AS ID_TIPO_UNIDADE
		,'Benefício Eventual - Auxílio Natalidade' AS TIPO_UNIDADE
		,'Benefício Eventual - Auxílio Natalidade' AS UNIDADE
		,0 AS ID_USUARIO_TIPO_SERVICO
		,'' AS USUARIO
		,0 AS ID_TIPO_SERVICO
		,''  AS TIPO_SERVICO
		,CAST(1 AS SMALLINT) AS ID_TIPO_PROTECAO
		,'' AS PROTECAO_SOCIAL
		,0 AS NUMERO_ATENDIDOS
		,'' AS ABRANGENCIA
		,CAST(0 as BIT) AS SERVICO_ESTADUALIZADO
		,ISNULL((T.VALOR_FEAS),0.0) AS PREVISAO_ORCAMENTARIA
		,4 AS ORDEM
	 
  FROM TB_PREFEITURA_BENEFICIO_EVENTUAL T
  WHERE @ID_TIPO_PROTECAO = 1 AND T.ID_PREFEITURA = @ID_PREFEITURA AND T.ID_TIPO_BENEFICIO_EVENTUAL = 1 AND ISNULL((T.VALOR_FEAS),0.0) > 0

  UNION ALL  

  SELECT 0 AS ID		
		,0 AS ID_UNIDADE
		,1 AS ID_TIPO_UNIDADE
		,'Benefício Eventual - Auxílio Funeral' AS TIPO_UNIDADE
		,'Benefício Eventual - Auxílio Funeral' AS UNIDADE
		,0 AS ID_USUARIO_TIPO_SERVICO
		,'' AS USUARIO
		,0 AS ID_TIPO_SERVICO
		,''  AS TIPO_SERVICO
		,CAST(1 AS SMALLINT) AS ID_TIPO_PROTECAO
		,'' AS PROTECAO_SOCIAL
		,0 AS NUMERO_ATENDIDOS
		,'' AS ABRANGENCIA
		,CAST(0 as BIT) AS SERVICO_ESTADUALIZADO
		,ISNULL((T.VALOR_FEAS),0.0) AS PREVISAO_ORCAMENTARIA
		,4 AS ORDEM
	 
  FROM TB_PREFEITURA_BENEFICIO_EVENTUAL T
  WHERE @ID_TIPO_PROTECAO = 1 AND T.ID_PREFEITURA = @ID_PREFEITURA AND T.ID_TIPO_BENEFICIO_EVENTUAL = 2 AND ISNULL((T.VALOR_FEAS),0.0) > 0

  UNION ALL  

  SELECT 0 AS ID		
		,0 AS ID_UNIDADE
		,1 AS ID_TIPO_UNIDADE
		,'Benefício Eventual - Calamidades Públicas e Emergências'  AS TIPO_UNIDADE
		,'Benefício Eventual - Calamidades Públicas e Emergências' AS UNIDADE
		,0 AS ID_USUARIO_TIPO_SERVICO
		,'' AS USUARIO
		,0 AS ID_TIPO_SERVICO
		,''  AS TIPO_SERVICO
		,CAST(1 AS SMALLINT) AS ID_TIPO_PROTECAO
		,'' AS PROTECAO_SOCIAL
		,0 AS NUMERO_ATENDIDOS
		,'' AS ABRANGENCIA
		,CAST(0 as BIT) AS SERVICO_ESTADUALIZADO
		,ISNULL((T.VALOR_FEAS),0.0) AS PREVISAO_ORCAMENTARIA
		,4 AS ORDEM
	 
  FROM TB_PREFEITURA_BENEFICIO_EVENTUAL T
  WHERE @ID_TIPO_PROTECAO = 1 AND T.ID_PREFEITURA = @ID_PREFEITURA AND T.ID_TIPO_BENEFICIO_EVENTUAL = 3 AND ISNULL((T.VALOR_FEAS),0.0) > 0

  UNION ALL  

  SELECT 0 AS ID		
		,0 AS ID_UNIDADE
		,1 AS ID_TIPO_UNIDADE
		,'Benefício Eventual - Vulnerabilidade Temporária'AS TIPO_UNIDADE
		,'Benefício Eventual - Vulnerabilidade Temporária' AS UNIDADE
		,0 AS ID_USUARIO_TIPO_SERVICO
		,'' AS USUARIO
		,0 AS ID_TIPO_SERVICO
		,''  AS TIPO_SERVICO
		,CAST(1 AS SMALLINT) AS ID_TIPO_PROTECAO
		,'' AS PROTECAO_SOCIAL
		,0 AS NUMERO_ATENDIDOS
		,'' AS ABRANGENCIA
		,CAST(0 as BIT) AS SERVICO_ESTADUALIZADO
		,ISNULL((T.VALOR_FEAS),0.0) AS PREVISAO_ORCAMENTARIA
		,4 AS ORDEM
	 
  FROM TB_PREFEITURA_BENEFICIO_EVENTUAL T
  WHERE @ID_TIPO_PROTECAO = 1 AND T.ID_PREFEITURA = @ID_PREFEITURA AND T.ID_TIPO_BENEFICIO_EVENTUAL = 4 AND ISNULL((T.VALOR_FEAS),0.0) > 0

  ) T
  ORDER BY T.ORDEM, T.TIPO_UNIDADE,T.UNIDADE,T.TIPO_SERVICO, T.USUARIO
  End
GO



